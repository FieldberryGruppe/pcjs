(function(){/*
 https://www.pcjs.org/modules/devices/lib/webio.js (C) Jeff Parsons 2012-2019
 https://www.pcjs.org/modules/devices/lib/defs.js (C) Jeff Parsons 2012-2019
 https://www.pcjs.org/modules/devices/lib/numio.js (C) Jeff Parsons 2012-2019
 https://www.pcjs.org/modules/devices/lib/stdio.js (C) Jeff Parsons 2012-2019
 https://www.pcjs.org/modules/devices/main/device.js (C) Jeff Parsons 2012-2019
 https://www.pcjs.org/modules/devices/main/input.js (C) Jeff Parsons 2012-2019
 https://www.pcjs.org/modules/devices/main/led.js (C) Jeff Parsons 2012-2019
 https://www.pcjs.org/modules/devices/main/time.js (C) Jeff Parsons 2012-2019
 https://www.pcjs.org/modules/devices/bus/bus.js (C) Jeff Parsons 2012-2019
 https://www.pcjs.org/modules/devices/bus/memory.js (C) Jeff Parsons 2012-2019
 https://www.pcjs.org/modules/devices/bus/ports.js (C) Jeff Parsons 2012-2019
 https://www.pcjs.org/modules/devices/bus/ram.js (C) Jeff Parsons 2012-2019
 https://www.pcjs.org/modules/devices/bus/rom.js (C) Jeff Parsons 2012-2019
 https://www.pcjs.org/modules/devices/cpu/cpu.js (C) Jeff Parsons 2012-2019
 https://www.pcjs.org/modules/devices/cpu/pdp11ops.js (C) Jeff Parsons 2012-2019
 https://www.pcjs.org/modules/devices/cpu/pdp11.js (C) Jeff Parsons 2012-2019
 https://www.pcjs.org/modules/devices/cpu/debugger.js (C) Jeff Parsons 2012-2019
 https://www.pcjs.org/modules/devices/cpu/pdp11dbg.js (C) Jeff Parsons 2012-2019
 https://www.pcjs.org/modules/devices/main/machine.js (C) Jeff Parsons 2012-2019
*/
var p;function aa(a){var b=0;return function(){return b<a.length?{done:!1,value:a[b++]}:{done:!0}}}function q(a){if(!(a instanceof Array)){var b="undefined"!=typeof Symbol&&Symbol.iterator&&a[Symbol.iterator];a=b?b.call(a):{next:aa(a)};for(var c=[];!(b=a.next()).done;)c.push(b.value);a=c}return a}var ba="function"==typeof Object.create?Object.create:function(a){function b(){}b.prototype=a;return new b},ca;
if("function"==typeof Object.setPrototypeOf)ca=Object.setPrototypeOf;else{var da;a:{var ea={ib:!0},fa={};try{fa.__proto__=ea;da=fa.ib;break a}catch(a){}da=!1}ca=da?function(a,b){a.__proto__=b;if(a.__proto__!==b)throw new TypeError(a+" is not extensible");return a}:null}var ha=ca;
function x(a,b){a.prototype=ba(b.prototype);a.prototype.constructor=a;if(ha)ha(a,b);else for(var c in b)if("prototype"!=c)if(Object.defineProperties){var d=Object.getOwnPropertyDescriptor(b,c);d&&Object.defineProperty(a,c,d)}else a[c]=b[c];a.cf=b.prototype}var ia="function"==typeof Object.defineProperties?Object.defineProperty:function(a,b,c){a!=Array.prototype&&a!=Object.prototype&&(a[b]=c.value)},z="undefined"!=typeof window&&window===this?this:"undefined"!=typeof global&&null!=global?global:this;
function ja(a,b){if(b){var c=z;a=a.split(".");for(var d=0;d<a.length-1;d++){var e=a[d];e in c||(c[e]={});c=c[e]}a=a[a.length-1];d=c[a];b=b(d);b!=d&&null!=b&&ia(c,a,{configurable:!0,writable:!0,value:b})}}ja("Math.trunc",function(a){return a?a:function(b){b=Number(b);if(isNaN(b)||Infinity===b||-Infinity===b||0===b)return b;var c=Math.floor(Math.abs(b));return 0>b?-c:c}});ja("Math.log2",function(a){return a?a:function(b){return Math.log(b)/Math.LN2}});ja("Number.parseInt",function(a){return a||parseInt});
function ka(){ka=function(){};z.Symbol||(z.Symbol=la)}function ma(a,b){this.a=a;ia(this,"description",{configurable:!0,writable:!0,value:b})}ma.prototype.toString=function(){return this.a};var la=function(){function a(c){if(this instanceof a)throw new TypeError("Symbol is not a constructor");return new ma("jscomp_symbol_"+(c||"")+"_"+b++,c)}var b=0;return a}();
function na(){ka();var a=z.Symbol.iterator;a||(a=z.Symbol.iterator=z.Symbol("Symbol.iterator"));"function"!=typeof Array.prototype[a]&&ia(Array.prototype,a,{configurable:!0,writable:!0,value:function(){return oa(aa(this))}});na=function(){}}function oa(a){na();a={next:a};a[z.Symbol.iterator]=function(){return this};return a}
function pa(a,b){na();a instanceof String&&(a+="");var c=0,d={next:function(){if(c<a.length){var e=c++;return{value:b(e,a[e]),done:!1}}d.next=function(){return{done:!0,value:void 0}};return d.next()}};d[Symbol.iterator]=function(){return d};return d}ja("Array.prototype.keys",function(a){return a?a:function(){return pa(this,function(b){return b})}});
ja("Array.prototype.fill",function(a){return a?a:function(b,c,d){var e=this.length||0;0>c&&(c=Math.max(0,e+c));if(null==d||d>e)d=e;d=Number(d);0>d&&(d=Math.max(0,e+d));for(c=Number(c||0);c<d;c++)this[c]=b;return this}});var qa=new ArrayBuffer(2);(new DataView(qa)).setUint16(0,256,!0);new Uint16Array(qa);function ra(){}var A={};A.Defs=ra;function sa(){}x(sa,ra);
function ta(a,b){if(a){b||(b=10);var c,d=0<a.indexOf(",");d&&(a=a.replace(/,/g,""));var e=c=a.charAt(0);"#"==c?(b=8,c=""):"$"==c&&(b=16,c="");e!=c?a=a.substr(1):(e=c=a.substr(0,2),"0b"==c&&d||"^B"==c?(b=2,c=""):"0o"==c||"^O"==c?(b=8,c=""):"^D"==c?(b=10,c=""):"0x"==c&&(b=16,c=""),e!=c&&(a=a.substr(2)));e=c=a.slice(-1);"Y"==c||"y"==c?(b=2,c=""):"."==c?(b=10,c=""):"H"==c||"h"==c?(b=16,c=""):"K"==c?c="000":"M"==c?c="000000":"G"==c&&(c="000000000");e!=c&&(a=a.slice(0,-1)+c);var f;e=0;10>=b&&(c=a.match(/(-?[0-9]+)B([0-9]*)/))&&
(a=c[1],e=35-((c[2]||35)&255));c=a;if(((d=b)&&10!=d?16==d?null!==c.match(/^-?[0-9a-f]+$/i):8==d?null!==c.match(/^-?[0-7]+$/):2==d&&null!==c.match(/^-?[01]+$/):null!==c.match(/^-?[0-9]+$/))&&!isNaN(f=parseInt(a,b))){e&&(0>f&&(f+=Math.pow(2,36)),f=0<e?f*Math.pow(2,e):Math.trunc(f/Math.pow(2,-e)));var g=f}}return g}
function B(a,b,c,d,e){d=void 0===d?0:d;var f=void 0===f?0:f;var g="",k="",h=-1;c||(c=a.Z||10);d&&(h=Math.ceil(d/Math.log2(c)));if(void 0==e)switch(c){case 8:e="0o";break;case 16:e="0x";break;case 10:k=".";default:e=""}isNaN(b)||"number"!=typeof b?(b=void 0,e=k=""):(0>b&&-1<b&&(b=-1),d&&(0>b&&(b+=Math.pow(2,d)),b>=Math.pow(2,d)&&(h=Math.ceil(Math.log(b)/Math.log(c)))));for(a=f||-1;h--;){a||(g=","+g,a=f);if(void 0==b){if(g="?"+g,0>h)break}else if(d=b%c,b=Math.trunc(b/c),d+=0<=d&&9>=d?48:55,g=String.fromCharCode(d)+
g,!b&&0>h)break;a--}return e+g+k}function ua(a,b){var c=a/C|0,d=b/C|0;return(a&b)==(b|0)&&(c&d)==d}function va(a){for(var b=0,c=0,d=[];b<a.length;){for(var e=a[b],f=b+1;f<a.length&&a[f]===e;)f++;d[c++]=f-b;d[c++]=e;b=f}return d.length>=a.length?a:d}var C=Math.pow(2,32);A.NumIO=sa;function D(){this.Ca={};for(var a=0;22>a;a++)this.Ca["ACDFHIMNSTWYbdfjcsoXx%"[a]]=null}x(D,sa);function wa(a,b,c){a.Ca[b]||(a.Ca[b]=c)}p=D.prototype;p.flush=function(){var a=xa;xa="";this.wa(a)};
p.od=function(a){for(var b=[],c=0;c<arguments.length;++c)b[c]=arguments[c];return void 0===b[0]?new Date(Date.now()):"string"===typeof b[0]?new Date(b[0]+" "+(b[1]||"00:00:00 GMT")):void 0===b[1]?new Date(b[0]):new Date(Date.UTC.apply(Date,q(b)))};p.wa=function(a,b){var c=a.lastIndexOf("\n");b?0<=c&&(b=Date.now(),ya||(ya=b),a=((b-ya)/1E3).toFixed(3)+": "+a):(0<=c&&(console.log(xa+a.substr(0,c)),xa="",a=a.substr(c+1)),ya=null);xa+=a;return a.length};function E(a,b,c){a.wa(b+"\n",c)}
p.u=function(a,b){for(var c=[],d=1;d<arguments.length;++d)c[d-1]=arguments[d];return this.wa(this.l.apply(this,[a].concat(q(c))))};
p.l=function(a,b){for(var c=[],d=1;d<arguments.length;++d)c[d-1]=arguments[d];if(!c||!c.length)return a;d="";var e=a.split(/%([-+ 0#]*)([0-9]*|\*)(\.[0-9]+|)([hlL]?)([A-Za-z%])/),f=0,g;for(g=0;g<e.length-6;g+=6){d+=e[g];var k=e[g+5];if(void 0===this.Ca[k])d+="%"+e[g+1]+e[g+2]+e[g+3]+e[g+4]+k;else{if(f<c.length){var h=c[f];"%"!=k&&f++}else h=c[c.length-1];var m=e[g+1],l=0<=m.indexOf("#"),v=0<=m.indexOf("0"),n=e[g+2];"*"==n?(n=h,h=f<c.length?c[f++]:c[c.length-1]):n=+n||0;var t=e[g+3];t=t?+t.substr(1):
-1;var w=null,u=0,y="";var r=0<="ACDFHIMNSTWY".indexOf(k)&&"object"!=typeof h?this.od(h):h;switch(k){case "C":h=l?"#":"";d+=isNaN(r.getTime())?void 0:this.l(this.l("%%%sW, %%%sF %%%sD, %%%sY",h),r);continue;case "D":h=l?r.getUTCDate():r.getDate();k="d";break;case "A":case "H":case "I":h=l?r.getUTCHours():r.getHours();"A"==k?(h=12>h?"am":"pm",k="s"):("I"==k&&(h=h?12<h?h-12:h:12),k="d");break;case "F":case "M":h=l?r.getUTCMonth():r.getMonth();"F"==k?(h=za[h],k="s"):(h++,k="d");break;case "N":h=l?r.getUTCMinutes():
r.getMinutes();k="d";break;case "S":h=l?r.getUTCSeconds():r.getSeconds();k="d";break;case "T":h=l?"#":"";d+=isNaN(r.getTime())?void 0:this.l(this.l("%%%sY-%%%s02M-%%%s02D %%%s02H:%%%s02N:%%%s02S",h),r);continue;case "W":h=Aa[l?r.getUTCDay():r.getDay()];k="s";break;case "Y":h=l?r.getUTCFullYear():r.getFullYear(),0<t&&(h%=Math.pow(10,t),t=-1),k="d"}switch(k){case "b":d+=h?"true":"false";break;case "d":h=Math.trunc(h);case "f":h=+h;r=h+"";0<=t&&(r=h.toFixed(t));r.length<n&&(v?(0>h&&(n--,r=r.substr(1)),
r=("0000000000"+r).slice(-n),0>h&&(r="-"+r)):r=("          "+r).slice(-n));d+=r;break;case "j":d+=JSON.stringify(h,null,n||void 0);break;case "c":h="string"==typeof h?h[0]:String.fromCharCode(h);case "s":if(void 0!==h)for("string"!=typeof h&&(h=h.toString()),0<=t&&(h=h.substr(0,t));h.length<n;)h=0<=m.indexOf("-")?h+" ":" "+h;d+=h;break;case "o":u=8,l&&(y="0");case "X":w=Ba;case "x":r="";u||(u=16);!y&&l&&(y="0x");w||(w=Ca);"string"==typeof h&&(h=Number.parseInt(h,h.match(/(^0x|[a-f])/i)?16:10));v&&
!n&&(n=Math.abs(h),n=255>=n?2:65535>=n?4:4294967295>=n?8:9,n+=y.length);n-=y.length;do l=h&u-1,h>>>=16==u?4:3,v||!r||l||h?r=w[l]+r:(y&&(r=y+r,y=""),0<n&&(r=" "+r));while(0<--n||h);d+=y+r;break;case "%":d+="%";break;default:this.Ca[k]?d+=this.Ca[k](k,m,n,t,h):d+="(unimplemented sprintf type: %"+k+")"}}}return d+=e[g]};var xa="",ya=null,Ca="0123456789abcdef",Ba="0123456789ABCDEF",Aa="Sunday Monday Tuesday Wednesday Thursday Friday Saturday".split(" "),za="January February March April May June July August September October November December".split(" ");
A.StdIO=D;function F(a){D.call(this);this.aa={};this.ca=0;this.L=this;a&&(this.L.ca=0,this.L.sa=[],this.L.ka=0,this.L.Oa={},this.L.Oe=!1)}var Da;x(F,D);F.prototype.Ja=function(a,b){var c=this,d=this;switch(a){case Ea.nc:b.onclick=function(){var e=c.Aa(Ea.Pa,!0);e&&(e.value="")};break;case Ea.Pa:Fa(b),b.addEventListener("keydown",function(e){Ga(d,e,!0)}),b.addEventListener("keypress",function(e){Ga(d,e)})}};function Ha(a,b){var c=Ia.Ab;a.L.Oa[c]||(a.L.Oa[c]=[]);a.L.Oa[c].push(b)}
function Fa(a){a.setAttribute("autocapitalize","off");a.setAttribute("autocomplete","off");a.setAttribute("autocorrect","off");a.setAttribute("spellcheck","false");a.value=""}F.prototype.Aa=function(a){return this.aa[a]};function Ja(a){var b=window;if(b){do{for(var c=0;c<Ka.length;c++){var d=Ka[c];d=d?d+a[0].toUpperCase():a[0];d+=a.substr(1);if(d in b)return d}if(0>a.indexOf("screen"))break;a=a.replace("screen","Screen")}while(1)}return null}
function La(a){var b=Ma;return a.O.bindings&&a.O.bindings[b]}function Na(a){if(a=a.aa[Oa])var b=a.textContent;return b}function Pa(a,b,c){a=+a||0;a<b&&(a=b);a>c&&(a=c);return a}function G(a,b,c,d){a=a.O[b];void 0===a?a=c:(d&&void 0!==d[a]&&(a=d[a]),d=typeof c,typeof a!=d&&("boolean"==d?a=!!a:"number"==typeof c&&(a=+a)));return a}
function Qa(a,b){var c=0,d=null,e=window.XMLHttpRequest?new window.XMLHttpRequest:new window.ActiveXObject("Microsoft.XMLHTTP");e.onreadystatechange=function(){4===e.readyState&&(d=e.responseText,200==e.status||!e.status&&d.length&&"file:"==(window?window.location.protocol:"file:")||(c=e.status||-1));b(a,d,e.readyState,c)};e.open("GET",a,!0);e.send()}
function Ra(a){if(void 0===H.eb){var b=!1;if(window)try{window.localStorage.setItem(H.Ha,H.Ha),b=window.localStorage.getItem(H.Ha)==H.Ha,window.localStorage.removeItem(H.Ha)}catch(c){E(a,c.message),b=!1}H.eb=b}return!!H.eb}function I(a,b){b=void 0===b?0:b;1<b&&b%2&&b--;b=b||a.ca;return-1==(b|1)||ua(a.L.ca,b)?!0:!1}
function Sa(a){if(window){var b=window.navigator.userAgent;return"iOS"==a&&(!!b.match(/(iPod|iPhone|iPad)/)||"MacIntel"===window.navigator.platform&&1<window.navigator.maxTouchPoints)||"MSIE"==a&&!!b.match(/(MSIE|Trident)/)||0<=b.indexOf(a)}return!1}function Ta(a){var b=null;if(Ra(a)){var c;if(window)try{(c=window.localStorage.getItem(a.S))&&(b=JSON.parse(c))}catch(d){E(a,d.message)}}return b}
function Ga(a,b,c){b=b||window.event;var d=b.which||b.keyCode;if(d){var e=a.L,f=b.target;if(c){a=!1;var g;c=f.value;var k=c.lastIndexOf("\n");d==J.xb&&f.selectionStart<=k+1&&(a=!0);d==J.Tc?(a=!0,0<e.ka&&(g=e.sa[--e.ka])):d==J.rc&&(a=!0,e.ka<e.sa.length&&(g=e.sa[++e.ka]||""));a&&b.preventDefault();void 0!=g&&(f.value=c.substr(0,k+1)+g)}else d=String.fromCharCode(d),g=f.value,c=g.lastIndexOf("\n"),f.selectionStart<=c&&f.setSelectionRange(g.length,g.length),b.stopPropagation(),"@"==d&&0<e.ka&&c+1==g.length&&
(f.value+=e.sa[--e.ka],d="\r"),"\r"==d&&(b.preventDefault(),g=f.value+="\n",f.blur(),f.focus(),(b=Ua(a,g.slice(g.lastIndexOf("\n",g.length-2)+1,-1)||""))&&E(a,b.replace(/\n$/,""),!1))}}function Va(a){return"true"==a||"on"==a?!0:"false"==a||"off"==a?!1:void 0}
function Wa(a,b){if(void 0!=b){var c=a.L;try{if(b=b.trim())c.ka<c.sa.length&&b==c.sa[c.ka]?c.ka++:(c.sa.push(b),c.ka=c.sa.length);var d=b.split(" "),e=d[0],f=a.L.Oa[Ia.Ab];switch(e[0]){case "m":if("?"==e[1]){var g="";Xa.forEach(function(v){g+=v+"\n"});g&&(g="message commands:\n"+g);break}g="";var k=void 0;e=d[d.length-1].toLowerCase();var h=Va(e);void 0!=h&&d.pop();1>=d.length&&(void 0!=h&&(k=h,h=void 0),d[1]="all");"all"==d[1]&&(d=Object.keys(K));for(f=1;f<d.length;f++){e=d[f];var m=K[e];if(!m){g+=
"unrecognized message: "+e+"\n";break}void 0!=h&&Ya(a,m,h);if(void 0==k||k==I(a,m))g+=a.l("%8s: %b\n",e,I(a,m))}I(a,0x800000000000)&&(g+="all messages will be buffered until buffer is turned off\n");g||(g="no messages\n");break;case "?":g="",Za.forEach(function(v){g+=v+"\n"}),g&&(g="default commands:\n"+g);default:if(d.unshift(b),f)for(a=0;a<f.length;a++){var l=f[a](d);if(void 0!=l){g=g?g+l:l;break}}}}catch(v){g="error: "+v.message+"\n"}}return g}
function Ua(a,b){b=void 0===b?"?":b;if(b){var c="";b=b.split(/(?:\n|;\s*)/);for(var d=0;d<b.length;d++)c+=Wa(a,b[d])}return c}F.prototype.wa=function(a,b){void 0==b&&(b=I(this,0x800000000000));if(!b){var c=this.Aa(Ea.Pa,!0);if(c)return c.value.substr(-a.length)!=a&&(c.value+=a,8192<c.value.length&&(c.value=c.value.substr(c.value.length-4096)),c.scrollTop=c.scrollHeight,Sa("iOS")||c.setSelectionRange(c.value.length,c.value.length)),a.length}return D.prototype.wa.call(this,a,b)};
F.prototype.u=function(a,b){for(var c=[],d=1;d<arguments.length;++d)c[d-1]=arguments[d];d=0;"number"==typeof a&&(d=a,a=c.shift());return I(this,d)?D.prototype.u.call.apply(D.prototype.u,[this,a].concat(q(c))):0};function $a(a,b){if(Ra(a)){b=JSON.stringify(b);try{window.localStorage.setItem(a.S,b)}catch(c){E(a,c.message)}}}function ab(a,b,c){(a=a.aa[b])&&a.textContent!=c&&(a.textContent=c)}
function Ya(a,b,c){var d=!1;c?(c=a.L.ca,a.L.ca=(c|b)+(c/C|0|b/C|0)*C):(d=ua(a.L.ca,0x800000000000)&&ua(b,0x800000000000),c=a.L.ca,a.L.ca=(c&~b)+((c/C|0)&~(b/C|0))*C);d&&a.flush()}
var Ea={nc:"clear",Pa:"print"},Za=["\u2191 \u2193\t\trecall commands","@\t\trepeat last command","m?\t\tmessage commands"],Xa=["m\t\tdisplay all messages","m on\t\tdisplay all active messages","m off\t\tdisplay all inactive messages","m all [on|off]\tturn all messages on or off","m ... [on|off]\tturn selected messages on or off"],K={all:0xffffffffffff,buffer:0x800000000000},Ia={Ab:"command"},bb={Bb:13,cb:65,wb:66,yb:67,Cb:68,E:69,Db:70,Eb:71,Fb:72,Gb:73,Hb:74,Ib:75,Jb:76,Lb:77,Mb:78,Nb:79,Ob:80,Q:81,
Pb:82,Rb:83,Sb:84,Tb:85,Ub:86,Xb:87,Zb:88,ac:89,hb:90,ib:97,Me:98,Ne:99,d:100,e:101,Se:102,Te:103,Ve:104,We:105,Xe:106,k:107,Ye:108,Ze:109,n:110,$e:111,p:112,q:113,r:114,af:115,t:116,df:117,ef:118,ff:119,x:120,y:121,z:122},J={xb:8,Qc:9,Bc:10,Bb:13,Nc:16,pc:17,mc:18,Be:19,fb:20,Dd:27,Pc:32,Ee:33,De:34,Cd:35,Yd:36,Kb:37,Tc:38,gb:39,Vd:39,rc:40,Sd:44,Fe:44,Zd:45,Bd:46,Ud:46,Xd:47,ZERO:48,ONE:49,Sc:50,Rc:51,zc:52,yc:53,Oc:54,Mc:55,sc:56,Cc:57,xc:59,wc:61,cb:65,wb:66,yb:67,Cb:68,E:69,Db:70,Eb:71,Fb:72,
Gb:73,Hb:74,Ib:75,Jb:76,Lb:77,Mb:78,Nb:79,Ob:80,Q:81,Pb:82,Rb:83,Sb:84,Tb:85,Ub:86,Xb:87,Zb:88,ac:89,hb:90,zb:91,Td:91,Rd:92,Ie:93,Wd:93,ce:96,te:96,Qd:96,de:97,re:97,ee:98,qe:98,fe:99,we:99,ge:100,ue:100,he:101,ne:101,ie:102,ye:102,je:103,se:103,ke:104,Ae:104,le:105,xe:105,ve:106,me:107,ze:109,oe:110,pe:111,Ed:112,Id:113,Jd:114,Kd:115,Ld:116,Md:117,Nd:118,Od:119,Pd:120,Fd:121,Gd:122,Hd:123,Dc:144,Kc:145,vc:173,Lc:186,tc:187,Ad:188,qc:189,Ce:190,Ke:191,yd:192,$d:219,zd:220,He:221,Ge:222,uc:224,ae:901,
Vb:1E3},cb={},db=(cb[J.xc]=J.Lc,cb[J.wc]=J.tc,cb[J.vc]=J.qc,cb[J.uc]=J.zb,cb),eb={Kb:1,gb:2,be:3},L={},fb=(L[J.xb]="\b",L[J.Qc]="\t",L[J.Bc]="\n",L[J.Bb]="\r",L[J.Pc]=" ",L[J.ZERO]="0",L[J.ONE]="1",L[J.Sc]="2",L[J.Rc]="3",L[J.zc]="4",L[J.yc]="5",L[J.Oc]="6",L[J.Mc]="7",L[J.sc]="8",L[J.Cc]="9",L[J.cb]="A",L[J.wb]="B",L[J.yb]="C",L[J.Cb]="D",L[J.E]="E",L[J.Db]="F",L[J.Eb]="G",L[J.Fb]="H",L[J.Gb]="I",L[J.Hb]="J",L[J.Ib]="K",L[J.Jb]="L",L[J.Lb]="M",L[J.Mb]="N",L[J.Nb]="O",L[J.Ob]="P",L[J.Q]="Q",L[J.Pb]=
"R",L[J.Rb]="S",L[J.Sb]="T",L[J.Tb]="U",L[J.Ub]="V",L[J.Xb]="W",L[J.Zb]="X",L[J.ac]="Y",L[J.hb]="Z",L[J.Kb]="Left",L[J.gb]="Right",L),gb={list:[],Vc:"version"},Ka=["","moz","ms","webkit"],hb={aliceblue:"#f0f8ff",antiquewhite:"#faebd7",aqua:"#00ffff",aquamarine:"#7fffd4",azure:"#f0ffff",beige:"#f5f5dc",bisque:"#ffe4c4",black:"#000000",blanchedalmond:"#ffebcd",blue:"#0000ff",blueviolet:"#8a2be2",brown:"#a52a2a",burlywood:"#deb887",cadetblue:"#5f9ea0",chartreuse:"#7fff00",chocolate:"#d2691e",coral:"#ff7f50",
cornflowerblue:"#6495ed",cornsilk:"#fff8dc",crimson:"#dc143c",cyan:"#00ffff",darkblue:"#00008b",darkcyan:"#008b8b",darkgoldenrod:"#b8860b",darkgray:"#a9a9a9",darkgreen:"#006400",darkkhaki:"#bdb76b",darkmagenta:"#8b008b",darkolivegreen:"#556b2f",darkorange:"#ff8c00",darkorchid:"#9932cc",darkred:"#8b0000",darksalmon:"#e9967a",darkseagreen:"#8fbc8f",darkslateblue:"#483d8b",darkslategray:"#2f4f4f",darkturquoise:"#00ced1",darkviolet:"#9400d3",deeppink:"#ff1493",deepskyblue:"#00bfff",dimgray:"#696969",
dodgerblue:"#1e90ff",firebrick:"#b22222",floralwhite:"#fffaf0",forestgreen:"#228b22",fuchsia:"#ff00ff",gainsboro:"#dcdcdc",ghostwhite:"#f8f8ff",gold:"#ffd700",goldenrod:"#daa520",gray:"#808080",green:"#008000",greenyellow:"#adff2f",honeydew:"#f0fff0",hotpink:"#ff69b4","indianred ":"#cd5c5c",indigo:"#4b0082",ivory:"#fffff0",khaki:"#f0e68c",lavender:"#e6e6fa",lavenderblush:"#fff0f5",lawngreen:"#7cfc00",lemonchiffon:"#fffacd",lightblue:"#add8e6",lightcoral:"#f08080",lightcyan:"#e0ffff",lightgoldenrodyellow:"#fafad2",
lightgrey:"#d3d3d3",lightgreen:"#90ee90",lightpink:"#ffb6c1",lightsalmon:"#ffa07a",lightseagreen:"#20b2aa",lightskyblue:"#87cefa",lightslategray:"#778899",lightsteelblue:"#b0c4de",lightyellow:"#ffffe0",lime:"#00ff00",limegreen:"#32cd32",linen:"#faf0e6",magenta:"#ff00ff",maroon:"#800000",mediumaquamarine:"#66cdaa",mediumblue:"#0000cd",mediumorchid:"#ba55d3",mediumpurple:"#9370d8",mediumseagreen:"#3cb371",mediumslateblue:"#7b68ee",mediumspringgreen:"#00fa9a",mediumturquoise:"#48d1cc",mediumvioletred:"#c71585",
midnightblue:"#191970",mintcream:"#f5fffa",mistyrose:"#ffe4e1",moccasin:"#ffe4b5",navajowhite:"#ffdead",navy:"#000080",oldlace:"#fdf5e6",olive:"#808000",olivedrab:"#6b8e23",orange:"#ffa500",orangered:"#ff4500",orchid:"#da70d6",palegoldenrod:"#eee8aa",palegreen:"#98fb98",paleturquoise:"#afeeee",palevioletred:"#d87093",papayawhip:"#ffefd5",peachpuff:"#ffdab9",peru:"#cd853f",pink:"#ffc0cb",plum:"#dda0dd",powderblue:"#b0e0e6",purple:"#800080",rebeccapurple:"#663399",red:"#ff0000",rosybrown:"#bc8f8f",
royalblue:"#4169e1",saddlebrown:"#8b4513",salmon:"#fa8072",sandybrown:"#f4a460",seagreen:"#2e8b57",seashell:"#fff5ee",sienna:"#a0522d",silver:"#c0c0c0",skyblue:"#87ceeb",slateblue:"#6a5acd",slategray:"#708090",snow:"#fffafa",springgreen:"#00ff7f",steelblue:"#4682b4",tan:"#d2b48c",teal:"#008080",thistle:"#d8bfd8",tomato:"#ff6347",turquoise:"#40e0d0",violet:"#ee82ee",wheat:"#f5deb3",white:"#ffffff",whitesmoke:"#f5f5f5",yellow:"#ffff00",yellowgreen:"#9acd32"},H={eb:void 0,Ha:"PCjs.localStorage"};
A.WebIO=F;function M(a,b,c,d){F.call(this,a==b);this.S=a;this.X=b;N[this.S]||(N[this.S]={});N[this.S][this.X]&&this.u("warning: machine configuration contains multiple '%s' devices\n",this.X);N[this.S][this.X]=this;this.id=this.S+"."+this.X;ib.push(this);this.L=O(this,this.S);jb(this,c,d);this.ta={}}x(M,F);p=M.prototype;p.jb=function(){};p.kb=function(){};
function jb(a,b,c){b=void 0===b?{}:b;c=void 0===c?[]:c;c=b.overrides||c;if(c.length){var d,e=Da;if(!e){e={};if(window){d||(d=window.location.search.substr(1));for(var f,g=/\+/g,k=/([^&=]+)=?([^&]*)/g;f=k.exec(d);)e[decodeURIComponent(f[1].replace(g," ")).trim()]=decodeURIComponent(f[2].replace(g," ")).trim()}Da=e}d=e;for(var h in d)0<=c.indexOf(h)&&(f=d[h],f.match(/^[+-]?[0-9.]+$/)?e=Number.parseInt(f,10):"true"==f?e=!0:"false"==f?e=!1:(e=f,f='"'+f+'"'),b[h]=e,E(a,"overriding "+a.X+" property '"+
h+"' with "+f))}a.O=b;c=b.bindings;c=void 0===c?{}:c;a.O.aa||(a.O.aa=c);(h=Array.isArray(c))?0>c.indexOf("container")&&c.push("container"):c.container||(c.container=a.X);for(var m in c){e=c[m];if(h)m=e;else if(e.match(/^[0-9]+$/)){d=+e;a.aa[m]=[];do{e=m+d++;e=document.getElementById(e);if(!e)break;a.aa[m].push(e)}while(1);continue}if(d=document.getElementById(e))a.aa[m]=d,a.Ja(m,d)}b=void 0===b?{}:b;a.version=2;if(a.version){m="";var l;a.S!=a.X&&(l=O(a,a.S).version)&&l!=a.version&&(m="Machine");m||
(l=b.version)&&l>a.version&&(m="Config");m&&(l="Error: "+a.l("%s Device version (%3.2f) incompatible with %s version (%3.2f)",b.Pe,a.version,m,l)+"\n\nClearing your browser's cache may resolve the issue.",(b=gb.Vc)&&0>gb.list.indexOf(b)&&(alert(l),gb.list.push(b)),E(a,l))}}function P(a,b,c,d){a.ta[b]={get:c.bind(a),set:d?d.bind(a):null}}function kb(a,b,c){a.ta[c]&&(a.ta[b]=a.ta[c])}
function lb(a,b){var c;try{var d=N[a.S];if(d)for(c in d){var e=d[c];if("Machine"!=e.O["class"]&&!b(e))break}}catch(f){a.u("error while enumerating device '%s': %s\n",c,f.message)}}p.Aa=function(a,b){b=void 0===b?!1:b;if(a){var c=F.prototype.Aa.call(this,a,b);if(void 0===c&&b){b=N[this.S];for(var d in b)if(c=b[d].aa[a])break;c||(c=null);this.aa[a]=c}}return c};
function O(a,b,c){var d=b,e=a.S,f=e.indexOf(".");0<f&&(e=e.substr(0,f),b=b.substr(f+1));b=(f=N[e])&&f[b]||null;if(!b){for(f=0;f<ib.length;f++)if(ib[f].id===d){b=ib[f];break}if(!b&&(void 0===c||c))throw Error(a.l("unable to find device with ID '%s'",d));}return b}function Q(a,b,c){var d=null,e=N[a.S];if(e)for(var f in e)if(e[f].O["class"]==b){if(d){d=null;break}d=e[f]}if(!d&&(void 0===c||c))throw Error(a.l("unable to find device with class '%s'",b));return d}
function mb(a,b){return(a=O(a,a.S))&&a.O&&a.O[b]}function nb(a,b){return(a=a.ta[b])&&a.get()}p.ic=function(){};
p.u=function(a,b){for(var c=[],d=1;d<arguments.length;++d)c[d-1]=arguments[d];return"number"==typeof a&&I(this,a)&&(void 0===this.W&&(this.W=Q(this,"Debugger",!1)),this.W&&this.W.ic(a),this.L.ca&ob&&(void 0===this.R&&(this.R=Q(this,"CPU")),this.R))?(a=c.shift(),F.prototype.u.call(this,"%#06x: %s.%s\n",this.R.pb,this.X,this.l.apply(this,[a].concat(q(c))).trim())):F.prototype.u.call.apply(F.prototype.u,[this,a].concat(q(c)))};function pb(a,b){(a=N[a.S])&&delete a[b]}
function qb(a,b,c){(a=a.ta[b])&&a.set&&a.set(c)}var N={},ib=[],ob=1;K.addr=ob;K.bus=2;K.memory=4;K.ports=8;K.chips=16;K.kbd=32;K.serial=64;K.misc=128;K.cpu=256;K["int"]=512;K.trap=1024;K.video=2048;K.monitor=4096;K.screen=8192;K.time=16384;K.timer=32768;K.event=65536;K.input=131072;K.key=262144;K.mouse=524288;K.touch=1048576;K.warn=2097152;K.halt=4194304;window&&(window.PCjs||(window.PCjs={}),N=window.PCjs.Machines||(window.PCjs.Machines={}),ib=window.PCjs.Components||(window.PCjs.Components=[]));
A.Device=M;
function rb(a,b,c){M.call(this,a,b,c);this.ca=131072;this.K=this.o=null;this.time=Q(this,"Time");this.L=Q(this,"Machine");this.U=G(this,"drag",!1);this.J=G(this,"scroll",!1);this.T=G(this,"hexagonal",!1);this.g=G(this,"releaseDelay",0,void 0);this.h=!1;a=this.O.map;this.b=this.f=null;if(a)if(a.length)this.b=a;else{this.f={};b=Object.keys(a);for(var d=0;d<b.length;d++){var e=[],f=b[d],g=a[f];"string"==typeof g?g=[g]:void 0==g.length&&(e=g.grid,g=g.keys,"string"==typeof g&&(g=[g]));this.f[f]={keys:g,
Ue:e,state:0}}}this.s=[];this.v=[];this.c=this.w=null;(a=this.aa[sb])&&ub(this,a,this.Aa(c.focusBinding,!0),this.O.location);this.xa()}x(rb,M);function vb(a,b){a.o=b}function wb(a,b,c){for(var d=0;d<a.s.length;d++){var e=a.s[d];e.id===b&&e.Ua(b,c)}}
function ub(a,b,c,d){d=void 0===d?[]:d;if(d.length||a.b||a.f){var e={};e.wd=d[0]||0;e.xd=d[1]||0;e.Ka=d[2]||b.clientWidth;e.Ta=d[3]||b.clientHeight;e.Va=d[4]||1;e.$a=d[5]||1;e.ed=d[6]||b.naturalWidth||e.Ka;e.gd=d[7]||b.naturalHeight||e.Ta;e.kc=d[8]||0;e.lc=d[9]||0;e.dd=d[10]||0;e.fd=d[11]||0;a.b?(e.Xa=a.b.length,e.La=a.b[0].length):(e.La=e.Va,e.Xa=e.$a,e.Va=e.$a=0);e.fc=e.Ka/(e.La+e.La*e.Va)|0;e.gc=e.Ta/(e.Xa+e.Xa*e.$a)|0;e.cd=e.fc*e.Va|0;e.hc=e.gc*e.$a|0;e.Na=e.bb=-1;xb(a,b,e);yb(a,b,e);a.time&&
a.g&&(a.N=zb(a.time,"timerInputRelease",function(){0>e.Na&&0>e.bb&&Ab(a,-1,-1)}))}if(a.b||a.f)a.time&&a.g&&(a.V=zb(a.time,"timerKeyRelease",function(){Bb(a)})),a.i=0,a.m="",a.j=[],d=b,c&&(d=c,a.c||"BUTTON"!=c.nodeName||(d=document,a.c=c,Cb(a,b),a.w=b)),Cb(a,d),a.c||(a.c=d)}function Db(a){a.g?Eb(a.time,a.V,a.g):Bb(a)}
function Cb(a,b){function c(e,f,g){var k=document.activeElement;a.u(327680,"%s.onKey%s(%d): %5.2f (%s)\n",k.id||k.nodeName,e,f,Date.now()/1E3%60,void 0!=g?g?"used":"unused":"ignored")}function d(e,f){e=document.activeElement;return a.c&&e!=a.c&&e!=a.w?null:f||window.event}b.addEventListener("keydown",function(e){if(e=d(this,e)){var f=e.which||e.keyCode,g=Fb(a,f,!0,e);c("Down",f,g);g&&e.preventDefault()}});b.addEventListener("keypress",function(e){if(e=d(this,e)){var f=e.which||e.charCode,g=Fb(a,f);
c("Press",f,g);g&&e.preventDefault()}});b.addEventListener("keyup",function(e){if(e=d(this,e)){var f=e.which||e.keyCode,g=Fb(a,f,!1,e);c("Up",f);g&&e.preventDefault();"TEXTAREA"==b.nodeName&&(b.value="")}})}
function xb(a,b,c){b.addEventListener("mousedown",function(d){if(!a.h){var e=a.c;if(e){var f=window.scrollX,g=window.scrollY;e.focus();window.scrollTo(f,g)}d.button||R(a,b,Gb,d,c)}});b.addEventListener("mousemove",function(d){a.h||R(a,b,Hb,d,c)});b.addEventListener("mouseup",function(d){a.h||d.button||R(a,b,S,d,c)});b.addEventListener("mouseout",function(d){a.h||(0>c.Na?R(a,b,Hb,d,c):R(a,b,S,d,c))})}
function yb(a,b,c){b.addEventListener("touchstart",function(d){a.J&&(a.h=!0);R(a,b,Gb,d,c)});b.addEventListener("touchmove",function(d){R(a,b,Hb,d,c)});b.addEventListener("touchend",function(d){R(a,b,S,d,c)})}
function Fb(a,b,c,d){if(void 0!=c){var e=db[b]||b;var f=fb[b];var g=Ib[e];d=d&&d.location==eb.gb;g&Jb&&d&&(g>>=1);g&&(g&Kb&&(c=!(a.a&g)),a.a=c?a.a|g:a.a&~g,wb(a,e,c))}else f=String.fromCharCode(b).toUpperCase(),b>=bb.cb&&b<=bb.hb?a.a&(Lb|Mb)||(a.a|=Mb,wb(a,J.fb,!0)):b>=bb.ib&&b<=bb.z&&a.a&Mb&&(a.a&=~Mb,wb(a,J.fb,!1));if(a.b){if(void 0!=c)return!1;for(e=0;e<a.b.length;e++)for(g=a.b[e],d=0;d<g.length;d++)if(0<=g[d].split("|").indexOf(f))return a.i?16>a.j.length&&a.j.push(b):(a.i=1,a.m=f,Ab(a,d,e),wb(a,
f,!0),Db(a)),!0}if(a.f){if(void 0==c)return!0;b=Object.keys(a.f);for(e=0;e<b.length;e++)if(g=b[e],0<=a.f[g].keys.indexOf(f))return wb(a,g,c),a.f[g].state=c?1:0,!0}return!1}function Bb(a){1==a.i?(a.i++,wb(a,a.m,!1),a.m="",Ab(a,-1,-1),Db(a)):(a.i=0,a.j.length&&Fb(a,a.j.shift()))}rb.prototype.xa=function(){this.a=0;this.H=this.M=-1};
function R(a,b,c,d,e){var f=-1,g=-1,k=!1,h=-1,m=-1;if(c<S){d=d||window.event;d.targetTouches&&d.targetTouches.length?(h=d.targetTouches[0].clientX,m=d.targetTouches[0].clientY,k=1<d.targetTouches.length):(h=d.clientX,m=d.clientY);var l=d.target.getBoundingClientRect();h-=l.left;m-=l.top;h=e.ed/b.offsetWidth*h|0;m=e.gd/b.offsetHeight*m|0;var v=h-e.wd;var n=m-e.xd;var t=l=!1;var w=h>=e.kc&&h<e.kc+e.dd&&m>=e.lc&&m<e.lc+e.fd;if(0<=v&&v<e.Ka&&0<=n+e.hc||w)if(k||a.J||d.preventDefault(),0<=v&&v<e.Ka&&0<=
n&&n<e.Ta){t=!0;d=e.Ka/e.La|0;var u=e.Ta/e.Xa|0,y=v/d|0,r=n/u|0;!a.T||r&1||(v-=d>>1,y=v/d|0,y==e.La-1&&(v=-1));u=r*u+(e.hc>>1);v-=y*d+(e.cd>>1);n-=u;0<=v&&v<e.fc&&0<=n&&n<e.gc&&(f=y,g=r,l=!0)}}v=v||0;n=n||0;d=b.offsetWidth;b=b.offsetHeight;if(c==Gb||c==S)for(y=0;y<a.v.length;y++)r=a.v[y],c==S?r.Ua(r.id,!1):(u=n/(b/r.Re|0)|0,(v/(d/r.Qe|0)|0)==r.gf&&u==r.hf&&r.Ua(r.id,!0));if(!k)if(c==Gb)e.Na=h,e.bb=m,t?(Ab(a,f,g),l&&a.g&&Eb(a.time,a.N,a.g,!0)):w&&a.L.na();else if(c==Hb)0<=e.Na&&0<=e.bb&&a.U?Ab(a,f,
g):a.o&&a.o(f,g);else if(c==S){if(c=a.g)c=a.time,f=a.N,c=c.a&&0<f&&f<=c.b.length?0<=c.b[f-1].ga:!1;c||Ab(a,-1,-1);e.Na=e.bb=-1}else E(a,"unrecognized action: "+c)}function Ab(a,b,c){if(b!=a.H||c!=a.M)a.H=b,a.M=c,a.K&&a.K(b,c)}var Gb=1,Hb=2,S=3,sb="surface",Lb=3,Jb=170,Mb=512,Kb=3584,T={},Ib=(T[J.Nc]=2,T[J.pc]=8,T[J.mc]=32,T[J.zb]=128,T[J.fb]=Mb,T[J.Dc]=1024,T[J.Kc]=2048,T);A.Input=rb;
function Nb(a,b,c){M.call(this,a,b,c,["color","backgroundColor"]);a=this.aa[Ob];if(!a)throw Error("LED "+this.O.aa[Ob]+" binding for '"+Ob+"' missing");b=document.createElement("canvas");if(!b||!b.getContext)throw a.innerHTML="LED device requires HTML5 canvas support",Error("LED device requires HTML5 canvas support");this.ya=a;this.type=Pa(G(this,"type",Pb,Qb),Rb,Sb);this.f=Tb[this.type][0];this.j=Tb[this.type][1];this.width=G(this,"width",this.f,void 0);this.height=G(this,"height",this.j,void 0);
this.g=G(this,"cols",1,void 0);this.v=this.g+G(this,"colsExtra",0,void 0);this.U=G(this,"rows",1,void 0);this.J=this.U+G(this,"rowsExtra",0,void 0);this.$=this.width*this.g;this.M=this.height*this.U;this.i=Ub("black",0);this.c=Vb(this.O.color)||this.i;this.fa=Ub(this.c,1,.25);this.ea=Ub(this.c,1,2);this.h=Vb(this.O.backgroundColor);this.ha=G(this,"fixed",!1);this.ha||(b.style.width="100%",b.style.height="auto");this.da=G(this,"hexagonal",!1);this.ia=G(this,"highlight",!0);this.K=G(this,"persistent",
this.type<Sb);b.setAttribute("width",this.$.toString());b.setAttribute("height",this.M.toString());b.style.backgroundColor=this.i;a.appendChild(b);this.ba=b.getContext("2d");if(this.m=document.createElement("canvas"))this.m.width=this.V=this.f*this.g,this.m.height=this.o=this.j*this.U,this.b=this.m.getContext("2d");this.qa=(this.J+1)*this.v*4;this.a=Array(this.qa);this.ra=this.g<this.v?4*(this.v-this.g):0;this.w=this.H=!1;this.s=this.T=0;this.N=-1;var d=this;this.time=Q(this,"Time");Wb(this.time,
function(e){Xb(d,!1,e)});Yb(d)}x(Nb,M);function Yb(a){for(var b=a.a,c=0;c<b.length;c+=4){var d=a,e=b,f=c;e[f]=d.type<Sb?Zb:" ";e[f+1]=d.c==d.i?null:d.c;e[f+2]=0;e[f+3]=$b}a.w=a.H=!0;Xb(a,!0)}function ac(a){a.h?(a.b.fillStyle=a.h,a.b.fillRect(0,0,a.V,a.o)):a.b.clearRect(0,0,a.V,a.o)}
function Xb(a,b,c){b=void 0===b?!1:b;c=void 0===c?0:c;if(a.w||b){if(a.type<Sb){var d=0;if(!a.K||b)ac(a);else if(a.s){d=a.g-a.s;var e=a.f*d;a.b.drawImage(a.m,a.f*a.s,0,e,a.o,0,0,e,a.o)}for(var f=e=0;f<a.J;f++){for(var g=0;g<a.g;g++){var k=a.a[e],h=a.a[e+1]||a.i,m=a.ia&&e==a.N;if(a.a[e+3]&$b||m||b){if(g>=d)a:{var l=a,v=k;k=h;var n=g;h=f;var t=m;n=void 0===n?0:n;h=void 0===h?0:h;t=void 0===t?!1:t;var w=0;if(l.da&&!(h&1)&&(w=l.f>>1,n==l.g-1))break a;if(k&&k!=l.c){t=t?Ub(k,1,2):k;var u=Ub(k,1,.25)}else t=
t?l.ea:l.c,u=l.fa;k=!1;v=v?t:u;t==l.i&&(v=l.h,k=!0);t=n*l.f+w;u=h*l.j;l.K&&(n=n*l.f+w,h*=l.j,l.h?(l.b.fillStyle=l.h,l.b.fillRect(n,h,l.f,l.j)):l.b.clearRect(n,h,l.f,l.j));l.b.fillStyle=v;h=bc[l.type];3==h.length?(l.b.beginPath(),l.b.arc(t+h[0],u+h[1],h[2],0,2*Math.PI),k?(l.b.globalCompositeOperation="destination-out",l.b.fill(),l.b.globalCompositeOperation="source-over"):l.b.fill()):l.b.fillRect(t+h[0],u+h[1],h[2],h[3])}a.a[e+3]=m?a.a[e+3]|$b:a.a[e+3]&~$b}e+=4}e+=a.ra}a.s=0}else{b="";for(d=0;d<a.a.length;d+=
4)b+=a.a[d]||" ",a.a[d+3]&cc&&(b+=".");ac(a);for(f=e=d=0;d<b.length;d++){h=b[d];"."==h&&e&&e--;g=a;m=e;l=f;m=void 0===m?0:m;l=void 0===l?0:l;if(h=dc[h])for(k=0;k<h.length;k++)if(n=g,w=ec[h[k]]){v=(void 0===m?0:m)*n.f;t=(void 0===l?0:l)*n.j;n.b.fillStyle=n.c;n.b.beginPath();if(3==w.length)n.b.arc(v+w[0],t+w[1],w[2],0,2*Math.PI);else for(u=0;u<w.length;u+=2)u?n.b.lineTo(v+w[u],t+w[u+1]):n.b.moveTo(v+w[u],t+w[u+1]);n.b.closePath();n.b.fill()}if(++e==a.g&&(e=0,++f==a.J))break}}a.ba.globalCompositeOperation=
a.h&&a.c!=a.i?"source-over":"copy";a.ba.drawImage(a.m,0,0,a.V,a.o,0,0,a.$,a.M);a.w=!1;a.N=-1}else a.K||a.H||(!c||!a.T||c-a.T>=(1E3/60|0))&&Yb(a);a.H=!1;c&&(a.T=c)}function Vb(a){return(a=a||void 0)&&hb[a]||a}
function Ub(a,b,c){b=void 0===b?1:b;c=void 0===c?1:c;if(a){var d=[];a=hb[a]||a;var e=a;var f=16;var g=e.match(/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i);g||(f=10,g=e.match(/^rgba?\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*,?\s*(\d+|)\)$/i));if(g){for(e=1;e<g.length;e++)d[e-1]=Number.parseInt(g[e],f);d.length=e-1;f=!0}else f=!1;if(f){a="rgba(";for(f=0;3>f;f++)g=Math.round(d[f]*c),g=0>g?0:255<g?255:g,a+=g+",";a+=(f<d.length?d[f]:b)+")"}}return a}
Nb.prototype.ma=function(a){var b=a.shift(),c=a.shift();a=a.shift();if(b==this.c&&c==this.h&&a&&a.length==this.a.length){this.a=a;for(b=0;b<=this.a.length-4;b+=4)this.a[b+1]==this.i&&(this.a[b+1]=null);Xb(this,!0);return!0}return!1};Nb.prototype.oa=function(a){this.a&&(a.push(this.c),a.push(this.h),a.push(this.a))};
var Rb=0,Pb=1,Sb=3,Qb={small:Rb,round:Pb,square:2,digit:Sb},Ob="container",Zb=0,cc=1,$b=128,fc={},bc=(fc[Rb]=[4,4,4],fc[Pb]=[16,16,14],fc[2]=[2,2,28,28],fc),Tb=[[8,8],[32,32],[32,32],[96,128]],ec={A:[30,8,79,8,67,19,37,19],B:[83,10,77,52,67,46,70,22],C:[77,59,71,100,61,89,64,64],D:[28,91,58,91,69,104,15,104],E:[18,59,28,64,25,88,12,100],F:[24,10,34,21,31,47,18,52],G:[24,56,34,50,60,50,71,56,61,61,33,61],P:[80,102,8]},dc={" ":[],0:"ABCDEF".split(""),1:["B","C"],2:["A","B","D","E","G"],3:["A","B","C",
"D","G"],4:["B","C","F","G"],5:["A","C","D","F","G"],6:"ACDEFG".split(""),7:["A","B","C"],8:"ABCDEFG".split(""),9:"ABCDFG".split(""),A:"ABCEFG".split(""),B:["C","D","E","F","G"],C:["A","D","E","F"],D:["B","C","D","E","G"],E:["A","D","E","F","G"],F:["A","E","F","G"],"-":["G"],".":["P"]};A.LED=Nb;
function gc(a,b,c){M.call(this,a,b,c);this.fa=G(this,"cyclesMinimum",1E5,void 0);this.ra=G(this,"cyclesMaximum",1E9,void 0);this.V=Pa(G(this,"cyclesPerSecond",1E6,void 0),this.fa,this.ra);this.K=1E3/60;this.ya=G(this,"updatesPerSecond",2,void 0)||2;this.Ra=1E3/this.ya;this.qa=0;this.Sa=G(this,"timeLock",!0);this.ea=this.v=0;this.da=this.g=1;this.ia=this.i=this.V/1E4/100;this.$=[];this.o=[];this.b=[];this.T=[];this.ha=this.a=this.J=this.m=!1;this.s=this.f=0;a=Ja("requestAnimationFrame");if(!a){a="setTimeout";
var d=this.K}this.Ga=window[a].bind(window,this.qd.bind(this),d);this.Qa=window[Ja("cancelAnimationFrame")||"clearTimeout"].bind(window);this.N=this.M=this.h=this.c=this.U=0;hc(this)||ic(this,this.da)}x(gc,M);function Wb(a,b){a.$.push(b)}p=gc.prototype;
p.Ja=function(a,b){var c=this;switch(a){case jc:b.onclick=function(){kc(c)&&(c.a?lc(c):c.start())};break;case mc:b.onclick=function(){ic(c,c.g<<1);nc(c,oc(c.i))};break;case pc:b.onclick=function(){qc(c)};break;case rc:b.addEventListener("mousedown",function(){c.m=!0}),b.addEventListener("mouseup",function(){hc(c);c.m=!1}),b.addEventListener("mousemove",function(){c.m&&hc(c)}),b.addEventListener("change",function(){c.m=!0;hc(c);c.m=!1})}M.prototype.Ja.call(this,a,b)};
function zb(a,b,c){var d=void 0===d?-1:d;var e=a.b.length+1;a.b.push({id:b,Xc:c,Wa:d,ga:-1});0<=d&&Eb(a,e,d);return e}
function sc(a,b,c,d){var e=0,f=a.i,g=1E6*f;b&&c&&(f=b/(10*c)/100,a.u(16384,"calcSpeed(%d cycles, %5.3fms): %5.3fMhz\n",b,c,f),d>a.K&&(1<a.g&&(a.g>>=1,a.u(2097152,"warning: frame time (%5.3fms) exceeded maximum (%5.3fms), target multiplier now %d\n",d,a.K,a.g)),e=d));a.v=f;a.ea=f/a.ia;b=a.ea/a.g;a.U=g/b/60+1E-8;a.u(16384,"nCyclesDepositPerFrame(%5.3f) = nCyclesPerSecond(%d) / nDivisor(%5.3f) / nFramesPerSecond(%d)\n",a.U,g,b,60);return e}
function tc(a,b){a.M=a.h=b;if(!a.o.length)return a.h=0,a.M;for(var c=0;0<a.h;){if(c<a.o.length){var d=a.o[c++];b=d.rd.call(d,b)||1}else c=b=0;a.h-=b}return a.M-a.h}function uc(a,b){b=void 0===b?a.M-a.h:b;if(!a.a){if(a.c)for(var c=0;c<a.o.length;c++){var d=a.o[c];d.sd.call(d)}a.c=b}a.c-=b;1>a.c&&(a.J=!0);a.N+=b;a.M=a.h=0;a.a||(a.N=0);return b}
function vc(a,b){b=void 0===b?0:b;if(b){var c=b;a.c+=b}else for(c=a.c,1>c&&(c=a.c+=a.U),0>c&&(a.u(2097152,"warning: cycle count dropped below zero: %f\n",c),c=a.c=0),c|=0,b=a.b.length;0<b;b--){var d=a.b[b-1];!(0>d.ga)&&c>d.ga&&(c=d.ga)}return c}function oc(a){1<=a?a=a.toFixed(2)+"Mhz":(a=Math.round(1E6*a),a=999>=a?a+"Hz":Math.ceil(a/1E3)+"Khz");return a}function wc(a){a.u(16384,"getSpeedCurrent(%5.3fhz)\n",1E6*a.v);return a.a&&a.v?oc(a.v):"Stopped"}
function kc(a){return a.ha?!0:(E(a,"not powered"),!1)}function xc(a,b){if(1<=b)for(var c=a.b.length;0<c;c--){var d=a.b[c-1];0>d.ga||(d.ga-=b,0>=d.ga&&(d.ga=-1,d.Xc(),0<=d.Wa&&Eb(a,c,d.Wa)))}}p.na=function(a){this.ha=a;void 0===this.W&&(this.W=Q(this,"Debugger",!1))&&this.W.jb(this,"time","dump time state",this.ld)};function qc(a,b){kc(a)&&(a.a?E(a,"already running"):a.f?lc(a):yc(a,b))}
p.qd=function(a){a=void 0===a?Date.now():a;this.s=0;if(this.a){var b=Date.now();if(this.w){var c=b-this.H-this.K;c>this.K&&(this.j+=c,this.u(2097152,"warning: browser throttling detected, compensating by %5.3fms\n",c))}this.H=b;this.j||(this.j=b);this.ba=0;try{this.J=!1;do xc(this,uc(this,tc(this,vc(this))));while(this.a&&!this.J)}catch(d){E(this,d.message),lc(this)}this.w=Date.now();this.ba&&(this.j+=this.ba,this.H+=this.ba);this.H+=sc(this,this.N,this.w-this.j,this.w-this.H);this.w-this.qa>=this.Ra&&
this.update();for(b=0;b<this.$.length;b++)this.$[b](a);this.s=this.Ga()}};function ic(a,b){if(void 0!==b){if(1>b||!a.m&&0<a.v&&a.v<.9*a.i)b=a.da;a.g=b;b=a.ia*a.g;a.i!=b&&(a.i=b,nc(a,oc(a.i)))}a.j=a.w=0;a.c=a.N=0;sc(a);for(b=a.b.length;0<b;b--){var c=a.b[b-1];0<=c.Wa&&Eb(a,b,c.Wa,!0)}}function hc(a){var b=a.aa[rc];return b?(ic(a,Math.floor((b.value-b.min)/(b.max-b.min)*(a.ra-a.fa)+a.fa)/a.V|0),!0):!1}
function Eb(a,b,c,d){0<b&&b<=a.b.length&&(b=a.b[b-1],d||0>b.ga)&&(c=Math.ceil(a.V*(a.Sa?a.da:a.ea)/1E3*(void 0===c?1E3:c)),a.a&&(c+=uc(a)),b.ga=c)}p.start=function(){if(this.a||this.f)return!1;this.a=!0;this.j=this.w=0;this.update(!0);this.s=this.Ga();return!0};function yc(a,b){b=void 0===b?1:b;a.a||(b&&!a.f&&(a.f=b),a.f&&(a.f--,xc(a,uc(a,tc(a,vc(a,1)))),a.update(!1),a.f&&setTimeout(function(){yc(a,0)},0)))}
function lc(a){return a.a?(a.a=!1,uc(a),a.s&&(a.Qa(a.s),a.s=0),a.update(!0),!0):a.f?(a.f=0,a.update(!0),!0):!1}p.update=function(a){a&&E(this,this.a?"started with "+oc(this.i)+" target":"stopped");ab(this,jc,this.a?"Halt":"Run");ab(this,pc,this.f?"Stop":"Step");this.m||nc(this,wc(this));for(var b=0;b<this.T.length;b++){var c=this.T[b];c.nd.call(c,void 0!=a)}this.qa=Date.now();this.J=!0};function nc(a,b){ab(a,zc,b);ab(a,mc,b)}
p.ld=function(){var a=this.l("nCyclesPerSecond: %f\n",this.V);a+=this.l("nUpdatesPerSecond: %f\n",this.ya);a+=this.l("nTargetMultiplier: %f\n",this.g);return a+=this.l("nCyclesDepositPerFrame: %f\n",this.U)};var jc="run",mc="setSpeed",zc="speed",pc="step",rc="throttle";A.Time=gc;
function Ac(a,b,c){M.call(this,a,b,c);this.type="static"==c.type?Bc:Cc;this.Y=c.addrWidth||16;this.g=Math.pow(2,this.Y);this.j=this.g-1|0;this.b=c.blockSize||(16<this.Y?4096:1024);this.b>this.g&&(this.b=this.g);this.m=this.g/this.b|0;this.c=Math.log2(this.b)|0;this.i=(1<<this.c)-1;this.f=c.dataWidth||8;this.a=Array(this.m);this.h=0;a=new U(a,b+"[NONE]",{size:this.b,bus:this.X});for(b=0;b<this.g;b+=this.b)Dc(this,b,this.b,V.NONE,a);Ec(this,this.type)}x(Ac,M);
function Dc(a,b,c,d,e){for(var f=0,g=b>>>a.c;0<c&&g<a.a.length;){var k=g*a.b,h=a.b-(b-k);h>c&&(h=c);var m=a.a[g];if(b!=k||h!=a.b||m&&m.type!=V.NONE)break;m=a.X+"["+B(a,b,16,a.Y)+"]";if(e)if(e.size==a.b)b=e;else{var l=void 0;if(e.values&&(l=e.values.slice(f,f+h),l.length!=h))break;b=new U(a.S,m,{type:d,la:b,size:h,bus:a.X,values:l})}else b=new U(a.S,m,{type:d,la:b,size:h,bus:a.X});a.a[g]=b;b=k+a.b;c-=h;f+=h;g++}}
function Fc(a,b){for(var c=V.Jc,d=0,e=0;e<a.a.length;e++){var f=a.a[e];f&&f.type&c&&(b(f),d++)}return d}function Gc(a,b,c){if(!(b&a.i)){b>>>=a.c;var d=a.a[b];a.a[b]=c}return d}p=Ac.prototype;p.xa=function(){};p.nb=function(a){return a&&this.ma(a)?!0:!1};p.Ma=function(a){this.oa(a)};p.ma=function(a){for(var b=0;b<this.a.length;b++){var c=this.a[b];if((this.type==Cc||c.type&V.Fa)&&c.ma){var d=a.shift();if(!c.ma(d))return!1}}return!0};
p.oa=function(a){for(var b=0;b<this.a.length;b++){var c=this.a[b];if((this.type==Cc||c.type&V.Fa)&&c.oa){var d=[];c.oa(d);a.push(d)}}};p.pd=function(a){return this.a[a>>>this.c].ua(a&this.i)};p.ud=function(a,b){this.a[a>>>this.c].pa(a&this.i,b)};function Ec(a,b){var c=a.h;a.h+=b;c&&a.h||(a.ua=a.pd,a.pa=a.ud)}p.Ya=function(a,b){return this.a[a>>>this.c].Ya(b)?(Ec(this,1),!0):!1};p.rb=function(a,b){return this.a[a>>>this.c].rb(b)?(Ec(this,1),!0):!1};
p.Za=function(a,b){return this.a[a>>>this.c].Za(b)?(Ec(this,-1),!0):!1};p.tb=function(a,b){return this.a[a>>>this.c].tb(b)?(Ec(this,-1),!0):!1};var Bc=0,Cc=1;A.Bus=Ac;
function U(a,b,c){M.call(this,a,b,c);this.la=c.addr;this.size=c.size;this.type=c.type||V.NONE;this.b=(a=this.O.bus)?O(this,a):Q(this,a="Bus");if(!this.b)throw Error(this.l("unable to find bus '%s'",a));this.w=this.b.f;this.v=Math.pow(2,this.w)-1;this.values=this.g=null;a=this.jc;b=this.ub;this.b.type==Bc&&(b=this.vd,8==this.w&&!1!==mb(this,"ArrayBuffer")&&(this.g=new ArrayBuffer(this.size),new DataView(this.g,0,this.size),this.values=new Uint8Array(this.g,0,this.size),new Uint16Array(this.g,0,this.size>>
1),new Int32Array(this.g,0,this.size>>2)));this.s=!1;Hc(this,c.values);switch(this.type){case V.NONE:this.ua=this.ob;this.pa=this.ab;break;case V.Qb:this.ua=a;this.pa=this.ab;break;case V.Fa:this.ua=a,this.pa=b}this.h=this.f=0;this.o=this.j=this.i=this.m=null}x(U,M);function Hc(a,b){if(!a.values&&a.type>V.NONE)b?a.values=b:a.values=Array(a.size).fill(a.v);else if(b)for(var c=0;c<a.size;c++)a.values[c]=b[c]}p=U.prototype;p.xa=function(){this.type>=V.Fa&&this.values.fill(0)};p.ob=function(){return this.v};
p.jc=function(a){return this.values[a]};p.ab=function(){};p.ub=function(a,b){this.values[a]=b};p.vd=function(a,b){this.values[a]=b;this.s=!0;this.f?this.j=this.ub:this.pa=this.ub};p.Ya=function(a){if(!this.h){var b=this;this.h++;this.i=a;this.o=this.ua;this.ua=function(c){var d=b.o(c);b.i(b.la,c,d);return d};return!0}return this.i==a?(this.h++,!0):!1};
p.rb=function(a){if(!this.f){var b=this;this.f++;this.m=a;this.j=this.pa;this.pa=function(c,d){b.m(b.la,c,d);b.j(c,d)};return!0}return this.m==a?(this.f++,!0):!1};p.Za=function(a){return this.h&&this.i==a?(--this.h||(this.ua=this.o,this.o=this.i=null),!0):!1};p.tb=function(a){return this.f&&this.m==a?(--this.f||(this.pa=this.j,this.j=this.m=null),!0):!1};
p.ma=function(a){var b=a.shift();if(this.X==b){this.s=a.shift();a.shift();if(a=a.shift()){var c=this.size;c=void 0===c?0:c;if(a.length!=c){b=0;c=c?Array(c):[];for(var d=0;d<a.length-1;)for(var e=a[d++],f=a[d++];e--;)c[b++]=f;a=c}Hc(this,a)}return!0}return!1};p.oa=function(a){a.push(this.X);a.push(this.s);a.push(!1);a.push(this.values?va(this.values):this.values)};var V={NONE:1,Qb:2,Fa:4,Jc:14,Le:12};A.Memory=U;
function Ic(a,b,c){U.call(this,a,b,c);void 0!=c.addr&&Dc(this.b,c.addr,c.size,V.NONE,this);this.a={};this.c={}}x(Ic,U);Ic.prototype.ob=function(a){var b=this.la+a,c=this.a[b];if(c)return c(b);this.u(136,"readNone(%#04x): unknown port\n",b);return U.prototype.ob.call(this,a)};Ic.prototype.ab=function(a,b){var c=this.la+a,d=this.c[c];d?d(c,b):(this.u(136,"writeNone(%#04x,%#04x): unknown port\n",c,b),U.prototype.ab.call(this,a,b))};A.Ports=Ic;
function Jc(a,b,c){c.type=V.Fa;U.call(this,a,b,c);Dc(this.b,c.addr,c.size,c.type,this)}x(Jc,U);A.RAM=Jc;
function Kc(a,b,c){c.type=V.Qb;U.call(this,a,b,c);Dc(this.b,c.addr,c.size,c.type,this);this.R=this.W=void 0;if(A.LED&&this.aa[Ma]){var d=this;this.c=Math.pow(2,Math.ceil(Math.log2(this.values.length)/2));this.H=this.values.length/this.c|0;this.a=new Nb(a,b+"LEDs",{"class":"LED",bindings:{container:La(this)},type:Pb,cols:this.c,rows:this.H,color:G(this,"colorROM","green"),backgroundColor:G(this,"backgroundColorROM","black"),persistent:!0}),Yb(this.a);this.J=new rb(a,b+"Input",{"class":"Input",location:[0,
0,this.a.$,this.a.M,this.c,this.H],bindings:{surface:La(this)}});this.K=Na(this)||"";vb(this.J,function(e,f){if(d.R){var g=d.K;0<=e&&0<=f&&(e=f*d.c+e,f=d.R,g=f.W&&Lc(f.W,d.la+e,1)||"");ab(d,Oa,g)}})}}x(Kc,U);
Kc.prototype.ma=function(a){var b=!0,c=a.shift();if(c&&this.a){var d=c.length;this.a.a.length==d?(this.a.a=c,Xb(this.a,!0)):(this.u("inconsistent saved LED state (%d), unable to load\n",d),b=!1)}a.length&&(d=(a=a.shift())&&a.length||-1,this.values.length==d?this.values=a:(this.u("inconsistent saved ROM state (%d), unable to load\n",d),b=!1));return b};Kc.prototype.na=function(){void 0===this.R&&(this.R=Q(this,"CPU"));void 0===this.W&&(this.W=Q(this,"Debugger",!1))&&this.W.kb&&this.W.kb(this.O.symbols)};
Kc.prototype.jc=function(a){if(this.a){var b=this.a,c=$b;c=(void 0===c?0:c)&129;var d=4*((a/this.c|0)*b.v+a%this.c);if(d<=b.a.length-4){if(1!==b.a[d]||(b.a[d+3]&129)!==c)b.a[d]=1,b.a[d+3]=b.a[d+3]&-130|c|$b,b.w=!0;b.N=d;b.H=!0;b.s=0}}return this.values[a]};Kc.prototype.oa=function(a){this.a&&(a.push(this.a.a),a.push(this.values))};var Ma="array",Oa="cellDesc";A.ROM=Kc;
function W(a,b,c){c["class"]="CPU";M.call(this,a,b,c);this.W=void 0;this.ra=this.pb=0;this.time=Q(this,"Time");this.time.o.push(this);this.time.T.push(this);this.M=this.m=0}x(W,M);W.prototype.abort=function(a){this.ra=this.pb;E(this,a.message);lc(this.time)};function Mc(a,b){a.W=b;return a.ta}W.prototype.rd=function(a){this.M=this.m=void 0===a?0:a;return this.M-this.m};W.prototype.sd=function(){this.M-=this.m;this.m=0};function Nc(a,b,c){W.call(this,a,b,c)}x(Nc,W);
function Oc(a,b,c){W.call(this,a,b,c);this.K=+c.model||Pc;this.ea=+c.addrReset||0;this.ba=Q(this,"Bus");Q(this,"Panel",!1);this.Wc=new Ic(a,b+".IOPAGE",{size:this.ba.b});this.da=0;this.fa=null;Q(this,"Input",!1);this.K<=Qc?(this.Sa=~(Rc|Sc|Uc|Vc)&65535,this.Qa=0):(this.Sa=~(Rc|(this.K<=Wc?Sc:0))&65535,this.Qa=this.K>Wc?Sc:0);this.dc=this.vb=0;this.g=null;this.ya=[];Xc(this)}x(Oc,Nc);
function Xc(a){a.o=65536;a.v=32768;a.w=65535;a.s=32768;a.i=15;a.a=[0,0,0,0,0,0,0,a.ea,-1,-2,-3,-4,-5,-6,-7,-8];a.j=[0,0,0,0,0,0];a.$=[0,0,0,0];a.$b=[[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]];a.bc=[[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]];a.cc=[0,
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];a.Yb=[0,0,0,0,0,0,0,0];a.ia=0;a.Ra=-1;a.Wb=0;a.b=0;Yc(a);for(var b={va:0};7>=b.va;b={va:b.va},b.va++)P(a,"R"+b.va,function(c){return function(){return a.a[c.va]}}(b),function(c){return function(d){return a.a[c.va]=d&65535}}(b));kb(a,"SP","R6");kb(a,Zc.Fc,"R7");P(a,"CF",function(){return a.o&65536&&$c?1:0},function(c){a.o=c?65536:0});P(a,"NF",function(){return a.s&32768&&ad?1:0},function(c){a.s=c?32768:0});P(a,"VF",function(){return a.v&
32768&&bd?1:0},function(c){a.v=c?32768:0});P(a,"ZF",function(){return(a.w&65535?0:cd)?1:0},function(c){a.w=c?0:1});P(a,"PS",function(){return dd(a)},function(c){return ed(a,c)});P(a,"PI",function(){return a.U},function(c){if(c&=fd){var d=c>>gd;do c+=hd;while(d>>=1);a.b|=id}a.U=c});P(a,"ER",function(){return a.qa});P(a,"SL",function(){return a.V&65280},function(c){a.V=c|255});P(a,"M0",function(){return jd(a)},function(c){return kd(a,c)});P(a,"M1",function(){return ld(a)});P(a,"M2",function(){return md(a)});
P(a,"M3",function(){return a.h},function(c){return nd(a,c)})}function Yc(a){a.f=0;a.N=0;a.T=0;a.h=0;a.qa=0;a.U=0;a.V=255;a.ha=0;a.H=0;a.J=0;a.Ga=a.a[7];a.c=0;a.g=null;od(a)}function jd(a){var b=a.f;b&pd||(b=b&~(qd|rd|sd)|a.H<<5|a.J<<1);return b}function kd(a,b){b&=~qd;if(a.f!=b){b&pd&&!(a.f&pd)&&(a.N=a.c>>16&65535,a.T=a.c&65535);a.f=b;a.H=(b&sd)>>td;a.J=(b&rd)>>ud;var c=0;b&(vd|wd)&&(c=xd,b&vd&&(c|=yd));a.ha!=c&&(a.ha=c,od(a))}}
function ld(a){a.f&pd||(a.N=a.c>>16&65535);a=a.N;a&65280&&(a=(a<<8|a>>8)&65535);return a}function md(a){a.f&pd||(a.T=a.c&65535);return a.T}function nd(a,b){a.K<Pc&&(b&=~(zd|Ad));a.h!=b&&(a.h=b,od(a))}function od(a){a.fa&&Gc(a.ba,a.da,a.fa);a.da=a.ha?a.h&zd?Bd:Cd:Dd;a.fa=Gc(a.ba,a.da,a.Wc)}
Oc.prototype.ma=function(a){if(!a||!a.length)return E(this,"invalid saved state"),!1;var b=a.shift(),c=a.shift();if(b!=this.X||2!==(c|0))return this.u("CPU state mismatch (%s %3.2f)\n",b,c),!1;try{this.a=a.shift();this.j=a.shift();this.$=a.shift();this.$b=a.shift();this.bc=a.shift();this.cc=a.shift();this.Yb=a.shift();this.qa=a.shift();this.Wb=a.shift();this.U=a.shift();this.V=a.shift();this.H=a.shift();this.J=a.shift();this.Ga=a.shift();this.b=a.shift();this.c=a.shift();this.Ra=a.shift();this.vb=
a.shift();this.dc=a.shift();this.ea=a.shift();ed(this,a.shift());kd(this,a.shift());this.N=a.shift();this.T=a.shift();nd(this,a.shift());for(var d=a.shift(),e=d.length-1;0<=e;e--){a:{for(a=0;a<this.ya.length;a++){var f=this.ya[a];if(f.td===d[e]){var g=f;break a}}g=null}g&&(g.next=this.g,this.g=g)}}catch(k){return E(this,"CPU state error: "+k.message),!1}return!0};
Oc.prototype.oa=function(a){a.push(this.X);a.push(2);a.push(this.a);a.push(this.j);a.push(this.$);a.push(this.$b);a.push(this.bc);a.push(this.cc);a.push(this.Yb);a.push(this.qa);a.push(this.Wb);a.push(this.U);a.push(this.V);a.push(this.H);a.push(this.J);a.push(this.Ga);a.push(this.b);a.push(this.c);a.push(this.Ra);a.push(this.vb);a.push(this.dc);a.push(this.ea);a.push(dd(this));a.push(jd(this));a.push(ld(this));a.push(md(this));a.push(this.h);a.push(Ed(this))};
function Ed(a){var b=[];for(a=a.g;a;)b.push(a.td),a=a.next;return b}function dd(a){return a.i=a.i&(Vc|Uc|Sc|Fd|Gd)|(a.s&32768?ad:0)|(a.w&65535?0:cd)|(a.v&32768?bd:0)|(a.o&65536?$c:0)}function ed(a,b){b&=a.Sa;a.s=b<<12;a.w=~b&4;a.v=b<<14;a.o=b<<16;if((b^a.i)&a.Qa)for(var c=a.j.length;0<=--c;){var d=a.a[c];a.a[c]=a.j[c];a.j[c]=d}a.ia=b>>Hd&Id;c=a.i>>Hd&Id;a.ia!=c&&(a.$[c]=a.a[6],a.a[6]=a.$[a.ia]);a.i=b;a.b&=~Jd;a.b|=a.g?Jd:id}
Oc.prototype.toString=function(){var a="";if(this.W)for(var b="R0 R1 R2 R3 R4 R5  SP PC PS PI SL NF ZF VF CF  M0 M1 M2 M3 ER  SR AR DR".split(" "),c=0;c<b.length;c++){var d=b[c];if(d){var e=16;"F"==d[1]&&(e=1);var f=nb(this,d);void 0!=f&&(a+=this.W.l("%s=%*n ",d,e,f))}else a+="\n"}return a};
var Qc=1120,Wc=1140,Pc=1170,Id=3,$c=1,bd=2,cd=4,ad=8,Gd=16,Fd=224,Rc=1792,Sc=2048,Uc=12288,Vc=49152,Hd=14,fd=65024,hd=34,gd=9,id=1,Jd=2,yd=2,xd=4,vd=1,rd=30,sd=96,wd=256,qd=3072,pd=57344,ud=1,td=5,zd=16,Ad=32,Dd=57344,Cd=253952,Bd=4186112;A.PDP11=Oc;
function Kd(a,b,c){c["class"]="Debugger";M.call(this,a,b,c);var d=this;this.Z=c.defaultRadix||16;this.K=["(",")"];wa(this,"a",function(f,g,k,h,m){return B(d,m.I,d.Z,k)});wa(this,"n",function(f,g,k,h,m){return B(d,m,d.Z,k,0>g.indexOf("#")?"":void 0)});this.$=this.o=0;this.v={};this.ba=[];this.ia=[];this.R=Q(this,"CPU");this.ta=Mc(this.R,this);this.da=Q(this,"Input",!1);if(a=this.R.O.busMemory||c.busMemory){this.a=O(this,a);if(a=this.R.O.busIO||c.busIO)this.f=O(this,a,!1);this.f||(this.f=this.a)}else this.a=
this.f=Q(this,"Bus");this.s=this.a.Y;this.ha=Math.pow(2,this.s)-1|0;this.j=this.U=0;this.i=[];for(var e in X)this.i[X[e]]=[];this.h=[];this.h[X.ja]=this.a;this.h[X.Ia]=this.a;this.h[X.Da]=this.f;this.h[X.Ea]=this.f;this.g=[];this.g[X.ja]=this.$c.bind(this);this.g[X.Ia]=this.ad.bind(this);this.g[X.Da]=this.Yc.bind(this);this.g[X.Ea]=this.Zc.bind(this);this.c=[];this.w=void 0;this.J=null;this.M=0;this.time=Q(this,"Time");this.time.T.push(this);this.m=[];this.N="";this.jb(this,"state","dump machine state",
this.kd);this.T=Ld();this.ea=Ld();this.V=!1;this.H=0;this.b=[];Ha(this,this.md.bind(this));(c=mb(this,"commands"))&&Ua(this,c)}x(Kd,M);p=Kd.prototype;p.jb=function(a,b,c,d){this.m.push({jd:a,name:b,hd:c,Ua:d})};function Md(a,b,c){for(var d,e=0;e<a.m.length;e++){var f=a.m[e];if(f.name==b){d=f.Ua.call(f.jd,c);break}}return d}
p.kb=function(a){if(a&&a.length)for(var b=0;b<a.length-2;b+=3){var c=Nd(this,a[b]);if(c){var d=Od[a[b+1]];if(d){c={za:c,type:d,name:a[b+2]};d=this.ba;var e=c,f=Pd(d,e,this.ec);0>f&&d.splice(-(f+1),0,e);d=this.ia;e=Pd(d,c,this.bd);0>e&&d.splice(-(e+1),0,c)}}}};function Pd(a,b,c){var d=0,e=a.length,f=0;for(void 0===c&&(c=function(h,m){return h>m?1:h<m?-1:0});d<e;){var g=d+e>>1,k=void 0;k=c(b,a[g]);0<k?d=g+1:(e=g,f=!k)}return f?d:~d}p.ec=function(a,b){return a.name>b.name?1:a.name<b.name?-1:0};
p.bd=function(a,b){return a.za.I>b.za.I?1:a.za.I<b.za.I?-1:0};function Qd(a,b,c,d){d=void 0===d?a.a:d;b.I=b.I+c&d.j}function Ld(a){a=void 0===a?0:a;var b=Rd.Gc;return"number"==typeof a?{I:a,qb:-1,type:b}:{I:a.I,qb:a.qb,type:a.type}}
function Nd(a,b,c){if(b){var d=Ld();var e=0,f=b.charAt(e);switch(f){case "&":e++;break;case "#":e++;d.type=Rd.Hc;break;case "%":e++,f=b.charAt(e),"%"==f?e++:d.type=Rd.Vb}f=b.indexOf(":",e);if(0<=f){var g=Sd(a,b.substring(e,f),c);void 0==g?d=null:(d.qb=g,e=f+1)}d&&(b=Sd(a,b.substring(e),c),void 0==b?d=null:d.I=b&a.ha)}return d}function Td(a,b,c,d){d=void 0===d?a.a:d;a.j++;var e=d.ua(b.I);c&&Qd(a,b,c,d);a.j--;return e}
function Ud(a,b,c){if(32>=a.s)return b&c;b=Y(a,b,0,!0);c=Y(a,c,0,!0);return((b/C|0)&(c/C|0))*C+((b&c)>>>0)}function Vd(a,b,c){if(32>=a.s)return b^c;b=Y(a,b,0,!0);c=Y(a,c,0,!0);return((b/C|0)^(c/C|0))*C+((b^c)>>>0)}
function Wd(a,b,c,d){for(d=void 0===d?-1:d;d--&&c.length;){var e=c.pop();if(2>b.length)return!1;var f=b.pop();var g=b.pop();switch(e){case "*":g*=f;break;case "/":if(!f)return!1;g=Math.trunc(g/f);break;case "^/":if(!f)return!1;g%=f;break;case "+":g+=f;break;case "-":g-=f;break;case "<<":g<<=f;break;case ">>":g>>=f;break;case ">>>":g>>>=f;break;case "<":g=g<f?1:0;break;case "<=":g=g<=f?1:0;break;case ">":g=g>f?1:0;break;case ">=":g=g>=f?1:0;break;case "==":g=g==f?1:0;break;case "!=":g=g!=f?1:0;break;
case "&":g=Ud(a,g,f);break;case "!":case "|":e=g;32>=a.s?g=e|f:(e=Y(a,e,0,!0),f=Y(a,f,0,!0),g=(e/C|0|f/C|0)*C+((e|f)>>>0));break;case "^!":g=Vd(a,g,f);break;case "&&":g=g&&f?1:0;break;case "||":g=g||f?1:0;break;case ",,":g=Y(a,g,18,!0)*Math.pow(2,18)+Y(a,f,18,!0);break;case "_":case "^_":"^_"==e&&(f=35-(f&255));f&&(g=Y(a,g,0,!0),g=0<f?g*Math.pow(2,f):Math.trunc(g/Math.pow(2,-f)));break;default:return!1}b.push(Y(a,g))}return!0}
function Xd(a,b,c,d,e,f){var g,k=!1,h=0,m=[],l=[],v=a.Z;for(a.Z=e;c<d;){var n=b[c++].trim();var t=c<d?b[c++]:"";if(n){var w=void 0;var u=a;var y=n,r=f;h=void 0===h?0:h;if(void 0!=y){w=nb(u,y.toUpperCase());if(void 0==w){w=void 0;var tb=u,Tc=Pd(tb.ba,{za:null,type:0,name:y},tb.ec);0<=Tc&&(w=tb.ba[Tc].za.I);if(void 0==w)if(w=y,u.v[w]?w=u.v[w].value:(w=w.substr(0,6),w=u.v[w]&&u.v[w].value),void 0==w)w=ta(y,1<y.length||10<u.Z?u.Z:10);else if(y=u.v[y]&&u.v[y].bf)r?r.push(y):(r=Sd(u,y,r),void 0!==r?w+=
r:w=void 0)}void 0!=w&&(w=Y(u,Yd(u,w,h)))}u=w}else if("{"==t){n=1;for(u=c;c<d;)if(c++,t=c<b.length?b[c++]:"","{"==t)n++;else if("}"==t&&!--n)break;u=Xd(a,b,u,c-1,a.Z,f);null!=u&&h&&(u=Yd(a,u,h));n=c<d?b[c++].trim():"";t=c<d?b[c++]:""}else{if(" "==t)continue;if("^B"==t){a.Z=2;continue}if("^O"==t){a.Z=8;continue}if("^D"==t){a.Z=10;continue}if(!(h&-1073741824)){if("+"==t)continue;if("-"==t){h=h<<2|1;continue}if("~"==t||"^-"==t){h=h<<2|2;continue}if("^L"==t){h=h<<2|3;continue}}k=!0;break}if(void 0===
u)if(f)f.push(n),u=0;else{k=!0;break}m.push(Y(a,u));if(" "==t)if(c<b.length-1&&!b[c])c++,t=b[c++];else{k=!0;break}if(!t)break;u="<"==a.K[0]?Zd:$d;if(!u[t]){k=!0;break}l.length&&u[t]<=u[l[l.length-1]]&&Wd(a,m,l,1);l.push(t);a.Z="^_"==t?10:e;h=0}if(k||!Wd(a,m,l)||1!=m.length)k=!0;k?f||a.u("parse error (%s)\n",n||t):g=m.pop();a.Z=v;return g}
function ae(a,b,c,d){for(var e,f=a.s/d|0;0<=(e=b.indexOf(c));){for(var g=0,k=e+1,h=f;k<b.length;){var m=b[k++];if(m==c){h=-1;break}if(!h)break;h--;m=m.charCodeAt(0);6==d&&(m-=32);m&=(1<<d)-1;g=Y(a,g*Math.pow(2,d)+m,d*f,!0)}if(0<=h){a.u("parse error (%c%s%c)\n",c,b,c);return}b=b.substr(0,e)+B(a,g)+b.substr(k)}return b}
function Sd(a,b,c){if(b){"{"!=a.K[0]&&(b=b.split(a.K[0]).join("{").split(a.K[1]).join("}"));b=ae(a,b,'"',8);if(!b)return d;b=ae(a,b,"'",6);if(!b)return d;16!=a.Z&&(b=b.replace(/(^|[^A-Z0-9$%.])([0-9]+)B/,"$1$2^_").replace(/\s+/g," "));b=b.split(/({|}|\|\||&&|\||\^!|\^B|\^O|\^D|\^L|\^-|~|\^_|_|&|!=|!|==|>=|>>>|>>|>|<=|<<|<|-|\+|\^\/|\/|\*|,,| )/);var d=Xd(a,b,0,b.length,a.Z,c)}return d}
function Yd(a,b,c){for(;c;){var d;switch(c&3){case 1:b=-Y(a,b);break;case 2:b=Vd(a,b,-1);break;case 3:for(d=35;0<=d&&!Ud(a,b,Math.pow(2,d));)d--;b=35-d}c>>>=2}return b}function Y(a,b,c,d){var e=b;c=c||a.s;if(d)if(32==c)e=b>>>0;else if(32>c)e=b&(1<<c)-1;else{if(a=Math.pow(2,c),0>b||b>=a)e=b%a,0>e&&(e+=a)}else 32>=c?e=b<<32-c>>32-c:(a=Math.pow(2,c-1),b>=a?(e=b%a,(b/a|0)&1&&(e-=a)):b<-a&&(e=b%a,((-b-1)/a|0)&1?e&&(e+=a):e||(e-=a)));b!=e&&(b=e);return b}
p.lb=function(a){function b(k){for(var h=0;h<k.length;h++)if(void 0!=k[h])return!1;return!0}if(-1>a)return be(this,this.lb);var c="";if(0<=a){var d=this.c[a];if(void 0!=d){c=d>>8;d&=255;var e=this.h[c];if(e){var f=this.i[c],g=f[d];(c&1?e.tb(g.I,this.g[c]):e.Za(g.I,this.g[c]))?(f[d]=void 0,this.c[a]=void 0,b(f)&&(f.length=0,b(this.c)&&(this.c.length=0)),c=this.l("%2d: %s %*a cleared\n",a,ce[c],e.Y,g),--this.U||this.V||(c+=de(this,!1))):c=this.l("invalid break address: %*a\n",e.Y,g)}else c="invalid bus"}else c=
this.l("invalid break index: %d\n",a)}else c="missing break index\n";return c};function ee(a,b){if(a.J&&(void 0==b||a.J.I==b)){var c=void 0===c?X.ja:c;b=-1;var d=fe(a.J,a.i[c]);if(0<=d)for(var e=0;e<a.c.length;e++){var f=a.c[e];if(void 0!=f&&c==f>>8&&d==(f&255)){b=e;break}}c=b;0<=c&&a.lb(c);a.J=null}}
p.mb=function(a,b){b=void 0===b?!1:b;if(-1>a)return be(this,this.mb,b);if(0<=a){var c=this.c[a];if(void 0!=c){var d=c>>8;c=this.i[d][c&255];if(void 0!=c){var e=b?"enabled":"disabled",f=this.h[d];!c.disabled==!b?(c.disabled=!b,a=this.l("%2d: %s %*a %s\n",a,ce[d],f.Y,c,e)):a=this.l("%2d: %s %*a already %s\n",a,ce[d],f.Y,c,e)}else a=this.l("no break address at index: %d\n",a)}else a=this.l("invalid break index: %d\n",a)}else a="missing break index\n";return a};
function be(a,b,c){for(var d="",e=0;e<a.c.length;e++)void 0!=a.c[e]&&(d+=b.call(a,e,c));d||(d="no break addresses found");return d}function ge(a,b,c){c=void 0===c?X.ja:c;a=a.i[c];for(c=0;c<a.length;c++){var d=a[c];if(d.I==b)return d}}function fe(a,b){for(var c=0;c<b.length;c++)if(b[c].I==a.I)return c;return-1}
function he(a,b){b=void 0===b?!1:b;for(var c="",d=0;d<a.c.length;d++){var e=a.c[d];if(void 0!=e){var f=e>>8;e=a.i[f][e&255];f=a.l("%s %*a",ce[f],a.h[f].Y,e);b?(c&&(c+=";"),c+=f,e.disabled&&(c+=";bd "+d)):c+=a.l("%2d: %s %s\n",d,f,e.disabled?"disabled":"enabled")}}c||b||(c="no break addresses found\n");return c}
function ie(a,b,c){c=void 0===c?X.ja:c;if(b){var d=a.h[c];if(d){var e=a.i[c];var f=fe(b,e);if(0<=f)f=-(f+1);else{for(f=0;f<e.length&&void 0!=e[f];f++);e[f]=b}e=f;if(0<=e)if(f=c&1?d.rb(b.I,a.g[c]):d.Ya(b.I,a.g[c])){for(f=0;f<a.c.length&&void 0!=a.c[f];f++);a.c[f]=c<<8|e;b=a.l("%2d: %s %*a set\n",f,ce[c],d.Y,b);a.U++||a.b.length||(b+=de(a,!0))}else b=a.l("invalid break address: %*a\n",d.Y,b),a.i[c][e]=void 0;else b=a.l("%s %*a already set\n",ce[c],d.Y,b)}else b="invalid bus"}else b="missing break address\n";
return b}function je(a,b){0<=b&&(a.o=b);var c="instruction break count: "+(0<a.o?a.o:"disabled")+"\n";0<b&&(a.b.length||(c+=de(a,!0)),a.V=!0);return c}function ke(a,b){var c;if(b){var d=Va(b);void 0!=d?a.$=d?0xffffffffffff:0:c=a.l("unrecognized message option: %s\n",b)}c||(c=a.l("break on message: %b\n",!!a.$));return c}p.Yc=function(a,b){this.j||(void 0==a?Z(this,"break on unknown input %#0x: %#0x",b):(a=ge(this,a+b,X.Da))&&!a.disabled&&Z(this,"break on input %*a: %#0x",this.f.Y))};
p.Zc=function(a,b){this.j||(void 0==a?Z(this,"break on unknown output %#0x: %#0x",b):(a=ge(this,a+b,X.Ea))&&!a.disabled&&Z(this,"break on output %*a: %#0x",this.f.Y))};p.$c=function(a,b){this.j||(void 0==a?Z(this,"break on unknown read %#0x: %#0x",b):(a+=b,this.b.length&&a==this.R.pb&&(this.M++,0<this.o&&(--this.o||Z(this,"break on instruction count")),this.b[this.H++]=a,this.H==this.b.length&&(this.H=0)),(b=ge(this,a,X.ja))&&!b.disabled&&(Z(this,"break on read %*a: %#0x",this.a.Y),ee(this,a))))};
p.ad=function(a,b){this.j||(void 0==a?Z(this,"break on unknown write %#0x: %#0x",b):(a=ge(this,a+b,X.Ia))&&!a.disabled&&Z(this,"break on write %*a: %#0x",this.a.Y))};function Z(a,b,c){b=a.l.apply(a,[b].concat(q(c)));E(a,b);lc(a.time)}function le(a,b,c){c=void 0===c?a.a:c;return B(a,b.I,a.Z,c.Y,"")}
function me(a,b,c){c=void 0===c?10:c;var d="";if(a.b.length){var e,f=[];c>a.b.length&&(c=a.b.length);0>b&&(b=c);var g=a.H-b;for(0>g&&(g+=a.b.length);0<=g&&g<a.b.length&&0<c;){var k=a.b[g++];if(void 0==k)break;g==a.b.length&&(g=0);e?e.I=k:e=Ld(k);for(k=0;1>k;k++)f[k]=Td(a,e,1);Qd(a,e,-f.length);d+=a.sb(e,f,a.l("[%6d]",b--));c--}}return d||"no history"}
function Lc(a,b,c){var d=[],e="";for(b="number"==typeof b?Ld(b):b;c--;){for(Qd(a,b,d.length);1>d.length;)d.push(Td(a,b,1));Qd(a,b,-d.length);e+=a.sb(b,d)}return e}
function ne(a,b,c,d,e,f){var g="";f=f?a.f:a.a;c||(c=f.f);var k=c>>3;d||(d=128);var h=0,m=d+15>>4||1,l=4==k?16:a.Z;"y"==e&&(l=k,m=d,h=8*k);b||(b=a.ea);for(;m--&&0<d;){var v=e=0,n,t="",w="",u=le(a,b,f);for(n=l;0<n&&0<d;n--){var y=Td(a,b,1,f);e|=y<<(v++<<3);v==k&&(t+=B(a,e,0,c,""),t+=1==k?9==n?"-":" ":" ",h&&(w+=B(a,e,2,c,"")),e=v=0);h||(w+=32<=y&&127>y?String.fromCharCode(y):".");d--}g&&(g+="\n");g+=u+"  "+t+" "+w}a.ea=b;return g}
p.kd=function(){var a=[];lb(this,function(b){b.Ma&&b.Ma(a);return!0});return JSON.stringify(a,null,2)};function oe(a,b,c,d){var e=0,f="";d=d?a.f:a.a;for(var g=0;void 0!=b&&g<c.length;g++){var k=Td(a,b,0,d);if(void 0==k)break;var h=a,m=b,l=c[g],v=d;v=void 0===v?h.a:v;h.j++;v.pa(m.I,l);h.j--;f+=a.l("%*a: %#*n changed to %#*n\n",a.a.Y,b,a.a.f,k,a.a.f,c[g]);Qd(a,b,1,d);e++}e||(f+=a.l("%d locations updated\n",e));a.time.update();return f}
function de(a,b){var c="";void 0!=b&&b==!a.b.length&&Fc(a.a,function(d){b?a.a.Ya(d.la,a.g[X.ja]):a.a.Za(d.la,a.g[X.ja])})&&(b?(a.H=0,a.b=Array(pe)):a.b=[]);return c+=a.l("instruction history %s\n",a.b.length?"enabled":"disabled")}p.ma=function(a){var b=a.shift();return this.X==b?(Ua(this,a.shift()),this.L.ca=a.shift(),!0):!1};p.ic=function(a){ua(this.$,a)?Z(this,"break on message"):this.time.J=!0};
p.md=function(a){var b=a[1],c=a[2],d=[],e=[],f=!1,g="";this.w=void 0;if("*"==c)var k=-2;else{k=ta(c);void 0==k&&(k=-1);var h=Nd(this,c,e);if(null===h)return}var m=0;a[3]&&(m=ta(a[3].substr("l"==a[3][0]?1:0))||8);for(var l=3;l<a.length;l++)d.push(ta(a[l],16));if("d"==b){l=Md(this,c,d);if(void 0!=l)return l;b=this.N||b}if("s"!=b[0]&&e.length)return"unrecognized symbol(s): "+e;switch(b[0]){case "b":"c"==b[1]?g=this.lb(k):"d"==b[1]?g=this.mb(k):"e"==b[1]?g=this.mb(k,!0):"i"==b[1]?g=ie(this,h,X.Da):"l"==
b[1]?g=he(this):"m"==b[1]?g=ke(this,c):"n"==b[1]?g=je(this,k):"o"==b[1]?g=ie(this,h,X.Ea):"r"==b[1]?g=ie(this,h,X.ja):"w"==b[1]?g=ie(this,h,X.Ia):"?"==b[1]?(g="break commands:\n",qe.forEach(function(v){g+=v+"\n"})):b[1]&&(g=void 0);break;case "d":this.N=b;if("b"!=b[1]&&b[1])if("w"==b[1])c=16;else if("d"==b[1])c=32;else if("i"==b[1]){if(!this.f){g="invalid bus";break}c=this.f.f;m=m||1;f=!0}else{if("h"==b[1])this.N="",g=me(this,k,m);else if("?"==b[1]){if(this.N="",g="dump commands:\n",re.forEach(function(v){g+=
v+"\n"}),this.m.length)for(g+="dump extensions:\n",b=0;b<this.m.length;b++)h=this.m[b],g+=this.l("d   %-12s%s\n",h.name,h.hd)}else g=void 0;break}else c=8;g=ne(this,h,c,m,b[2],f);break;case "e":if("o"==b[1]){if(!this.f){g="invalid bus";break}f=!0}else if(b[1]){g=void 0;break}g=oe(this,h,d,f);break;case "g":if(this.time.start()){if(void 0!=h){ee(this);g=ie(this,h);if(2!=g.indexOf(":"))break;this.J=h;g=""}break}g="already started\n";break;case "h":lc(this.time)||(g="already stopped\n");break;case "p":a.shift();
a.shift();b=a.join(" ");g+=this.l("%s = %s\n",b,B(this,Sd(this,b)));break;case "r":if(b=b.substr(1).toUpperCase()){if(void 0==nb(this.R,b)){g+=this.l("unrecognized register: %s\n",b);break}void 0!=h&&qb(this.R,b,h.I)}this.T.I=this.R.ra;g+=this.R.toString();break;case "s":h=Va(c);if("h"==b[1]){if(this.U||0<this.o)h=void 0;g=de(this,h);void 0!=h&&(this.V=h)}else"p"==b[1]?0<k?(ic(this.time,k),g="target speed:  "+oc(this.time.i)):g="current speed: "+wc(this.time):"s"==b[1]&&this.fa?(k=this.fa.indexOf(c),
0<=k&&(this.style=this.fa[k]),g="style: "+this.style):"?"==b[1]?(g="set commands:\n",se.forEach(function(v){g+=v+"\n"})):g=void 0;break;case "t":m=ta(c,10)||1;this.w=!0;if(b[1]){if("r"!=b[1]){g=void 0;break}this.w=!1}qc(this.time,m);break;case "u":if(b[1]){g=void 0;break}m||(m=8);h||(h=this.T);g+=Lc(this,h,m);this.T=h;break;case "?":g="debugger commands:\n";te.forEach(function(v){g+=v+"\n"});break;default:g=void 0}void 0==g&&a[0]&&(g="unrecognized command '"+a[0]+"' (try '?')\n");return g};
p.nb=function(a){return a&&this.ma(a[0])?(a.shift(),!0):!1};p.Ma=function(a){var b=[];this.oa(b);a.push(b)};p.nd=function(a){if(a)if(this.time.a){if(this.da){a=this.da;var b=a.c;b&&a.L.Ba&&(a.u(131072,'setFocus("%s")\n',b.id||b.nodeName),b.focus(),b.scrollIntoView())}}else this.w?this.wa(Lc(this,this.R.ra,1)):(this.M&&(E(this.R,this.M+" instructions executed"),this.M=0),this.R.wa(this.R.toString()),void 0==this.w&&(a=this.Aa(Ea.Pa,!0))&&a.focus())};
p.oa=function(a){a.push(this.X);a.push(he(this,!0));a.push(this.L.ca)};p.sb=function(a,b,c){var d=this;return this.l("%s %02x       unsupported       ; %s\n",le(this,a),function(){var e=b.shift();Qd(d,a,1);return e}(),c||"")};
var te="b?\t\tbreak commands;d?\t\tdump commands;e[o] [addr] ...\tedit memory/ports;g    [addr]\trun (to addr);h\t\thalt;p    [expr]\tparse expression;r?   [value]\tdisplay/set registers;s?\t\tset commands;t[r] [n]\tstep (n instructions);u    [addr] [n]\tunassemble (at addr)".split(";"),qe="bc [n|*]\tclear break address;bd [n|*]\tdisable break address;be [n|*]\tenable break address;bl [n]\t\tlist break addresses;bi [addr]\tbreak on input;bo [addr]\tbreak on output;br [addr]\tbreak on read;bw [addr]\tbreak on write;bm [on|off]\tbreak on message;bn [count]\tbreak on instruction count".split(";"),
re="db  [addr]\tdump bytes (8 bits);dw  [addr]\tdump words (16 bits);dd  [addr]\tdump dwords (32 bits);di  [addr]\tdump input ports;d*y [addr]\tdump values in binary;dh  [n] [l]\tdump instruction history buffer;ds\t\tdump machine state".split(";"),se=["sh [on|off]\tset instruction history","sp [n]\t\tset speed multiplier","ss\t\tset debugger style"],Rd={Vb:1,Gc:0,Hc:2,Je:0},X={ja:0,Ia:1,Da:2,Ea:3},ue={},ce=(ue[X.ja]="br",ue[X.Ia]="bw",ue[X.Da]="bi",ue[X.Ea]="bo",ue),Zc={Fc:"PC"},ve={BYTE:1,Ec:2,Ic:4,
Ac:5,oc:6,Uc:7},Od={"=":ve.Uc,1:ve.BYTE,2:ve.Ec,4:ve.Ic,"@":ve.Ac,";":ve.oc},pe=1E5,$d={"||":5,"&&":6,"!":7,"|":7,"^!":8,"&":9,"!=":10,"==":10,">=":11,">":11,"<=":11,"<":11,">>>":12,">>":12,"<<":12,"-":13,"+":13,"^/":14,"/":14,"*":14,_:19,"^_":19,"{":20,"}":20},Zd={",,":1,"||":5,"&&":6,"!=":10,"==":10,">=":11,">":11,"<=":11,"<":11,">>>":12,">>":12,"<<":12,"-":13,"+":13,"^/":14,"/":14,"*":14,"!":15,"|":15,"^!":15,"&":15,_:19,"^_":19,"{":20,"}":20};function we(a,b,c){Kd.call(this,a,b,c)}x(we,Kd);
we.prototype.sb=function(){return""};A.PDP11Dbg=we;
function xe(a,b,c){M.call(this,a,a);var d=this;this.b=this.Ba=!1;this.i=c;this.a="";this.h=this.g=!1;this.ca=0;b=b.trim();"{"==b[0]?ye(this,b):(this.a=b,Qa(this.a,function(e,f,g,k){4==g&&(!k&&f?(ye(d,f),ze(d)):d.u("error (%d) loading configuration: %s\n",k,e))}));window.addEventListener("load",function(){d.h=!0;ze(d)});window.addEventListener(Sa("iOS")?"pagehide":Sa("Opera")?"unload":"beforeunload",function(){Ae(d)});window.addEventListener("pageshow",function(){d.Ba&&!d.b&&d.na(!0)})}x(xe,M);
xe.prototype.Ja=function(a,b){var c=this;switch(a){case Be:b.onclick=function(){c.Ba&&c.na()};break;case Ce:b.onclick=function(){c.Ba&&c.xa()}}M.prototype.Ja.call(this,a,b)};
function ze(a){var b=!0;if(a.g&&a.h){for(var c in a.c){var d=void 0,e=a.c[c];try{d=e["class"],A[d]?"Machine"==d?(a.u("PCjs %s v%3.2f\n%s\n%s\n",e.name,2,De,Ee),a.a&&a.u("Configuration: %s\n",a.a)):new A[d](a.S,c,e):a.u("unrecognized %s device class: %s\n",c,d)}catch(g){e.optional||(a.u("error initializing %s device '%s': %s\n",d,c,g.message),b=!1),pb(a,c)}}if(a.f){var f=Ta(a);lb(a,function(g){return g.nb&&!g.nb(f)?(g.u("unable to restore state for device: %s\n",g.X),!1):!0})}a.na(b)}}
function ye(a,b){try{a.c=JSON.parse(b);jb(a,a.c[a.S],["autoSave","autoStart"]);a.f=!1!==a.O.autoSave;a.j=!1!==a.O.autoStart;if(a.i){var c=eval("("+a.i+")"),d;for(d in c)a.O[d]=c[d]}a.g=!0}catch(e){c=e.message,(d=c.match(/position ([0-9]+)/))&&(c+=" ('"+b.substr(+d[1],40).replace(/\s+/g," ")+"...')"),E(a,"machine '"+a.S+"' initialization error: "+c)}}
xe.prototype.na=function(a){a=void 0===a?!this.b:a;var b=this;a&&E(this,"power on");lb(this,function(c){c.na&&c!=b&&("CPU"!=c.O["class"]||b.j||b.Ba?c.na(a):c.time.update(!0));return!0});this.Ba=!0;(this.b=a)||E(this,"power off")};xe.prototype.xa=function(){var a=this;lb(this,function(b){b.xa&&b!=a&&b.xa();return!0})};function Ae(a){if(a.f){var b=[];lb(a,function(c){c.Ma&&c.Ma(b);return!0});$a(a,b)}a.na(!1)}var Be="power",Ce="reset",De="Copyright \u00a9 2012-2019 Jeff Parsons <Jeff@pcjs.org>",Ee="License: GPL version 3 or later <http://gnu.org/licenses/gpl.html>";
window.PDP11M=function(a,b,c){var d=new xe(a,b,c);window.command=function(e){return Ua(d,e)};return d};A.Machine=xe;})()

//# sourceMappingURL=pdp11v2.js.map
