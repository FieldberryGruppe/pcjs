(function(){/*
 https://www.pcjs.org/modules/shared/lib/dumpapi.js (C) Jeff Parsons 2012-2018
 https://www.pcjs.org/modules/shared/lib/reportapi.js (C) Jeff Parsons 2012-2018
 https://www.pcjs.org/modules/shared/lib/userapi.js (C) Jeff Parsons 2012-2018
 https://www.pcjs.org/modules/shared/lib/keys.js (C) Jeff Parsons 2012-2018
 https://www.pcjs.org/modules/shared/lib/strlib.js (C) Jeff Parsons 2012-2018
 https://www.pcjs.org/modules/shared/lib/weblib.js (C) Jeff Parsons 2012-2018
 https://www.pcjs.org/modules/pc8080/lib/cpudef.js (C) Jeff Parsons 2012-2018
 https://www.pcjs.org/modules/pc8080/lib/messages.js (C) Jeff Parsons 2012-2018
 https://www.pcjs.org/modules/shared/lib/state.js (C) Jeff Parsons 2012-2018
 https://www.pcjs.org/modules/shared/lib/embed.js (C) Jeff Parsons 2012-2018
 https://www.pcjs.org/modules/shared/lib/defines.js (C) Jeff Parsons 2012-2018
 https://www.pcjs.org/modules/shared/lib/usrlib.js (C) Jeff Parsons 2012-2018
 https://www.pcjs.org/modules/shared/lib/component.js (C) Jeff Parsons 2012-2018
 https://www.pcjs.org/modules/pc8080/lib/defines.js (C) Jeff Parsons 2012-2018
 https://www.pcjs.org/modules/pc8080/lib/panel.js (C) Jeff Parsons 2012-2018
 https://www.pcjs.org/modules/pc8080/lib/bus.js (C) Jeff Parsons 2012-2018
 https://www.pcjs.org/modules/pc8080/lib/memory.js (C) Jeff Parsons 2012-2018
 https://www.pcjs.org/modules/pc8080/lib/cpu.js (C) Jeff Parsons 2012-2018
 https://www.pcjs.org/modules/pc8080/lib/cpustate.js (C) Jeff Parsons 2012-2018
 https://www.pcjs.org/modules/pc8080/lib/cpuops.js (C) Jeff Parsons 2012-2018
 https://www.pcjs.org/modules/pc8080/lib/chipset.js (C) Jeff Parsons 2012-2018
 https://www.pcjs.org/modules/pc8080/lib/rom.js (C) Jeff Parsons 2012-2018
 https://www.pcjs.org/modules/pc8080/lib/ram.js (C) Jeff Parsons 2012-2018
 https://www.pcjs.org/modules/pc8080/lib/keyboard.js (C) Jeff Parsons 2012-2018
 https://www.pcjs.org/modules/pc8080/lib/video.js (C) Jeff Parsons 2012-2018
 https://www.pcjs.org/modules/pc8080/lib/serial.js (C) Jeff Parsons 2012-2018
 https://www.pcjs.org/modules/shared/lib/debugger.js (C) Jeff Parsons 2012-2018
 https://www.pcjs.org/modules/pc8080/lib/debugger.js (C) Jeff Parsons 2012-2018
 https://www.pcjs.org/modules/pc8080/lib/computer.js (C) Jeff Parsons 2012-2018
*/
var l,aa="function"==typeof Object.create?Object.create:function(a){function b(){}b.prototype=a;return new b},ca;if("function"==typeof Object.setPrototypeOf)ca=Object.setPrototypeOf;else{var da;a:{var ea={vb:!0},fa={};try{fa.__proto__=ea;da=fa.vb;break a}catch(a){}da=!1}ca=da?function(a,b){a.__proto__=b;if(a.__proto__!==b)throw new TypeError(a+" is not extensible");return a}:null}var ha=ca;
function ia(a,b){a.prototype=aa(b.prototype);a.prototype.constructor=a;if(ha)ha(a,b);else for(var c in b)if("prototype"!=c)if(Object.defineProperties){var d=Object.getOwnPropertyDescriptor(b,c);d&&Object.defineProperty(a,c,d)}else a[c]=b[c];a.Qf=b.prototype}
var ja="function"==typeof Object.defineProperties?Object.defineProperty:function(a,b,c){a!=Array.prototype&&a!=Object.prototype&&(a[b]=c.value)},ka="undefined"!=typeof window&&window===this?this:"undefined"!=typeof global&&null!=global?global:this;function la(a){if(a){for(var b=ka,c=["Math","trunc"],d=0;d<c.length-1;d++){var e=c[d];e in b||(b[e]={});b=b[e]}c=c[c.length-1];d=b[c];a=a(d);a!=d&&null!=a&&ja(b,c,{configurable:!0,writable:!0,value:a})}}
la(function(a){return a?a:function(a){a=Number(a);if(isNaN(a)||Infinity===a||-Infinity===a||0===a)return a;var b=Math.floor(Math.abs(a));return 0>a?-b:b}});
var m={Be:0,Ee:1,Fe:2,Ge:3,He:4,Ie:5,Je:6,Ke:7,Le:8,Me:9,Ne:10,Oe:11,Pe:12,Qe:13,Re:14,Se:15,Te:16,Ue:17,Ve:18,We:19,Xe:20,Ye:21,Ze:22,$e:23,af:24,bf:25,cf:26,jf:27," ":32,"!":33,'"':34,"#":35,$:36,"%":37,"\x26":38,"'":39,"(":40,")":41,"*":42,"+":43,",":44,"-":45,".":46,"/":47,0:48,1:49,2:50,3:51,4:52,5:53,6:54,7:55,8:56,9:57,":":58,";":59,"\x3c":60,"\x3d":61,"\x3e":62,"?":63,"@":64,Ya:65,Tb:66,Ub:67,Cb:68,E:69,Xb:70,Yb:71,Zb:72,$b:73,ac:74,bc:75,Eb:76,fc:77,gc:78,kc:79,lc:80,Q:81,mc:82,oc:83,pc:84,
qc:85,sc:86,tc:87,vc:88,wc:89,tb:90,"[":91,"\\":92,"]":93,"^":94,_:95,"`":96,vb:97,sd:98,ud:99,d:100,e:101,yd:102,Ad:103,Cd:104,Ed:105,Nd:106,k:107,Od:108,Qd:109,n:110,Rd:111,p:112,q:113,r:114,ne:115,t:116,pe:117,qe:118,re:119,x:120,y:121,z:122,"{":123,"|":124,"}":125,"~":126,df:127},ma={59:186,61:187,173:189,224:91};
function na(a,b){if(a){b||(b=10);var c,d=0<a.indexOf(",");d&&(a=a.replace(/,/g,""));var e=c=a.charAt(0);"#"==c?(b=8,c=""):"$"==c&&(b=16,c="");e!=c?a=a.substr(1):(e=c=a.substr(0,2),"0b"==c&&d||"^B"==c?(b=2,c=""):"0o"==c||"^O"==c?(b=8,c=""):"^D"==c?(b=10,c=""):"0x"==c&&(b=16,c=""),e!=c&&(a=a.substr(2)));e=c=a.slice(-1);"Y"==c||"y"==c?(b=2,c=""):"."==c?(b=10,c=""):"H"==c||"h"==c?(b=16,c=""):"K"==c?c="000":"M"==c?c="000000":"G"==c&&(c="000000000");e!=c&&(a=a.slice(0,-1)+c);var f;e=0;10>=b&&(c=a.match(/(-?[0-9]+)B([0-9]*)/))&&
(a=c[1],e=35-((c[2]||35)&255));c=a;if(((d=b)&&10!=d?16==d?null!==c.match(/^-?[0-9a-f]+$/i):8==d?null!==c.match(/^-?[0-7]+$/):2==d&&null!==c.match(/^-?[01]+$/):null!==c.match(/^-?[0-9]+$/))&&!isNaN(f=parseInt(a,b))){e&&(0>f&&(f+=Math.pow(2,36)),f=0<e?f*Math.pow(2,e):Math.trunc(f/Math.pow(2,-e)));var g=f}}return g}
function oa(a,b,c,d,e){e=void 0===e?0:e;var f="";isNaN(a)||"number"!=typeof a?a=null:(0>a&&-1<a&&(a=-1),0>a&&(a+=Math.pow(b,c)),a>=Math.pow(b,c)&&(c=Math.ceil(Math.log(a)/Math.log(b))));for(var g=e||-1;0<c--;){g||(f=","+f,g=e);if(null==a)f="?"+f;else{var h=a%b;h+=0<=h&&9>=h?48:55;f=String.fromCharCode(h)+f;a=Math.trunc(a/b)}g--}return(void 0===d?"":d)+f}function p(a,b,c){b?9<b&&(b=9):(b=Math.abs(a),b=65535>=b?4:4294967295>=b?8:9);return oa(a,16,b,c?"0x":"")}function qa(a){return p(a,2,!0)}
function q(a){return p(a,4,!0)}function ra(a){var b=a,c=a.lastIndexOf("/");0<=c&&(b=a.substr(c+1));c=b.indexOf("\x26");0<c&&(b=b.substr(0,c));return b}function sa(a){var b="",c=a.lastIndexOf(".");0<=c&&(b=a.substr(c+1).toLowerCase());return b}function ta(){var a=window?window.location.hostname:"localhost";return-1!==a.indexOf("pcjs.org",a.length-8)}function va(a){return a.replace(/[&<>"'$]/g,function(a){return wa[a]})}
function xa(a,b){return(a+"                                        ").slice(0,b)}function ya(a){return String.prototype.trim?a.trim():a.replace(/^\s+|\s+$/g,"")}
var wa={"\x26":"\x26amp;","\x3c":"\x26lt;","\x3e":"\x26gt;",'"':"\x26quot;","'":"\x26apos;",$:"\x26dollar;"},Aa={0:"NUL",1:"SOH",2:"STX",3:"ETX",4:"EOT",5:"ENQ",6:"ACK",7:"BEL",8:"BS",9:"TAB",10:"LF",11:"VT",12:"FF",13:"CR",14:"SO",15:"SI",16:"DLE",17:"XON",18:"DC2",19:"XOFF",20:"DC4",21:"NAK",22:"SYN",23:"ETB",24:"CAN",25:"EM",26:"SUB",27:"ESC",28:"FS",29:"GS",30:"RS",31:"US",127:"DEL"};
function Ca(a,b,c){var d=0,e=a.length,f=0;for(void 0===c&&(c=function(a,b){return a>b?1:a<b?-1:0});d<e;){var g=d+e>>1,h=void 0;h=c(b,a[g]);0<h?d=g+1:(e=g,f=!h)}return f?d:~d}
function Da(){var a,b="";a||(a=new Date);for(var c=a.getHours(),d=a.getDate(),e=a.getMonth()+1,f=0;11>f;f++){var g;switch(g="Y-m-d H:i:s".charAt(f)){case "a":b+=12>c?"am":"pm";break;case "d":b+=("0"+d).slice(-2);break;case "D":b+=Ea[a.getDay()].substr(0,3);break;case "F":b+=Fa[e-1];break;case "g":b+=c?12<c?c-12:c:12;break;case "h":b+=c;break;case "H":b+=("0"+c).slice(-2);break;case "i":b+=("0"+a.getMinutes()).slice(-2);break;case "j":b+=d;break;case "l":b+=Ea[a.getDay()];break;case "m":b+=("0"+e).slice(-2);
break;case "M":b+=Fa[e-1].substr(0,3);break;case "n":b+=e;break;case "s":b+=("0"+a.getSeconds()).slice(-2);break;case "y":b+=(""+a.getFullYear()).slice(-2);break;case "Y":b+=a.getFullYear();break;default:b+=g}}return b}function Ga(a,b){if(Array.prototype.indexOf)return a.indexOf(b,c);var c=c||0;0>c&&(c+=a.length);0>c&&(c=0);for(var d=a.length;c<d;c++)if(c in a&&a[c]===b)return c;return-1}var Ea="Sunday Monday Tuesday Wednesday Thursday Friday Saturday".split(" "),Fa="January February March April May June July August September October November December".split(" ");
function Ha(a,b,c,d){function e(){if(4!==k.readyState)return null;try{g=n?k.response:k.responseText}catch(u){}if(null==g||200!=k.status&&(k.status||!g.length||"file:"!=(window?window.location.protocol:"file:")))if(f=k.status||-1,!k.status&&!Ia){var b=a.match(/(^https?:\/\/[^\/]+)(.*)/);b&&(Ia=!0,r("PCjs was unable to perform a cross-origin resource request to '"+b[1]+"'.\n\nIf you're running an ad blocker, try adding '"+Ja()+"' to your whitelist (or get a smarter ad blocker, because there are NO ads on this website)."))}d&&
d(a,g,f);return[g,f]}b=void 0===b?"text":b;c=void 0===c?!1:c;var f=0,g=null,h=null;if("object"==typeof resources&&(g=resources[a]))return d&&d(a,g,f),[g,f];if(c&&"function"==typeof resources)return resources(a,function(b,c){d&&d(a,b,c)}),h;"pcjs:8088"==(window?window.location.host:"localhost")?(a=a.replace(/^(http:\/\/archive\.pcjs\.org|https:\/\/[a-z0-9-]+\.amazonaws\.com\/archive\.pcjs\.org)(\/.*)\/([^/]*)$/,"$2/archive/$3"),a=a.replace(/^https:\/\/jeffpar\.github\.io\/(pcjs-[a-z]+|private-[a-z]+)\/(.*)$/,
"/$1/$2")):a=a.replace(/^\/(pcjs-[a-z]+|private-[a-z]+)\//,"https://jeffpar.github.io/$1/");var k=window.XMLHttpRequest?new window.XMLHttpRequest:new window.ActiveXObject("Microsoft.XMLHTTP"),n=!1,t="string"===typeof k.responseType;c&&(k.onreadystatechange=e);if(b&&"object"==typeof b){t="";for(var x in b)b.hasOwnProperty(x)&&(t&&(t+="\x26"),t+=x+"\x3d"+encodeURIComponent(b[x]));t=t.replace(/%20/g,"+");k.open("POST",a,c);k.setRequestHeader("Content-type","application/x-www-form-urlencoded");k.send(t)}else k.open("GET",
a,c),"arraybuffer"==b&&(t?(n=!0,k.responseType=b):k.overrideMimeType("text/plain; charset\x3dx-user-defined")),k.send();c||(k.readyState=4,h=e());return h}
function Ka(a,b){var c,d={ka:null,pa:null,Na:null,Fa:null};if("["==b.charAt(0)||"{"==b.charAt(0))try{var e,f;if("\x3c"==b.charAt(0))throw Error(b);var g=0>b.indexOf("0x")&&0>b.indexOf("0o")&&'["'!=b.substr(0,2)?JSON.parse(b.replace(/([a-z]+):/gm,'"$1":').replace(/\/\/[^\n]*/gm,"")):eval("("+b+")");d.Na=g.load;d.Fa=g.exec;if(e=g.bytes)d.ka=e;else if(e=g.words)for(d.ka=Array(2*e.length),f=c=0;c<e.length;c++)d.ka[f++]=e[c]&255,d.ka[f++]=e[c]>>8&255;else if(e=g.longs)for(d.ka=Array(4*e.length),f=c=0;c<
e.length;c++)d.ka[f++]=e[c]&255,d.ka[f++]=e[c]>>8&255,d.ka[f++]=e[c]>>16&255,d.ka[f++]=e[c]>>24&255;else(e=g.data)?d.Nf=e:d.ka=g;d.ka&&(d.ka.length?1==d.ka.length&&(r(d.ka[0]),d=null):(r("Empty resource: "+a),d=null));d.pa=g.symbols}catch(h){r("Resource data error ("+a+"): "+h.message),d=null}else{e=[];b=b.replace(/\n/gm," ").replace(/ +$/,"").split(" ");for(c=0;c<b.length;c++){f=parseInt(b[c],16);if(isNaN(f)){r("Resource data error ("+a+"): invalid hex byte ("+b[c]+")");break}e.push(f&255)}c==b.length&&
(d.ka=e)}return d}function Ja(){return window?window.location.protocol+"//"+window.location.host:"https://www.pcjs.org"}function La(){return window?window.navigator.userAgent:""}function Ma(){if(null==Qa){var a=!1;if(window)try{window.localStorage.setItem("PCjs.localStorage","PCjs.localStorage"),a="PCjs.localStorage"==window.localStorage.getItem("PCjs.localStorage"),window.localStorage.removeItem("PCjs.localStorage")}catch(b){a=!1}Qa=a}return Qa}
function Ra(a){if(window)try{var b=window.localStorage.getItem(a)}catch(c){}return b}function Sa(a,b){try{return window.localStorage.setItem(a,b),!0}catch(c){}return!1}function Ta(a){if(window){var b=La();return"iOS"==a&&!!b.match(/(iPod|iPhone|iPad)/)&&!!b.match(/AppleWebKit/)||"MSIE"==a&&!!b.match(/(MSIE|Trident)/)||0<=b.indexOf(a)}return!1}
function Ua(a,b,c){if(a)for(var d=0;d<Va.length;d++){var e=Va[d];if(c){if(e+=c,b+e in a)return e}else if(e=e?e+b[0].toUpperCase():b[0],e+=b.substr(1),e in a)return e}return null}function Wa(a){if(!Xa){var b,c={};if(window){b||(b=window.location.search.substr(1));for(var d,e=/\+/g,f=/([^&=]+)=?([^&]*)/g;d=f.exec(b);)c[decodeURIComponent(d[1].replace(e," "))]=decodeURIComponent(d[2].replace(e," "))}Xa=c}return Xa[a]||Xa[a.toLowerCase()]}
function Ya(a,b,c){function d(){--a;0<=a&&(b()||(a=0));0<a?setTimeout(d,0):c()}d()}function Za(a,b){function c(){b(100===d)&&(e=setTimeout(c,d),d=100)}var d=0,e=null,f=!1;a.onmousedown=function(){f||e||(d=500,c())};a.ontouchstart=function(){e||(d=500,c())};a.onmouseup=a.onmouseout=function(){e&&(clearTimeout(e),e=null)};a.ontouchend=a.ontouchcancel=function(){e&&(clearTimeout(e),e=null);f=!0}}function $a(a,b){if(window){var c=window[a];window[a]="function"!==typeof c?b:function(){c&&c();b()}}}
function ab(a){bb.init.push(a)}function fb(a){gb(a+"\n\nIf it happens again, please send the URL to support@pcjs.org. Thanks.",void 0,void 0)}function hb(a){if(ib)try{for(var b=0;b<a.length;b++)a[b]()}catch(c){fb("An unexpected error occurred: "+c.message)}}function jb(a){!ib&&a?(ib=!0,kb&&lb("init"),mb&&lb("show")):ib=a}function lb(a){bb[a]&&hb(bb[a])}var Xa=null,bb={init:[],show:[],exit:[]},Va=["","moz","ms","webkit"],kb=!1,mb=!1,ib=!0,Ia=!1,Qa=null;$a("onload",function(){kb=!0;hb(bb.init)});
$a("onpageshow",function(){mb=!0;hb(bb.show)});$a(Ta("iOS")?"onpagehide":Ta("Opera")?"onunload":"onbeforeunload",function(){hb(bb.exit)});
function v(a,b,c){this.type=a;b||(b={id:"",name:""});this.id=b.id||"";this.name=b.name;this.uc=b.comment;this.Bd=b;this.exports={};this.O=this.bindings={};a=this.id.indexOf(".");0>a?(this.Pa="PCjs",this.Fb=this.id):(this.Pa=this.id.substr(0,a),this.Fb=this.id.substr(a+1));this.flags={ready:!1,hb:!1,Gb:!1,Of:!1,ha:!1,Pb:!1,error:!1};this.xb=null;this.flags.error=!1;this.fa=c||0;this.J=this.w=this.H=this.P=null;nb.push(this)}function pb(a,b,c){qb[a]&&b&&(qb[a][b]=c)}
function sb(){return Date.now()||+new Date}function gb(a,b,c){b||r((c?c+": ":"")+a)}function r(a){window&&window.alert(a)}function tb(a){var b=!1;window&&(b=window.confirm(a));return b}function ub(a,b){a.value+=b;b=a.value;8192<b.length&&(a.value=b.substr(b.length-4096));a.scrollTop=a.scrollHeight}
function vb(a,b){b=wb(b.parentNode,"pc8080-control");for(var c=0;c<b.length;c++)for(var d=b[c].childNodes,e=0;e<d.length;e++){var f=d[e];if(1===f.nodeType){var g=f.getAttribute("class");if(g)for(var h=g.split(" "),k=0;k<h.length;k++)switch(g=h[k],g){case "pc8080-binding":(g=xb(f))&&void 0!==g.binding&&a.ca(g.type,g.binding,f,g.value),k=h.length}}}}function yb(a){var b,c=[];a&&(a=0<(b=a.indexOf("."))?a.substr(0,b+1):"");for(b=0;b<nb.length;b++){var d=nb[b];a&&d.id.indexOf(a)||c.push(d)}return c}
function zb(a){if(void 0!==a){var b;for(b=0;b<nb.length;b++)if(nb[b].id===a)return nb[b]}return null}function Ab(a,b){var c;if(void 0!==a){var d;b&&(b=0<(d=b.indexOf("."))?b.substr(0,d+1):"");for(d=0;d<nb.length;d++)if(c)c==nb[d]&&(c=null);else if(!(a!=nb[d].type||b&&nb[d].id.indexOf(b)))return nb[d]}return null}function xb(a){var b=null;if(a=a.getAttribute("data-value"))try{b=eval("("+a+")")}catch(c){r(c.message+" ("+a+")")}return b}
function wb(a,b,c){c&&(b+="-"+c+"-object");if(a.getElementsByClassName)return a.getElementsByClassName(b);var d;c=[];a=a.getElementsByTagName("*");var e=new RegExp("(^| )"+b+"( |$)");b=0;for(d=a.length;b<d;b++)e.test(a[b].className)&&c.push(a[b]);return c}
function Cb(a){for(var b=!0,c=Db[a];c&&c.length;){var d=c.splice(0,1)[0],e=d[0],f=null;0<=Eb.indexOf(e)&&(f=function(){return function(){Cb(a)}}());var g=Fb[e];if(g)if(!f)b=g(d[1],d[2],d[3]);else{if(!g(f,d[1],d[2],d[3]))break}else{b=!1;var h=Ab(d[1],a);if(h)if(g=Gb[e])b=g(h,d[2],d[3]);else{var k=h.exports;if(k&&(g=k[e]))if(b=!0,!f)b=g.call(h,d[2],d[3]);else if(!g.call(h,f,d[2],d[3]))break}}if(!b){r("Script error: '"+e+"' command "+(g?" failed":" not recognized"));break}}c&&!c.length&&delete Db[a];
return b}l=v.prototype;l.toString=function(){return this.name?this.name:this.id||this.type};
l.ca=function(a,b,c){switch(b){case "clear":return this.O[b]||(this.O[b]=c,c.onclick=function(a){return function(){a.O.print&&(a.O.print.value="")}}(this)),!0;case "print":return this.O[b]||(this.O[b]=c,this.Z=function(a){this.i(a,this.type);return!0},c.value="",this.print=function(a){return function(b){ub(a,b)}}(c),this.i=function(a,b){return function(a,c){a||(a="");if(c!=Hb||"..."!=a.slice(-3))c&&(a=c+": "+a),ub(b,a+"\n");else{c=b.value;var d=c.lastIndexOf(a);0>d?c+=a+"\n":c=c.substr(0,d)+(a+".")+
c.substr(d+a.length);8192<c.length&&(c=c.substr(c.length-4096));b.value=c;b.scrollTop=b.scrollHeight}}}(this,c)),!0;default:return!1}};l.log=function(){};l.print=function(){};l.i=function(){};l.status=function(a){this.i(this.type+": "+a)};l.Z=function(a,b,c){if(!b){var d=Ab("Computer",this.id);if(d&&d.flags.Pb)return console.log("ignoring notice during unload: "+a),!1}gb(a,b,c||this.type);return!0};function Ib(a,b){a.flags.error=!0;a.Z(b)}
function Jb(a,b){b&&(a.flags.ready?b():a.xb=b);return a.flags.ready}function Kb(a){if(!a.flags.error&&(a.flags.ready=!0,a.flags.ready)){var b=a.xb;a.xb=null;b&&b()}}function Lb(a,b){a.flags.hb&&(b?a.flags.Gb=!0:void 0===b&&a.i(a.toString()+" busy"));return a.flags.hb}function Mb(a,b){if(a.flags.Gb)return a.flags.hb=!1,a.flags.Gb=!1;if(a.flags.error)return a.i(a.toString()+" error"),!1;a.flags.hb=b;return a.flags.hb}l.ta=function(){return this.flags.ha=!0};
l.sa=function(a,b){b&&(this.flags.ha=!1);return!0};function Nb(a,b){b=void 0===b?0:b;return a.J&&(a!==a.J&&(b=b||a.fa),a=a.J.fa&b,b&4026531840&&b&268435455&&(a&4026531840&&a&268435455||(a=0)),b&&a===b)?!0:!1}function Ob(a,b){a.J&&Nb(a,0)&&a.J.message(b,void 0)}function z(a,b,c,d,e,f,g){a.J&&(!0===g?g=0:void 0==g&&(g=a.fa),Pb(a.J,a,b,c,d,e,f,g))}var Hb="progress";
window&&(window.PCjs||(window.PCjs={}),window.PCjs.Machines||(window.PCjs.Machines={}),window.PCjs.Components||(window.PCjs.Components=[]),window.PCjs.Commands||(window.PCjs.Commands={}));
var qb=window?window.PCjs.Machines:{},nb=window?window.PCjs.Components:[],Db=window?window.PCjs.Commands:{},Eb=["hold","sleep","wait"],Fb={alert:function(a){r(a);return!0},sleep:function(a,b){setTimeout(a,+b);return!1}},Gb={select:function(a,b,c){var d=!1;if(a=a.bindings[b])for(b=0;b<a.options.length;b++)if(a.options[b].textContent==c){a.selectedIndex!=b&&(a.selectedIndex=b);d=!0;break}return d}};
Array.prototype.indexOf||(Array.prototype.indexOf=function(a,b){b=b||0;for(var c=this.length;b<c;b++)if(this[b]===a)return b;return-1});Array.isArray||(Array.isArray=function(a){return"[object Array]"===Object.prototype.toString.call(a)});
Function.prototype.bind||(Function.prototype.bind=function(a){function b(){return e.apply(this instanceof c&&a?this:a,d.concat(Array.prototype.slice.call(arguments)))}function c(){}if("function"!=typeof this)throw new TypeError("Function.prototype.bind: non-callable object");var d=Array.prototype.slice.call(arguments,1),e=this;c.prototype=this.prototype;b.prototype=new c;return b});
var Qb="undefined"!==typeof ArrayBuffer,Rb=[1,0,0,1,0,1,1,0,0,1,1,0,1,0,0,1,0,1,1,0,1,0,0,1,1,0,0,1,0,1,1,0,0,1,1,0,1,0,0,1,1,0,0,1,0,1,1,0,1,0,0,1,0,1,1,0,0,1,1,0,1,0,0,1,0,1,1,0,1,0,0,1,1,0,0,1,0,1,1,0,1,0,0,1,0,1,1,0,0,1,1,0,1,0,0,1,1,0,0,1,0,1,1,0,0,1,1,0,1,0,0,1,0,1,1,0,1,0,0,1,1,0,0,1,0,1,1,0,0,1,1,0,1,0,0,1,1,0,0,1,0,1,1,0,1,0,0,1,0,1,1,0,0,1,1,0,1,0,0,1,1,0,0,1,0,1,1,0,0,1,1,0,1,0,0,1,0,1,1,0,1,0,0,1,1,0,0,1,0,1,1,0,1,0,0,1,0,1,1,0,0,1,1,0,1,0,0,1,0,1,1,0,1,0,0,1,1,0,0,1,0,1,1,0,0,1,1,0,1,
0,0,1,1,0,0,1,0,1,1,0,1,0,0,1,0,1,1,0,0,1,1,0,1,0,0,1],Sb={cpu:1,bus:64,mem:128,port:256,nvr:16384,chipset:32768,keyboard:65536,key:131072,video:262144,fdc:524288,disk:2097152,serial:8388608,speaker:33554432,computer:67108864,buffer:536870912,warn:1073741824,halt:-2147483648};function Tb(a){v.call(this,"Panel",a)}ia(Tb,v);
Tb.prototype.ca=function(a,b,c,d){return this.P&&this.P.ca(a,b,c,d)||this.w&&this.w.ca(a,b,c,d)||this.B&&this.B.ca(a,b,c,d)||this.J&&this.J.ca(a,b,c,d)?!0:v.prototype.ca.call(this,a,b,c,d)};Tb.prototype.Da=function(a,b,c,d){this.P=a;this.H=b;this.w=c;this.J=d;this.B=Wb(a,"Keyboard")};Tb.prototype.ta=function(a,b){b||Xb();return!0};Tb.prototype.sa=function(){return!0};
function Xb(){for(var a=!1,b=wb(document,"pc8080","panel"),c=0;c<b.length;c++){var d=b[c],e=xb(d),f=zb(e.id);f||(a=!0,f=new Tb(e));vb(f,d);a&&Kb(f)}}ab(Xb);
function Yb(a,b,c){v.call(this,"Bus",a);this.w=b;this.J=c;this.L=a.busWidth||16;this.M=Math.pow(2,this.L);this.C=this.M-1|0;this.g=(this.L>>1)+2;10>this.g&&(this.g=10);15<this.g&&(this.g=15);this.u=1<<this.g;this.N=this.u>>2;this.j=this.u-1;this.I=this.M/this.u|0;this.G=this.I-1;this.A=[];this.B=[];this.D=this.F=!1;this.R=[];this.S=[];a=new A;Zb(a,this.J);this.b=Array(this.I);for(b=0;b<this.I;b++)this.b[b]=a;Kb(this)}ia(Yb,v);Yb.prototype.reset=function(){};
Yb.prototype.ta=function(a,b){b||this.reset();return!0};function $b(a,b,c,d){for(var e=b,f=c,g=e>>>a.g;0<f&&g<a.b.length;){var h=a.b[g],k=g*a.u,n=a.u-(e-k);n>f&&(n=f);if(h&&h.size){if(h.type==d){if(e+f<=h.K)return h.lb+=h.K-e,h.K=e,!0;if(e>=h.K+h.lb){n=h.size-(e-k);n>f&&(n=f);h.lb=e-h.K+n;e=k+a.u;f-=n;g++;continue}}return ac(bc,e,f)}e=new A(e,n,a.u,d);Zb(e,a.J,h);a.b[g++]=e;e=k+a.u;f-=n}return 0>=f?(a.status(Math.floor(c/1024)+"Kb "+cc[d]+" at "+q(b)),!0):ac(dc,b,c)}
function ec(a,b){return a.b[(b&a.C)>>>a.g].kb(b&a.j,b)}function fc(a,b){var c=b&a.j,d=(b&a.C)>>>a.g;return c!=a.j?a.b[d].Gc(c,b):a.b[d++].Va(c,b)|a.b[d&a.G].Va(0,b+1)<<8}function gc(a,b){var c=b&a.j,d=(b&a.C)>>>a.g;return c!=a.j?a.b[d].Lb(c,b):a.b[d++].kb(c,b)|a.b[d&a.G].kb(0,b+1)<<8}function hc(a,b,c){a.b[(b&a.C)>>>a.g].mb(b&a.j,c&255,b)}function ic(a,b,c){var d=b&a.j,e=(b&a.C)>>>a.g;d!=a.j?a.b[e].Jc(d,c&65535,b):(a.b[e++].Xa(d,c&255,b),a.b[e&a.G].Xa(0,c>>8&255,b+1))}
function jc(a){for(var b=0,c=[],d=0;d<a.I;d++){var e=a.b[d];if(e.Ca||e.Cc){c[b++]=d;var f=b++;if(e=e.save()){for(var g=0,h=0,k=[];g<e.length;){for(var n=e[g],t=g+1;t<e.length&&e[t]===n;)t++;k[h++]=t-g;k[h++]=n;g=t}k.length<e.length&&(e=k)}c[f]=e}}return c}function kc(a,b){if(void 0===b)return a.D=!a.D,a.D;void 0===a.A[b]&&(a.A[b]=[null,!1]);a.A[b][1]=!a.A[b][1];return a.A[b][1]}
function lc(a,b,c,d){void 0===d&&(d=0);if(c)for(var e in c){var f=a,g=+e+d,h=c[e].bind(b);if(void 0!==h)for(var k=+e+d;k<=g;k++)void 0!==f.A[k]?r("Input port "+q(k)+" already registered"):f.A[k]=[h,!1]}}function mc(a,b,c){for(var d=1,e=0,f=0;0<d;){var g=a.A[b],h=a.R[b]||1,k=1==h?255:2==h?65535:-1,n=k;void 0!==g?(g[0]&&(n=g[0](b,c),void 0===n?n=k:n&=k),a.J&&a.D!=g[1]&&nc(a.J,b,n)):a.J&&(Pb(a.J,a,b,null,c),a.D&&nc(a.J,b,n));e|=n<<f;f+=h<<3;b+=h;d-=h}return e}
function oc(a,b){if(void 0===b)return a.F=!a.F,a.F;void 0===a.B[b]&&(a.B[b]=[null,!1]);a.B[b][1]=!a.B[b][1];return a.B[b][1]}function yc(a,b,c,d){void 0===d&&(d=0);if(c)for(var e in c){var f=a,g=+e+d,h=c[e].bind(b);if(void 0!==h)for(var k=+e+d;k<=g;k++)void 0!==f.B[k]?r("Output port "+q(k)+" already registered"):f.B[k]=[h,!1]}}
function zc(a,b,c,d){for(var e=1,f=0;0<e;){var g=a.B[b],h=a.S[b]||1,k=1==h?255:2==h?65535:-1;k&=c>>>=f;if(void 0!==g){if(g[0])g[0](b,k,d);a.J&&a.F!=g[1]&&Ac(a.J,b,k)}else a.J&&(Pb(a.J,a,b,k,d),a.F&&Ac(a.J,b,k));f+=h<<3;b+=h;e-=h}}function ac(a,b,c){r("Memory block error ("+a+": "+p(b)+","+p(c)+")");return!1}var bc=1,dc=2,Bc;if(Qb){var Cc=new ArrayBuffer(2);(new DataView(Cc)).setUint16(0,256,!0);Bc=256===(new Uint16Array(Cc))[0]}else Bc=!1;var Dc=Bc;
function A(a,b,c,d){this.id=Ec+=2;this.b=null;this.K=a;this.lb=b;this.size=c||0;this.type=d||Fc;this.w=d==Gc;Zb(this);this.Ca=this.Cc=!1;if(c)if(Qb)this.P=new ArrayBuffer(c),this.j=new DataView(this.P,0,c),this.g=new Uint8Array(this.P,0,c),this.u=new Uint16Array(this.P,0,c>>1),this.b=new Int32Array(this.P,0,c>>2),Hc(this,Dc?Ic:Jc);else{this.b=Array(c>>2);for(a=0;a<this.b.length;a++)this.b[a]=0;Hc(this,Kc)}else Hc(this)}l=A.prototype;
l.save=function(){var a;if(Qb){var b=Array(this.size>>2);for(a=0;a<b.length;a++)b[a]=this.j.getInt32(a<<2,!0)}else b=this.b;return b};l.restore=function(a){if(a&&this.size==a.length<<2){var b;if(Qb)for(b=0;b<a.length;b++)this.j.setInt32(b<<2,a[b],!0);else this.b=a;return this.Ca=!0}return!1};function Hc(a,b){b||(b=Lc);Mc(a,b,void 0);Nc(a,b,void 0)}function Mc(a,b,c){c&&a.H||(a.Va=b[0]||a.Fc,a.Gc=b[2]||a.Hc);if(c||void 0===c)a.kb=b[0]||a.Fc,a.Lb=b[2]||a.Hc}
function Nc(a,b,c){c&&a.O||(a.Xa=!a.w&&b[1]||a.nb,a.Jc=!a.w&&b[3]||a.Qb);if(c||void 0===c)a.mb=b[1]||a.nb,a.Rb=b[3]||a.Qb}l.Ma=function(a,b){b?0===this.O++&&Nc(this,Oc,!1):0===this.H++&&Mc(this,Oc,!1)};function Pc(a,b){b?0===--a.O&&(a.Xa=a.w?a.nb:a.mb,a.Jc=a.w?a.Qb:a.Rb):0===--a.H&&(a.Va=a.kb,a.Gc=a.Lb)}function Zb(a,b,c){a.J=b;a.H=a.O=0;c&&((a.H=c.H)&&Mc(a,Oc,!1),(a.O=c.O)&&Nc(a,Oc,!1))}l.Fc=function(){this.J&&Nb(this.J,129)&&this.J.message("attempt to read invalid block %"+p(this.K),!0);return 255};
l.nb=function(a,b){this.J&&Nb(this.J,129)&&this.J.message("attempt to write "+q(b)+" to invalid block %"+p(this.K),!0)};l.Hc=function(a,b){return this.Va(a++,b++)|this.Va(a,b)<<8};l.Qb=function(a,b,c){this.Xa(a++,b&255,c++);this.Xa(a,b>>8,c)};l.he=function(a){return this.b[a>>2]>>>((a&3)<<3)&255};l.le=function(a){var b=a>>2;a=(a&3)<<3;var c=this.b[b]>>a;return 24>a?c&65535:c&255|(this.b[b+1]&255)<<8};l.ve=function(a,b){var c=a>>2;a=(a&3)<<3;this.b[c]=this.b[c]&~(255<<a)|b<<a;this.Ca=!0};
l.ze=function(a,b){var c=a>>2;a=(a&3)<<3;24>a?this.b[c]=this.b[c]&~(65535<<a)|b<<a:(this.b[c]=this.b[c]&16777215|b<<24,c++,this.b[c]=this.b[c]&-256|b>>8);this.Ca=!0};l.fe=function(a,b){if(this.J&&null!=this.K){var c=this.J;Qc(c,this.K+a,1,c.M)&&Rc(c,!0)}return this.kb(a,b)};l.je=function(a,b){if(this.J&&null!=this.K){var c=this.J;Qc(c,this.K+a,2,c.M)&&Rc(c,!0)}return this.Lb(a,b)};
l.te=function(a,b,c){if(this.J&&null!=this.K){var d=this.J;Qc(d,this.K+a,1,d.B)&&Rc(d,!0)}this.w?this.nb(a,b,c):this.mb(a,b,c)};l.xe=function(a,b,c){if(this.J&&null!=this.K){var d=this.J;Qc(d,this.K+a,2,d.B)&&Rc(d,!0)}this.w?this.nb(a,b,c):this.Rb(a,b,c)};l.ee=function(a){return this.g[a]};l.ge=function(a){return this.g[a]};l.ie=function(a){return this.j.getUint16(a,!0)};l.ke=function(a){return a&1?this.g[a]|this.g[a+1]<<8:this.u[a>>1]};l.se=function(a,b){this.g[a]=b;this.Ca=!0};
l.ue=function(a,b){this.g[a]=b;this.Ca=!0};l.we=function(a,b){this.j.setUint16(a,b,!0);this.Ca=!0};l.ye=function(a,b){a&1?(this.g[a]=b,this.g[a+1]=b>>8):this.u[a>>1]=b;this.Ca=!0};var Fc=0,Gc=2,cc=["NONE","RAM","ROM","VID","H/W"],Ec=0,Lc=[],Kc=[A.prototype.he,A.prototype.ve,A.prototype.le,A.prototype.ze],Oc=[A.prototype.fe,A.prototype.te,A.prototype.je,A.prototype.xe];if(Qb)var Jc=[A.prototype.ee,A.prototype.se,A.prototype.ie,A.prototype.we],Ic=[A.prototype.ge,A.prototype.ue,A.prototype.ke,A.prototype.ye];
function Sc(a,b){v.call(this,"CPU",a,1);var c=a.multiplier||1;this.xa=a.cycles||b;this.S=c;this.Ra=Math.round(this.xa/1E4)/100;this.Y=this.Ra*this.S;this.flags.ia=!1;this.flags.Ob=!1;this.flags.gb=a.autoStart;this.flags.Ac=!1;this.flags.Ua=!1;this.ua=this.ma=0;this.wa=a.csStart;this.la=a.csInterval;this.qa=a.csStop;this.T=[];this.ob=this.qb.bind(this);Kb(this)}ia(Sc,v);l=Sc.prototype;
l.Da=function(a,b,c,d){this.P=a;this.H=b;this.J=d;for(b=0;b<Tc.length;b++)(c=this.O[Tc[b]])&&this.P.ca("",Tc[b],c);this.V=Wb(a,"ChipSet");a=Uc(a,"autoStart");null!=a&&(this.flags.gb="true"==a?!0:"false"==a?!1:!!a);Kb(this)};l.reset=function(){};l.save=function(){return null};l.restore=function(){return!1};
l.ta=function(a,b){if(!b){if(a&&this.restore){Vc(this);if(!this.restore(a))return!1;Wc(this)}else this.reset();this.J?(a=this.J,a.i("Type ? for help with PC8080 Debugger commands"),Xc(a),a.la&&(b=a.la,a.la=null,Yc(a,b))):this.i("No debugger detected")}Zc(this);return!0};l.sa=function(a){return a?this.save():!0};l.gb=function(){return this.flags.gb||!this.J&&void 0===this.O.run?(this.qb(),!0):!1};l.Dc=function(){return 0};
function Wc(a){void 0===a.wa&&(a.wa=0);void 0===a.la&&(a.la=-1);void 0===a.qa&&(a.qa=-1);a.flags.Ua=0<=a.wa&&0<a.la;a.flags.Ua&&(a.ua=0,a.ma=a.wa-a.ja)}function $c(a,b){if(a.flags.Ua){var c=!1;a.ua=a.ua+a.Dc()|0;a.ma-=b;0>=a.ma&&(a.ma+=a.la,c=!0);0<=a.qa&&a.qa<=ad(a)&&(a.la=a.qa=-1,Wc(a),bd(a),c=!0);c&&a.i(ad(a)+" cycles: checksum\x3d"+p(a.ua))}}
l.ca=function(a,b,c){var d=this;a=!1;switch(b){case "power":case "reset":this.O[b]=c;a=!0;break;case "run":this.O[b]=c;c.onclick=function(){var a;if(a=d.P)if(a=d.P,a.flags.ha)a=!0;else{var b=null,c,h=yb(a.id);for(c=0;c<h.length&&(b=h[c],b===a||b.flags.ready);c++);if(c==h.length)for(c=0;c<h.length&&(b=h[c],b===a||b.flags.ha);c++);c==h.length&&(b=a);r("The "+b.type+" component ("+b.id+") is not "+(b.flags.ready?"powered yet":"ready yet"+(b.xb?" (waiting for notification)":""))+".");a=!1}a&&(d.flags.ia?
bd(d):d.qb())};a=!0;break;case "speed":this.O[b]=c;a=!0;break;case "setSpeed":this.O[b]=c,c.onclick=function(){cd(d,d.S<<1,!0)},c.textContent=this.Y.toFixed(2)+"Mhz",a=!0}return a};function nd(a,b,c){a.ja+=b;c&&(a.da=a.b=0)}function od(a,b){var c=1;b&&1<a.S&&a.X&&(c=a.X/a.Ra);a.eb=Math.round(1E3/pd);a.Ka=Math.floor(a.xa/pd*c);b||(a.ra=a.Ka);a.Ta=0}function ad(a){return a.ja+a.W+a.da-a.b}function Vc(a){a.X=0;a.fb=0;a.ja=a.W=a.da=a.b=0;Wc(a);cd(a,1)}
function cd(a,b,c){var d=!1;if(void 0!==b){.8>a.X/a.Y?b=1:d=!0;a.S=b;b=a.Ra*a.S;if(a.Y!=b){a.Y=b;b=a.Y.toFixed(2)+"Mhz";var e=a.O.setSpeed;e&&(e.textContent=b);a.i("target speed: "+b)}c&&a.P&&a.P.Wa()}nd(a,a.W);a.W=0;a.U=sb();a.aa=0;od(a);return d}function qd(a,b,c){var d=void 0===d?-1:d;var e=a.T.length;a.T.push([b,-1,d,c]);0<=d&&rd(a,e,d);return e}function rd(a,b,c){0<=b&&b<a.T.length&&(b=a.T[b],0>b[1]&&(c=a.xa*a.S/1E3*c|0,a.flags.ia&&(c+=sd(a)),b[1]=c))}
function sd(a,b){var c=a.da-=a.b;a.b=0;b&&(a.da=0);return c}
l.qb=function(a){if(Mb(this,!0)){if(!this.flags.ia){cd(this);this.P&&this.P.start(this.U,ad(this));this.flags.ia=!0;this.flags.Ob=!0;this.V&&this.V.start();var b=this.O.run;b&&(b.textContent="Halt");this.P&&(td(this.P,!0),a&&this.P.Wa(!0))}this.Ta>=this.xa&&od(this,!0);this.Ba=0;this.Ja=sb();this.aa&&(a=this.Ja-this.aa,a>this.eb&&(this.U+=a,this.U>this.Ja&&(this.U=this.Ja)));try{do{for(var c,d=this.flags.Ua?1:this.Ka,e=this.T.length-1;0<=e;e--){var f=this.T[e];0>f[1]||d>f[1]&&(d=f[1])}c=d;this.Bb(c);
c=sd(this,!0);this.Ba+=c;this.W+=c;$c(this,c);a=c;for(var g=this.T.length-1;0<=g;g--){var h=this.T[g];0>h[1]||(h[1]-=a,0>=h[1]&&(h[1]=-1,h[3](),0<=h[2]&&rd(this,g,h[2])))}this.ra-=c;if(0>=this.ra){this.ra+=this.Ka;++this.fb>=ud&&(this.P&&td(this.P),this.fb=0);break}}while(this.flags.ia)}catch(k){bd(this);Zc(this);this.P&&this.P.stop(sb(),ad(this));Mb(this,!1);Ib(this,k.stack||k.message);return}c=setTimeout;d=this.ob;this.aa=sb();e=this.eb;this.Ba&&(e=Math.round(e*this.Ba/this.Ka));e-=this.aa-this.Ja;
if(f=this.aa-this.U)this.X=Math.round(this.W/(10*f))/100,864E5<=f&&(this.ja=0,cd(this));if(0>e||this.X<this.Y)-1E3>e&&(this.U-=e),e=0;this.Ta+=this.Ba;this.aa+=e;c(d,e)}else Zc(this),this.P&&this.P.stop(sb(),ad(this))};l.Bb=function(){return 0};function bd(a,b){Lb(a,!0);sd(a);nd(a,a.W);a.W=0;if(a.flags.ia){a.flags.ia=!1;a.V&&a.V.stop();var c=a.O.run;c&&(c.textContent="Run")}a.flags.complete=b}function Zc(a,b){if(a.P){for(var c=a.P,d=0;d<c.A.length;d++)vd(c.A[d],b);td(a.P,b)}}
var pd=30,ud=15,Tc=["power","reset"];function wd(a){var b=+a.model||8080;Sc.call(this,a,1E6);this.ub=b;this.ab=xd;Vc(this);this.flags.complete=this.flags.wd=!1;this.cb=0;this.Ia=[];this.bb=0;yd(this)}ia(wd,Sc);function zd(a,b){a.Ia.push(b)}l=wd.prototype;l.reset=function(){this.flags.ia&&bd(this);yd(this);Vc(this);this.flags.error=!1;Sc.prototype.reset.call(this)};function yd(a){a.g=0;a.u=0;a.A=0;a.B=0;a.C=0;a.D=0;a.F=0;a.L=0;B(a,a.bb);Ad(a,0);a.R=0}function Bd(a,b){a.bb=b;B(a,b)}
l.Dc=function(){var a=this.g+this.u+this.A+this.B+this.C+this.D+this.F|0;return a=a+this.L+this.j+Cd(this)|0};l.save=function(){var a=new Dd(this);a.set(0,[this.g,this.u,this.A,this.B,this.C,this.D,this.F,this.L,this.j,Cd(this)]);a.set(1,[this.R,this.ja,this.S]);a.set(2,jc(this.H));return a.data()};
l.restore=function(a){var b=a[0];this.g=b[0];this.u=b[1];this.A=b[2];this.B=b[3];this.C=b[4];this.D=b[5];this.F=b[6];this.L=b[7]&65535;B(this,b[8]);Ad(this,b[9]);b=a[1];this.R=b[0];this.ja=b[1];cd(this,b[3]);a:{b=this.H;a=a[2];var c;for(c=0;c<a.length-1;c+=2){var d=a[c],e=a[c+1];if(e&&e.length<b.N){var f=b.N,g=0;f=f?Array(f):[];for(var h=0;h<e.length-1;)for(var k=e[h++],n=e[h++];k--;)f[g++]=n;e=f}g=b.b[d];if(!g||!g.restore(e)){r("Unable to restore memory block "+d);b=!1;break a}}b=!0}return b};
l.ca=function(a,b,c){switch(b){case "A":case "B":case "C":case "BC":case "D":case "E":case "DE":case "H":case "L":case "HL":case "SP":case "PC":case "PS":case "IF":case "SF":case "ZF":case "AF":case "PF":case "CF":this.O[b]=c;this.cb++;a=!0;break;default:a=Sc.prototype.ca.call(this,a,b,c)}return a};function Ed(a){return a.u<<8|a.A}function Fd(a,b){a.u=b>>8&255;a.A=b&255}function Gd(a){return a.B<<8|a.C}function Hd(a,b){a.B=b>>8&255;a.C=b&255}function C(a){return a.D<<8|a.F}
function Id(a,b){a.D=b>>8&255;a.F=b&255}function B(a,b){a.j=b&65535}function Jd(a){return a.G&256?1:0}function Kd(a,b){a.G=a.G&255|b}function Ld(a){return Rb[a.I&255]?4:0}function Md(a){return(a.I^a.N)&16?16:0}function Nd(a){return a.G&255?0:64}function Od(a){return a.I&128?128:0}function Cd(a){return a.M&-214|Od(a)|Nd(a)|Md(a)|Ld(a)|Jd(a)}function Ad(a,b){a.G=a.I=a.N=0;b&1&&(a.G|=256);b&4||(a.I|=1);b&16&&(a.N|=16);b&64||(a.G|=255);b&128&&(a.I^=192);a.M=a.M&-726|b&512|2}
function Pd(a,b){a.N=a.g^b;return a.I=(a.G=a.g+b)&255}function Qd(a,b){a.N=a.g^b;return a.I=(a.G=a.g+b+(a.G&256?1:0))&255}function Rd(a,b){a.G=a.I=a.N=a.g&b;(a.g|b)&8&&(a.N^=16);return a.G}function Sd(a,b){a.N=b^255;b=a.I=b+255&255;a.G=a.G&-256|b;return b}function Td(a,b){a.N=b;b=a.I=b+1&255;a.G=a.G&-256|b;return b}function Ud(a,b){return a.I=a.G=a.N=a.g|b}function Vd(a,b){b^=255;a.N=a.g^b;return a.I=(a.G=a.g+b+1^256)&255}
function Wd(a,b){b^=255;a.N=a.g^b;return a.I=(a.G=a.g+b+(a.G&256?0:1)^256)&255}function Xd(a,b){return a.I=a.G=a.N=a.g^b}function E(a,b){a=a.H;return a.b[(b&a.C)>>>a.g].Va(b&a.j,b)}function Yd(a,b,c){a=a.H;a.b[(b&a.C)>>>a.g].Xa(b&a.j,c&255,b)}function F(a){var b=E(a,a.j);B(a,a.j+1);return b}function G(a){var b=fc(a.H,a.j);B(a,a.j+2);return b}function Zd(a){var b=fc(a.H,a.L);a.L=a.L+2&65535;return b}function H(a,b){a.L=a.L-2&65535;ic(a.H,a.L,b)}
function $d(a){if(a.b&&a.R&255&&a.M&512){for(var b=0;8>b&&!(a.R&1<<b);b++);a.R&=~(0>b?255:1<<b);a.M&=-513;a.R&=-257;a.ab[199|b<<3].call(a)}return a.R&256?(sd(a),!1):!0}function ae(a,b){a.R|=1<<b;a.M&512&&sd(a)}function I(a,b,c,d){d=d||2;a.O[b]&&(void 0===c&&(Ib(a,"Value for "+b+" is invalid"),bd(a)),c=!a.flags.ia||a.flags.Ac?p(c,d):"--------".substr(0,d),a.O[b].textContent!=c&&(a.O[b].textContent=c))}
l.Bb=function(a){this.flags.complete=!0;var b=this.flags.wd=this.J&&be(this.J),c=a?this.flags.Ob?0:1:-1;this.flags.Ob=!1;this.da=this.b=a;if($d(this)){do{if(b){if(ce(this.J,this.j,c)){bd(this);break}c=1}this.ab[F(this)].call(this)}while(0<this.b)}return this.flags.complete?this.da-this.b:void 0===this.flags.complete?0:-1};ab(function(){for(var a=wb(document,"pc8080","cpu"),b=0;b<a.length;b++){var c=a[b],d=xb(c);d=new wd(d);vb(d,c)}});function de(){this.b-=4}
function ee(){B(this,G(this));this.b-=10}function fe(){B(this,Zd(this));this.b-=10}function ge(){var a=G(this);H(this,this.j);B(this,a);this.b-=17}
var xd=[de,function(){Fd(this,G(this));this.b-=10},function(){Yd(this,Ed(this),this.g);this.b-=7},function(){Fd(this,Ed(this)+1);this.b-=5},function(){this.u=Td(this,this.u);this.b-=5},function(){this.u=Sd(this,this.u);this.b-=5},function(){this.u=F(this);this.b-=7},function(){var a=this.g<<1;this.g=a&255|a>>8;Kd(this,a&256);this.b-=4},de,function(){var a;Id(this,a=C(this)+Ed(this));Kd(this,a>>8&256);this.b-=10},function(){this.g=E(this,Ed(this));this.b-=7},function(){Fd(this,Ed(this)-1);this.b-=
5},function(){this.A=Td(this,this.A);this.b-=5},function(){this.A=Sd(this,this.A);this.b-=5},function(){this.A=F(this);this.b-=7},function(){var a=this.g<<8&256;this.g=(a|this.g)>>1;Kd(this,a);this.b-=4},de,function(){Hd(this,G(this));this.b-=10},function(){Yd(this,Gd(this),this.g);this.b-=7},function(){Hd(this,Gd(this)+1);this.b-=5},function(){this.B=Td(this,this.B);this.b-=5},function(){this.B=Sd(this,this.B);this.b-=5},function(){this.B=F(this);this.b-=7},function(){var a=this.g<<1;this.g=a&255|
Jd(this);Kd(this,a&256);this.b-=4},de,function(){var a;Id(this,a=C(this)+Gd(this));Kd(this,a>>8&256);this.b-=10},function(){this.g=E(this,Gd(this));this.b-=7},function(){Hd(this,Gd(this)-1);this.b-=5},function(){this.C=Td(this,this.C);this.b-=5},function(){this.C=Sd(this,this.C);this.b-=5},function(){this.C=F(this);this.b-=7},function(){var a=this.g<<8;this.g=(Jd(this)<<8|this.g)>>1;Kd(this,a&256);this.b-=4},de,function(){Id(this,G(this));this.b-=10},function(){var a=G(this);ic(this.H,a,C(this));
this.b-=16},function(){Id(this,C(this)+1);this.b-=5},function(){this.D=Td(this,this.D);this.b-=5},function(){this.D=Sd(this,this.D);this.b-=5},function(){this.D=F(this);this.b-=7},function(){var a=0,b=Jd(this);if(Md(this)||9<(this.g&15))a|=6;if(b||154<=this.g)a|=96,b=1;this.g=Pd(this,a);Kd(this,b?256:0);this.b-=4},de,function(){var a;Id(this,a=C(this)+C(this));Kd(this,a>>8&256);this.b-=10},function(){var a=G(this);a=fc(this.H,a);Id(this,a);this.b-=16},function(){Id(this,C(this)-1);this.b-=5},function(){this.F=
Td(this,this.F);this.b-=5},function(){this.F=Sd(this,this.F);this.b-=5},function(){this.F=F(this);this.b-=7},function(){this.g=~this.g&255;this.b-=4},de,function(){this.L=G(this)&65535;this.b-=10},function(){Yd(this,G(this),this.g);this.b-=13},function(){this.L=this.L+1&65535;this.b-=5},function(){var a=C(this);Yd(this,a,Td(this,E(this,a)));this.b-=10},function(){var a=C(this);Yd(this,a,Sd(this,E(this,a)));this.b-=10},function(){Yd(this,C(this),F(this));this.b-=10},function(){this.G|=256;this.b-=
4},de,function(){var a;Id(this,a=C(this)+this.L);Kd(this,a>>8&256);this.b-=10},function(){this.g=E(this,G(this));this.b-=13},function(){this.L=this.L-1&65535;this.b-=5},function(){this.g=Td(this,this.g);this.b-=5},function(){this.g=Sd(this,this.g);this.b-=5},function(){this.g=F(this);this.b-=7},function(){Kd(this,Jd(this)?0:256);this.b-=4},function(){this.b-=5},function(){this.u=this.A;this.b-=5},function(){this.u=this.B;this.b-=5},function(){this.u=this.C;this.b-=5},function(){this.u=this.D;this.b-=
5},function(){this.u=this.F;this.b-=5},function(){this.u=E(this,C(this));this.b-=7},function(){this.u=this.g;this.b-=5},function(){this.A=this.u;this.b-=5},function(){this.b-=5},function(){this.A=this.B;this.b-=5},function(){this.A=this.C;this.b-=5},function(){this.A=this.D;this.b-=5},function(){this.A=this.F;this.b-=5},function(){this.A=E(this,C(this));this.b-=7},function(){this.A=this.g;this.b-=5},function(){this.B=this.u;this.b-=5},function(){this.B=this.A;this.b-=5},function(){this.b-=5},function(){this.B=
this.C;this.b-=5},function(){this.B=this.D;this.b-=5},function(){this.B=this.F;this.b-=5},function(){this.B=E(this,C(this));this.b-=7},function(){this.B=this.g;this.b-=5},function(){this.C=this.u;this.b-=5},function(){this.C=this.A;this.b-=5},function(){this.C=this.B;this.b-=5},function(){this.b-=5},function(){this.C=this.D;this.b-=5},function(){this.C=this.F;this.b-=5},function(){this.C=E(this,C(this));this.b-=7},function(){this.C=this.g;this.b-=5},function(){this.D=this.u;this.b-=5},function(){this.D=
this.A;this.b-=5},function(){this.D=this.B;this.b-=5},function(){this.D=this.C;this.b-=5},function(){this.b-=5},function(){this.D=this.F;this.b-=5},function(){this.D=E(this,C(this));this.b-=7},function(){this.D=this.g;this.b-=5},function(){this.F=this.u;this.b-=5},function(){this.F=this.A;this.b-=5},function(){this.F=this.B;this.b-=5},function(){this.F=this.C;this.b-=5},function(){this.F=this.D;this.b-=5},function(){this.b-=5},function(){this.F=E(this,C(this));this.b-=7},function(){this.F=this.g;
this.b-=5},function(){Yd(this,C(this),this.u);this.b-=7},function(){Yd(this,C(this),this.A);this.b-=7},function(){Yd(this,C(this),this.B);this.b-=7},function(){Yd(this,C(this),this.C);this.b-=7},function(){Yd(this,C(this),this.D);this.b-=7},function(){Yd(this,C(this),this.F);this.b-=7},function(){var a=this.j-1;if(this.Ia.length)for(var b=0;b<this.Ia.length;b++)if(this.Ia[b](a))return;this.b-=7;this.R|=256;sd(this);this.J&&Nb(this,-2147483648)?(B(this,a),Rc(this.J)):this.M&512||(this.J&&B(this,a),
bd(this))},function(){Yd(this,C(this),this.g);this.b-=7},function(){this.g=this.u;this.b-=5},function(){this.g=this.A;this.b-=5},function(){this.g=this.B;this.b-=5},function(){this.g=this.C;this.b-=5},function(){this.g=this.D;this.b-=5},function(){this.g=this.F;this.b-=5},function(){this.g=E(this,C(this));this.b-=7},function(){this.b-=5},function(){this.g=Pd(this,this.u);this.b-=4},function(){this.g=Pd(this,this.A);this.b-=4},function(){this.g=Pd(this,this.B);this.b-=4},function(){this.g=Pd(this,
this.C);this.b-=4},function(){this.g=Pd(this,this.D);this.b-=4},function(){this.g=Pd(this,this.F);this.b-=4},function(){this.g=Pd(this,E(this,C(this)));this.b-=7},function(){this.g=Pd(this,this.g);this.b-=4},function(){this.g=Qd(this,this.u);this.b-=4},function(){this.g=Qd(this,this.A);this.b-=4},function(){this.g=Qd(this,this.B);this.b-=4},function(){this.g=Qd(this,this.C);this.b-=4},function(){this.g=Qd(this,this.D);this.b-=4},function(){this.g=Qd(this,this.F);this.b-=4},function(){this.g=Qd(this,
E(this,C(this)));this.b-=7},function(){this.g=Qd(this,this.g);this.b-=4},function(){this.g=Vd(this,this.u);this.b-=4},function(){this.g=Vd(this,this.A);this.b-=4},function(){this.g=Vd(this,this.B);this.b-=4},function(){this.g=Vd(this,this.C);this.b-=4},function(){this.g=Vd(this,this.D);this.b-=4},function(){this.g=Vd(this,this.F);this.b-=4},function(){this.g=Vd(this,E(this,C(this)));this.b-=7},function(){this.g=Vd(this,this.g);this.b-=4},function(){this.g=Wd(this,this.u);this.b-=4},function(){this.g=
Wd(this,this.A);this.b-=4},function(){this.g=Wd(this,this.B);this.b-=4},function(){this.g=Wd(this,this.C);this.b-=4},function(){this.g=Wd(this,this.D);this.b-=4},function(){this.g=Wd(this,this.F);this.b-=4},function(){this.g=Wd(this,E(this,C(this)));this.b-=7},function(){this.g=Wd(this,this.g);this.b-=4},function(){this.g=Rd(this,this.u);this.b-=4},function(){this.g=Rd(this,this.A);this.b-=4},function(){this.g=Rd(this,this.B);this.b-=4},function(){this.g=Rd(this,this.C);this.b-=4},function(){this.g=
Rd(this,this.D);this.b-=4},function(){this.g=Rd(this,this.F);this.b-=4},function(){this.g=Rd(this,E(this,C(this)));this.b-=7},function(){this.g=Rd(this,this.g);this.b-=4},function(){this.g=Xd(this,this.u);this.b-=4},function(){this.g=Xd(this,this.A);this.b-=4},function(){this.g=Xd(this,this.B);this.b-=4},function(){this.g=Xd(this,this.C);this.b-=4},function(){this.g=Xd(this,this.D);this.b-=4},function(){this.g=Xd(this,this.F);this.b-=4},function(){this.g=Xd(this,E(this,C(this)));this.b-=7},function(){this.g=
Xd(this,this.g);this.b-=4},function(){this.g=Ud(this,this.u);this.b-=4},function(){this.g=Ud(this,this.A);this.b-=4},function(){this.g=Ud(this,this.B);this.b-=4},function(){this.g=Ud(this,this.C);this.b-=4},function(){this.g=Ud(this,this.D);this.b-=4},function(){this.g=Ud(this,this.F);this.b-=4},function(){this.g=Ud(this,E(this,C(this)));this.b-=7},function(){this.g=Ud(this,this.g);this.b-=4},function(){Vd(this,this.u);this.b-=4},function(){Vd(this,this.A);this.b-=4},function(){Vd(this,this.B);this.b-=
4},function(){Vd(this,this.C);this.b-=4},function(){Vd(this,this.D);this.b-=4},function(){Vd(this,this.F);this.b-=4},function(){Vd(this,E(this,C(this)));this.b-=7},function(){Vd(this,this.g);this.b-=4},function(){Nd(this)||(B(this,Zd(this)),this.b-=6);this.b-=5},function(){Fd(this,Zd(this));this.b-=10},function(){var a=G(this);Nd(this)||B(this,a);this.b-=10},ee,function(){var a=G(this);Nd(this)||(H(this,this.j),B(this,a),this.b-=6);this.b-=11},function(){H(this,Ed(this));this.b-=11},function(){this.g=
Pd(this,F(this));this.b-=7},function(){H(this,this.j);B(this,0);this.b-=11},function(){Nd(this)&&(B(this,Zd(this)),this.b-=6);this.b-=5},fe,function(){var a=G(this);Nd(this)&&B(this,a);this.b-=10},ee,function(){var a=G(this);Nd(this)&&(H(this,this.j),B(this,a),this.b-=6);this.b-=11},ge,function(){this.g=Qd(this,F(this));this.b-=7},function(){H(this,this.j);B(this,8);this.b-=11},function(){Jd(this)||(B(this,Zd(this)),this.b-=6);this.b-=5},function(){Hd(this,Zd(this));this.b-=10},function(){var a=G(this);
Jd(this)||B(this,a);this.b-=10},function(){var a=F(this);zc(this.H,a,this.g,this.j+-2&65535);this.b-=10},function(){var a=G(this);Jd(this)||(H(this,this.j),B(this,a),this.b-=6);this.b-=11},function(){H(this,Gd(this));this.b-=11},function(){this.g=Vd(this,F(this));this.b-=7},function(){H(this,this.j);B(this,16);this.b-=11},function(){Jd(this)&&(B(this,Zd(this)),this.b-=6);this.b-=5},fe,function(){var a=G(this);Jd(this)&&B(this,a);this.b-=10},function(){var a=F(this);this.g=mc(this.H,a,this.j+-2&65535)&
255;this.b-=10},function(){var a=G(this);Jd(this)&&(H(this,this.j),B(this,a),this.b-=6);this.b-=11},ge,function(){this.g=Wd(this,F(this));this.b-=7},function(){H(this,this.j);B(this,24);this.b-=11},function(){Ld(this)||(B(this,Zd(this)),this.b-=6);this.b-=5},function(){Id(this,Zd(this));this.b-=10},function(){var a=G(this);Ld(this)||B(this,a);this.b-=10},function(){var a=Zd(this);H(this,C(this));Id(this,a);this.b-=18},function(){var a=G(this);Ld(this)||(H(this,this.j),B(this,a),this.b-=6);this.b-=
11},function(){H(this,C(this));this.b-=11},function(){this.g=Rd(this,F(this));this.b-=7},function(){H(this,this.j);B(this,32);this.b-=11},function(){Ld(this)&&(B(this,Zd(this)),this.b-=6);this.b-=5},function(){B(this,C(this));this.b-=5},function(){var a=G(this);Ld(this)&&B(this,a);this.b-=10},function(){var a=C(this);Id(this,Gd(this));Hd(this,a);this.b-=5},function(){var a=G(this);Ld(this)&&(H(this,this.j),B(this,a),this.b-=6);this.b-=11},ge,function(){this.g=Xd(this,F(this));this.b-=7},function(){H(this,
this.j);B(this,40);this.b-=11},function(){Od(this)||(B(this,Zd(this)),this.b-=6);this.b-=5},function(){var a=Zd(this);Ad(this,a&255|this.M&-256);this.g=a>>8;this.b-=10},function(){var a=G(this);Od(this)||B(this,a);this.b-=10},function(){this.M&=-513;this.b-=4},function(){var a=G(this);Od(this)||(H(this,this.j),B(this,a),this.b-=6);this.b-=11},function(){H(this,Cd(this)&255|this.g<<8);this.b-=11},function(){this.g=Ud(this,F(this));this.b-=7},function(){H(this,this.j);B(this,48);this.b-=11},function(){Od(this)&&
(B(this,Zd(this)),this.b-=6);this.b-=5},function(){this.L=C(this)&65535;this.b-=5},function(){var a=G(this);Od(this)&&B(this,a);this.b-=10},function(){this.M|=512;this.b-=4;$d(this)},function(){var a=G(this);Od(this)&&(H(this,this.j),B(this,a),this.b-=6);this.b-=11},ge,function(){Vd(this,F(this));this.b-=7},function(){H(this,this.j);B(this,56);this.b-=11}];
function he(a){v.call(this,"ChipSet",a,32768);var b=a.model;b&&!ie[b]&&gb("Unrecognized ChipSet model: "+b);this.g=ie[b]||{};a.sound&&(this.T=null,window&&(this.T=window.AudioContext||window.webkitAudioContext),this.T&&new this.T);Kb(this)}ia(he,v);l=he.prototype;l.ca=function(){return!1};
l.Da=function(a,b,c,d){this.H=b;this.w=c;this.J=d;this.P=a;this.B=Wb(a,"Keyboard");this.C=Wb(a,"SerialPort");this.video=Wb(a,"Video");lc(b,this,this.g.zb);yc(b,this,this.g.Ab);if(d){var e=this;je(d,16384,function(){for(var a="",b=0;b<e.j.length;b++)a&&(a+=b&&b%10?", ":",\n"),a+=q(e.j[b]);e.J.i(a)})}};l.ta=function(a,b){if(!b)if(!a)this.reset();else if(!this.restore(a))return!1;return!0};l.sa=function(a){return a?this.save():!0};l.reset=function(){this.g.INIT&&!this.restore(this.g.INIT)&&this.Z("reset error")};
l.save=function(){var a=new Dd(this);switch(this.g.na){case ke.na:a.set(0,[this.aa,this.A,this.da,this.M,this.S,this.X,this.Y]);break;case J.na:a.set(0,[this.V,this.D]),a.set(1,[this.F,this.G]),a.set(2,[this.u,this.N,this.W,this.U]),a.set(3,[this.L,this.b,this.I,this.R,this.j])}return a.data()};
l.restore=function(a){var b;if(a&&(b=a[0])&&b.length)switch(this.g.na){case ke.na:return this.aa=b[0],this.A=b[1],this.da=b[2],this.M=b[3],this.S=b[4],this.X=b[5],this.Y=b[6],!0;case J.na:return this.V=b[0],this.D=b[1],b=a[1],this.F=b[0],this.G=b[1],b=a[2],this.u=b[0],this.N=b[1],this.W=b[2],this.U=b[3],b=a[3],this.L=b[0],this.b=b[1],this.I=b[2],this.R=b[3],this.j=b[4],!0}return!1};l.start=function(){};l.stop=function(){};l.Id=function(a,b){var c=this.aa;z(this,a,void 0,b,"STATUS0",c,!0);return c};
l.Jd=function(a,b){var c=this.A;z(this,a,void 0,b,"STATUS1",c,!0);return c};l.Kd=function(a,b){var c=this.da;z(this,a,void 0,b,"STATUS2",c,!0);return c};l.Hd=function(a,b){var c=this.M>>8-this.S&255;z(this,a,void 0,b,"SHIFT.RESULT",c,!0);return c};l.Vd=function(a,b,c){z(this,a,b,c,"SHIFT.COUNT",void 0,!0);this.S=b};l.Xd=function(a,b,c){z(this,a,b,c,"SOUND1",void 0,!0);this.X=b};l.Wd=function(a,b,c){z(this,a,b,c,"SHIFT.DATA",void 0,!0);this.M=b<<8|this.M>>8};
l.Yd=function(a,b,c){z(this,a,b,c,"SOUND2",void 0,!0);this.Y=b};l.Zd=function(a,b,c){z(this,a,b,c,"WATCHDOG",void 0,!0)};function le(a){var b=0,c=0,d=~a.L;for(a=0;10>a;a++)d&1&&(b=9-a),d>>=1;for(a=0;10>a;a++)d&1&&(c=9-a),d>>=1;return 10*b+c}
l.Ld=function(a,b){var c=this.D;c&=~J.va.ic;if((ad(this.w)&64)<<1&&(c|=J.va.ic,c!=this.D)){var d=this.I&1;var e=this.I>>1&7;switch(e){case J.ya.Ga.md:break;case J.ya.Ga.Kc:this.L=this.L<<1|d;break;case J.ya.Ga.Qc:d=le(this);this.j[d]=J.ya.sb;Ob(this,"doNVRCommand(): erase data at addr "+q(d));break;case J.ya.Ga.Lc:this.b=this.b<<1|d;break;case J.ya.Ga.qd:d=le(this);e=this.b&J.ya.sb;this.j[d]=e;Ob(this,"doNVRCommand(): write data "+q(e)+" to addr "+q(d));break;case J.ya.Ga.kd:d=le(this);e=this.j[d];
null==e&&(e=J.ya.sb);this.b=e;Ob(this,"doNVRCommand():  read data "+q(e)+" from addr "+q(d));break;case J.ya.Ga.ld:this.b<<=1;this.R=this.b&J.ya.sb+1;break;default:Ob(this,"doNVRCommand(): unrecognized command "+qa(e))}}c&=~J.va.jc;this.R&&(c|=J.va.jc);c&=~J.va.cc;if(d=this.B){d=this.B;if(e=d.A)e=d.w,e=ad(d.w)>=d.F+(e.xa*e.S/1E3*1.2731488|0);e&&(d.A=!1);d=!d.A}d&&(c|=J.va.cc);c&=~J.va.rc;this.C&&this.C.ga&He&&(c|=J.va.rc);this.D=c;z(this,a,void 0,b,"FLAGS",c);return c};
l.$d=function(a,b,c){z(this,a,b,c,"BRIGHTNESS");this.V=b};l.ce=function(a,b,c){z(this,a,b,c,"NVR.LATCH");this.I=b};l.be=function(a,b,c){z(this,a,b,c,"DC012");a=b&3;switch(b>>2&3){case 0:this.u=this.u&-4|a;break;case 1:this.u=this.u&-13|a<<2;this.video&&(b=this.video,a=this.u,Ob(b,"updateScrollOffset("+a+")"),b.qa!==a&&((b.qa=a)?vd(b,!0):b.ua=!0));break;case 2:switch(a){case 0:this.N=~this.N;break;case 2:case 3:this.W=3-a}break;case 3:this.U=a}};
l.ae=function(a,b,c){z(this,a,b,c,"DC011");b&J.Ha.jd?(b&=J.Ha.nc,this.G!=b&&(this.G=b,this.video&&(a=this.video,b=this.G==J.Ha.nc?50:60,Ob(a,"updateRate("+b+")"),a.fb=b))):(b&=J.Ha.Vb,this.F!=b&&(this.F=b,this.video&&(a=this.F==J.Ha.Vb?132:80,b=this.video,Ob(b,"updateDimensions("+a+","+(80<a&&this.D&J.va.hc?14:24)+")"),b.N=a,b.ea=b.Ba,80<a&&b.ea--,Ie(b)&&Je(b))))};
var ke={na:1978.1,od:{oa:0,ff:1,lf:16,tf:32,Cf:64,Bf:128,Za:14},La:{oa:1,Oc:1,hd:2,dd:4,ed:16,fd:32,gd:64,Za:8},pd:{oa:2,ef:3,Kf:4,gf:8,xf:16,yf:32,zf:64,hf:128,Za:0},Gf:{oa:3},Ef:{oa:2,uf:7},If:{oa:3,Lf:1,Hf:2,Af:4,rf:8,kf:16,Ae:32},Ff:{oa:4},Jf:{oa:5,mf:1,nf:2,pf:4,qf:8,Mf:16}},J={na:100,va:{oa:66,rc:1,hc:2,cd:4,wf:8,vf:16,jc:32,ic:64,cc:128},Nc:{oa:66,INIT:0},Ha:{oa:194,De:0,Vb:16,jd:32,nc:48,Tc:0,Uc:32},rb:{oa:162,Df:0,Wc:0,Sc:0,Vc:0,Rc:0},ya:{sf:{oa:98},Ga:{Lc:0,Kc:1,ld:2,qd:4,Qc:5,kd:6,md:7},
sb:16383}},ie={SI1978:ke,VT100:J};ke.INIT=[[ke.od.Za,ke.La.Za,ke.pd.Za,0,0,0,0]];
J.INIT=[[J.Nc.INIT,J.va.hc|J.va.cd],[J.Ha.Tc,J.Ha.Uc],[J.rb.Wc,J.rb.Sc,J.rb.Vc,J.rb.Rc],[0,0,0,0,[11904,11904,11904,11904,11904,11904,11904,11904,11904,11904,11904,11904,11904,11904,11904,11904,11904,11904,11904,11904,11904,11904,11904,11904,11904,11904,11904,11904,11904,11904,11904,11904,11904,11904,11904,11904,11904,11904,11904,11776,11784,11918,11776,11984,11888,11776,11808,11776,12E3,12E3,11901,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
[11904,11904,11904,11904,11904,11904,11904,11904,11904,11904,11904,11904,11904,11904,11904,11904,11904,11904,11904,11904,11904,11904,11904,11904,11904,11904,11904,11904,11904,11904,11904,11904,11904,11904,11904,11904,11904,11904,11904,11776,11784,11918,11808,11984,11856,11776,11808,11776,12E3,12E3,11881,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]]];ke.zb={0:he.prototype.Id,1:he.prototype.Jd,2:he.prototype.Kd,3:he.prototype.Hd};
ke.Ab={2:he.prototype.Vd,3:he.prototype.Xd,4:he.prototype.Wd,5:he.prototype.Yd,6:he.prototype.Zd};J.zb={66:he.prototype.Ld};J.Ab={66:he.prototype.$d,98:he.prototype.ce,162:he.prototype.be,194:he.prototype.ae};ab(function(){for(var a=wb(document,"pc8080","chipset"),b=0;b<a.length;b++){var c=a[b],d=xb(c);d=new he(d);vb(d,c)}});
function Ke(a){v.call(this,"ROM",a);this.b=null;this.A=a.addr;this.g=a.size;this.u=a.alias;this.j=a.file;this.B=ra(this.j);if(this.j){a=this.j;var b=sa(this.B);"json"!=b&&"hex"!=b&&(a=Ja()+"/api/v1/dump?file\x3d"+this.j+"\x26format\x3dbytes\x26decimal\x3dtrue");var c=this;Ha(a,null,!0,function(a,b,f){Le(c,a,b,f)})}}ia(Ke,v);Ke.prototype.Da=function(a,b,c,d){this.H=b;this.w=c;this.J=d;Me(this)};
Ke.prototype.ta=function(){if(this.pa){if(this.J){var a=this.J,b=this.id,c=this.A,d=this.g,e=this.pa,f=[],g;for(g in e){var h=e[g];"number"==typeof h&&(e[g]=h={o:h});var k=h.o,n=h.a;if(void 0!==k){var t=f;k=[k>>>0,g];var x=Ca(t,k,a.zc);0>x&&t.splice(-(x+1),0,k)}n&&(h.a=n.replace(/''/g,'"'))}a.C.push({Pf:b,K:c,Pd:d,pa:e,xc:f})}delete this.pa}return!0};Ke.prototype.sa=function(){return!0};
function Le(a,b,c,d){if(d)a.Z("Unable to load system ROM (error "+d+": "+b+")");else{pb(a.Pa,b,c);if("["==c.charAt(0)||"{"==c.charAt(0))try{var e=eval("("+c+")"),f=e.bytes,g=e.longs||e.data;if(f)a.b=f;else if(g)for(a.b=Array(4*g.length),d=c=0;c<g.length;c++)a.b[d++]=g[c]&255,a.b[d++]=g[c]>>8&255,a.b[d++]=g[c]>>16&255,a.b[d++]=g[c]>>24&255;else a.b=e;a.pa=e.symbols;if(!a.b.length){r("Empty ROM: "+b);return}if(1==a.b.length){r(a.b[0]);return}}catch(h){a.Z("ROM data error: "+h.message);return}else for(b=
c.replace(/\n/gm," ").replace(/ +$/,"").split(" "),a.b=Array(b.length),e=0;e<b.length;e++)a.b[e]=na(b[e],16);Me(a)}}
function Me(a){if(!Jb(a))if(!a.j)Kb(a);else if(a.b&&a.H){a.g||(a.g=a.b.length);if(a.b.length!=a.g)Ib(a,"ROM size ("+p(a.b.length,8,!0)+") does not match specified size ("+p(a.g,8,!0)+")");else{var b=a.A;if($b(a.H,b,a.g,Gc)){var c;for(c=0;c<a.b.length;c++)hc(a.H,b+c,a.b[c]);b=!0}else b=!1;if(b){b=[];"number"==typeof a.u?b.push(a.u):null!=a.u&&a.u.length&&(b=a.u);for(c=0;c<b.length;c++){for(var d=a,e=b[c],f=d.H,g=d.g,h=[],k=d.A>>>f.g;0<g&&k<f.b.length;)h.push(f.b[k++]),g-=f.u;f=d.H;d=d.g;g=0;for(e>>>=
f.g;0<d&&e<f.b.length;){k=h[g++];if(!k)break;f.b[e++]=k;d-=f.u}}delete a.b}}Kb(a)}}ab(function(){for(var a=wb(document,"pc8080","rom"),b=0;b<a.length;b++){var c=a[b],d=xb(c);d=new Ke(d);vb(d,c)}});
function Ne(a){v.call(this,"RAM",a);this.pa=this.g=null;this.u=a.addr;this.A=a.size;this.Na=a.load;this.Fa=a.exec;this.j=!1;this.b=a.file;this.B=ra(this.b);if(this.b){a=this.b;var b=sa(this.B);"json"!=b&&"hex"!=b&&(a=Ja()+"/api/v1/dump?file\x3d"+this.b+"\x26format\x3dbytes\x26decimal\x3dtrue");var c=this;Ha(a,null,!0,function(a,b,f){f?c.Z("Unable to load RAM resource (error "+f+": "+a+")"):(pb(c.Pa,a,b),(a=Ka(a,b))?(c.g=a.ka,c.pa=a.pa,null==c.Na&&(c.Na=a.Na),null==c.Fa&&(c.Fa=a.Fa)):c.b=null,Oe(c))})}}
ia(Ne,v);Ne.prototype.Da=function(a,b,c,d){this.H=b;this.w=c;this.J=d;Oe(this)};Ne.prototype.ta=function(){return!0};Ne.prototype.sa=function(){return!0};
function Oe(a){!a.j&&a.A&&$b(a.H,a.u,a.A,1)&&(a.j=!0);if(!Jb(a)){if(!a.j)r("No RAM allocated");else if(a.b){if(!a.g||!a.H)return;var b=a.u;null!==a.Na&&(b=a.Na);for(var c=0;c<a.g.length;c++)hc(a.H,b+c,a.g[c]);if(null!==a.Fa){if(a.Fa==Pe){for(c=0;c<Qe.length;c++)hc(a.H,Qe[c],118);zd(a.w,function(a){return function(b){if(0<=Qe.indexOf(b)){var c=!1,d=a.w,e=a.J;if(b==Re)switch(c=!0,d.A){case Se:a.print(String.fromCharCode(d.C).replace(/\r/g,""));break;case Te:for(var k=Gd(d),n="",t=255;t--;){var x=E(a.w,
k++);if(36==x)break;n+=String.fromCharCode(x)}a.print(n.replace(/\r/g,""));break;default:c=!1}c?fe.call(d):e&&(a.i("\nCP/M vector "+q(b)),B(d,b),Rc(e));b=!0}else b=!1;return b}}(a))}Bd(a.w,a.Fa)}delete a.g}Kb(a)}}Ne.prototype.reset=function(){};var Re=5,Se=2,Te=9,Pe=256,Qe=[0,Re];ab(function(){for(var a=wb(document,"pc8080","ram"),b=0;b<a.length;b++){var c=a[b],d=xb(c);d=new Ne(d);vb(d,c)}});
function Ue(a){v.call(this,"Keyboard",a,65536);(a=a.model)&&!Ve[a]&&gb("Unrecognized Keyboard8080 model: "+a);this.b=Ve[a]||{};this.reset();Kb(this)}ia(Ue,v);l=Ue.prototype;
l.ca=function(a,b,c){var d=this,e=a+"-"+b;if(void 0===this.O[e]){if("led"==a&&this.b.$a[b])return this.O[e]=c,!0;switch(b){case "kbd":case "screen":return Ta("iOS")?(c.onkeypress=function(a){var b=!1;if(a=d.b.pb[a.keyCode||a.charCode]){a&128&&(a&=127,b=!0);a:{for(c in d.b.Qa)if(d.b.Qa[c]==a){var c=+c;break a}c=0}c&&(b?We(d,16,!0,!0):We(d,16,!1),We(d,c,!0,!0))}return!0},c.onkeydown=function(a){return Xe(d,a,!0)},c.onkeyup=function(a){return Xe(d,a,!1)}):(c.onkeydown=function(a){return Ye(d,a,!0)},
c.onkeyup=function(a){return Ye(d,a,!1)},c.onkeypress=function(a){a=a.keyCode||a.charCode;a>=m.Ya&&a<=m.tb?d.g&(Ze|$e)||(d.g|=$e,We(d,20,!0),af(d)):a>=m.vb&&a<=m.z&&d.g&$e&&(d.g&=~$e,We(d,20,!1),af(d));return!0}),c.onpaste=function(a){a:{if(d.C&&d.C.Oa&&(a.stopPropagation&&a.stopPropagation(),a.preventDefault&&a.preventDefault(),a=a.clipboardData||window.clipboardData)){bf(d.C,a.getData("Text"));a=!1;break a}a=!0}return a},!0;default:if(this.b.Sa&&void 0!==this.b.Sa[b])return this.O[e]=c,c.onclick=
function(a,b){return function(d){d.preventDefault&&d.preventDefault();d=!0;var e=0;17==b?e=cf:20==b&&(e=$e);if(e){c.style.fontWeight="normal";if(d=!(a.g&e))c.style.fontWeight="bold";df(a,b,d)}We(a,b,d,!e);a.P&&a.P.Wa()}}(this,this.b.Sa[b]),!0}}return!1};l.Da=function(a,b,c,d){this.P=a;this.w=c;this.J=d;var e=this;this.I=qd(this.w,this.id,function(){ef(e)});this.V=Wb(a,"ChipSet");this.C=Wb(a,"SerialPort");lc(b,this,this.b.zb);yc(b,this,this.b.Ab)};
l.ta=function(a,b){if(!b)if(!a)this.reset();else if(!this.restore(a))return!1;return!0};l.sa=function(a){return a?this.save():!0};l.reset=function(){this.j=[];this.g=0;this.b.INIT&&!this.restore(this.b.INIT)&&this.Z("reset error")};l.save=function(){var a=new Dd(this);switch(this.b.na){case K.na:a.set(0,[this.D,this.B,this.A,this.F,-1])}return a.data()};
l.restore=function(a){var b;if(a&&(b=a[0])&&b.length)switch(this.b.na){case ff.na:return!0;case K.na:return this.D=b[0],af(this,this.D&K.za.dc),this.B=b[1],this.A=b[2],this.F=b[3],this.u=b[4],!0}return!1};function af(a,b){null!=b?a.G=b:b=a.G;for(var c in a.b.$a){var d="led-"+c;if(d=a.O[d]){var e=a.b.$a[c],f=!!(b&e);e&e-1&&(f=!(b&~e));d.style.backgroundColor=f?"#"+p(16711680,6):"#000000"}}if(d=a.O["led-caps-lock"])d.style.backgroundColor=a.g&$e?"#"+p(65280,6):"#000000"}
function df(a,b,c,d){var e=0;switch(b){case 16:e=d?gf:hf;break;case 17:e=d?jf:cf;break;case 18:e=d?kf:lf;break;case 91:e=d?mf:nf;break;case 20:e=$e,c=!(a.g&e)}e&&(a.g=c?a.g|e:a.g&~e);return c}
function Ye(a,b,c){var d=!0,e=b.keyCode;e=ma[e]||e;c=df(a,e,c,2==b.location);a:if(e=a.b.Sb[e]||e,a.b.Qa[e])var f=e;else{for(f in a.b.Sa)if(a.b.Sa[f]===e)break a;f=null}f&&!b.metaKey&&(d=!1,a.g&(of|pf)&&(13==f?(f=118,d=!0):8==f&&(f=46,d=!0),d&&(a.g=c?a.g|pf:a.g&~pf)),d=We(a,f,c),(!(f>=m.Ya&&f<=m.tb)||a.g|qf)&&b.preventDefault&&b.preventDefault());return d}
function Xe(a,b,c){var d=!0;if(c){var e=b.keyCode,f=a.b.Qa[e],g;if(g=f){a:{for(var h in a.b.pb)if(a.b.pb[h]==f){f=+h;break a}f=0}g=!f}g&&(d=We(a,e,c,!0),b.preventDefault&&b.preventDefault())}return d}
function We(a,b,c,d){var e;a:{for(e=0;e<a.j.length;e++)if(a.j[e].Nb==b)break a;e=-1}if(c)0>e?a.j.push({Nb:b,Kb:Date.now(),wb:d||!1}):(a.j[e].Kb=Date.now(),a.j[e].wb=d||!1),d&&ef(a);else if(0<=e){if(!a.j[e].wb&&(d=a.j[e].Kb)&&Date.now()-d<rf)return a.j[e].wb=!0,ef(a),!0;a.j.splice(e,1)}if(a.V){d=0;switch(b){case "1p":d=ke.La.dd;break;case "2p":d=ke.La.hd;break;case "coin":d=ke.La.Oc;break;case "left":d=ke.La.fd;break;case "right":d=ke.La.gd;break;case "fire":d=ke.La.ed}d&&(a=a.V,b=d,a.A&=~b,c&&(a.A|=
b))}return!0}function ef(a){for(var b=0,c=-1;b<a.j.length;){if(a.j[b].wb){var d=a.j[b].Nb,e=rf-(Date.now()-a.j[b].Kb);if(0<e){if(0>c||c>e)c=e}else{We(a,d,!1);b=0;continue}}b++}0<=c&&rd(a.w,a.I,c)}l.Md=function(a,b){var c=this.B;0<=this.u&&(this.u<this.j.length?(c=this.j[this.u],this.u++,c=K.Qa[c.Nb],c&128&&(c&=127)):(this.u=-1,c=K.Xc),this.B=c,ae(this.w,1));z(this,a,void 0,b,"KBDUART.ADDRESS",c);return c};
l.de=function(a,b,c){z(this,a,b,c,"KBDUART.STATUS");this.D=b;this.A=!0;this.F=ad(this.w);af(this,b&K.za.dc);b&K.za.nd&&(this.u=0,ae(this.w,1))};var gf=1,hf=2,Ze=3,jf=4,cf=8,qf=12,kf=16,lf=32,of=48,mf=64,nf=128,$e=512,pf=4096,rf=50,sf={};sf[m.Ya]=37;sf[m.Cb]=39;sf[m.Eb]=32;
var ff={na:1978.1,Qa:{},pb:{},Sb:sf,$a:{},Sa:{"1p":49,"2p":50,coin:51,left:37,right:39,fire:32}},L={},M={},K={na:100,Qa:(L[8]=3,L[m.lc]=5,L[m.kc]=6,L[m.wc]=7,L[m.pc]=8,L[m.tc]=9,L[m.Q]=10,L[39]=16,L[221]=20,L[219]=21,L[m.$b]=22,L[m.qc]=23,L[m.mc]=24,L[m.E]=25,L[49]=26,L[37]=32,L[40]=34,L[117]=35,L[19]=35,L[192]=36,L[189]=37,L[57]=38,L[55]=39,L[52]=40,L[51]=41,L[27]=42,L[38]=48,L[114]=49,L[112]=50,L[46]=51,L[187]=52,L[48]=53,L[56]=54,L[54]=55,L[53]=56,L[50]=57,L[9]=58,L[103]=64,L[115]=65,L[113]=66,
L[96]=67,L[118]=68,L[220]=69,L[m.Eb]=70,L[m.bc]=71,L[m.Yb]=72,L[m.Xb]=73,L[m.Ya]=74,L[104]=80,L[2013]=81,L[98]=82,L[97]=83,L[222]=85,L[186]=86,L[m.ac]=87,L[m.Zb]=88,L[m.Cb]=89,L[m.oc]=90,L[110]=96,L[116]=97,L[101]=98,L[100]=99,L[13]=100,L[190]=101,L[188]=102,L[m.gc]=103,L[m.Tb]=104,L[m.vc]=105,L[119]=106,L[105]=112,L[99]=113,L[102]=114,L[109]=115,L[191]=117,L[m.fc]=118,L[m[" "]]=119,L[m.sc]=120,L[m.Ub]=121,L[m.tb]=122,L[120]=123,L[17]=124,L[16]=125,L[20]=126,L),pb:(M[m.p]=5,M[m.Rd]=6,M[m.y]=7,M[m.t]=
8,M[m.re]=9,M[m.q]=10,M[m["]"]]=20,M[m["["]]=21,M[m.Ed]=22,M[m.pe]=23,M[m.r]=24,M[m.e]=25,M[m["1"]]=26,M[m["`"]]=36,M[m["-"]]=37,M[m["9"]]=38,M[m["7"]]=39,M[m["4"]]=40,M[m["3"]]=41,M[m["\x3d"]]=52,M[m["0"]]=53,M[m["8"]]=54,M[m["6"]]=55,M[m["5"]]=56,M[m["2"]]=57,M[m["\\"]]=69,M[m.Od]=70,M[m.k]=71,M[m.Ad]=72,M[m.yd]=73,M[m.vb]=74,M[m["'"]]=85,M[m[";"]]=86,M[m.Nd]=87,M[m.Cd]=88,M[m.d]=89,M[m.ne]=90,M[13]=100,M[m["."]]=101,M[m[","]]=102,M[m.n]=103,M[m.sd]=104,M[m.x]=105,M[m["/"]]=117,M[m.Qd]=118,M[m.qe]=
120,M[m.ud]=121,M[m.z]=122,M[m.lc]=133,M[m.kc]=134,M[m.wc]=135,M[m.pc]=136,M[m.tc]=137,M[m.Q]=138,M[m["}"]]=148,M[m["{"]]=149,M[m.$b]=150,M[m.qc]=151,M[m.mc]=152,M[m.E]=153,M[m["!"]]=154,M[m["~"]]=164,M[m._]=165,M[m["("]]=166,M[m["\x26"]]=167,M[m.$]=168,M[m["#"]]=169,M[m["+"]]=180,M[m[")"]]=181,M[m["*"]]=182,M[m["^"]]=183,M[m["%"]]=184,M[m["@"]]=185,M[m["|"]]=197,M[m.Eb]=198,M[m.bc]=199,M[m.Yb]=200,M[m.Xb]=201,M[m.Ya]=202,M[m['"']]=213,M[m[":"]]=214,M[m.ac]=215,M[m.Zb]=216,M[m.Cb]=217,M[m.oc]=218,
M[m["\x3e"]]=229,M[m["\x3c"]]=230,M[m.gc]=231,M[m.Tb]=232,M[m.vc]=233,M[m["?"]]=245,M[m.fc]=246,M[m.sc]=248,M[m.Ub]=249,M[m.tb]=250,M),Sb:{},$a:{},Sa:{"caps-lock":20,ctrl:17,esc:27,tab:9,"num-comma":116,"break":117,"line-feed":118,"no-scroll":119,setup:120},Mc:{oa:130,INIT:127},za:{oa:130,ad:1,$c:2,Zc:4,Yc:8,bd:16,ec:32,dc:63,nd:64,Ce:128,INIT:0},Xc:127};K.$a={l4:K.za.ad,l3:K.za.$c,l2:K.za.Zc,l1:K.za.Yc,locked:K.za.bd,local:K.za.ec,online:~K.za.ec,"caps-lock":$e};var Ve={SI1978:ff,VT100:K};
K.INIT=[[K.za.INIT,K.Mc.INIT,!1,0,-1]];K.zb={130:Ue.prototype.Md};K.Ab={130:Ue.prototype.de};ab(function(){for(var a=wb(document,"pc8080","keyboard"),b=0;b<a.length;b++){var c=a[b],d=xb(c);d=new Ue(d);vb(d,c)}});
function tf(a,b,c,d,e){v.call(this,"Video",a,262144);var f=this;this.Ra=Ta("Gecko/");this.L=a.screenWidth;this.G=a.screenHeight;this.ja=a.bufferAddr;this.xd=a.bufferRAM;var g=a.bufferFormat;this.X=g&&uf[g.toUpperCase()]||vf;this.N=a.bufferCols;this.Y=a.bufferRows;this.Ba=this.ea=a.cellWidth||1;this.ba=a.cellHeight||1;this.aa=null;this.Ka=!1;this.la=a.bufferBits||1;this.zd=a.bufferLeft||0;if(this.g=a.bufferRotate)this.g=this.g%360,0<this.g&&(this.g-=360),-90!=this.g&&(this.Z("unsupported buffer rotation: "+
this.g),this.g=0);this.ma=a.interruptRate;this.ub=a.refreshRate||60;this.F=b;this.j=c;this.U=(this.Dd=d)||b||null;this.td=this.L;this.vd=this.G;this.Ia=this.L/this.N|0;this.Ja=this.G/this.Y|0;1<this.ba&&(this.Y++,this.qa=0,this.ua=!1);b=a.smoothing;(c=Wa("smoothing"))&&(b="true"==c);this.Ta=b;this.ob=Ua(this.j,"imageSmoothingEnabled");if(this.u=a.screenRotate)this.u=this.u%360,0<this.u&&(this.u-=360),-90!=this.u?(this.Z("unsupported screen rotation: "+this.u),this.u=0):(this.j.translate(0,this.G),
this.j.rotate(this.u*Math.PI/180),this.j.scale(this.G/this.L,this.L/this.G));if(this.b=e)if(b=Ua(e,"requestFullscreen")||Ua(e,"requestFullScreen")){this.b.ib=e[b];if(e=Ua(document,"on","fullscreenchange")){var h=Ua(document,"fullscreenElement")||Ua(document,"fullScreenElement");document.addEventListener(e,function(){wf(f,null!=document[h])},!1)}(e=Ua(document,"on","fullscreenerror"))&&document.addEventListener(e,function(){wf(f)},!1)}if(this.R=a.fontROM)"json"!=sa(this.R)&&(this.R=Ja()+"/api/v1/dump?file\x3d"+
this.R+"\x26format\x3dbytes"),Ha(this.R,null,!0,function(a,b,c){xf(f,a,b,c)});this.xa={}}ia(tf,v);
function Ie(a){a.C=a.N*a.ea;a.M=a.Y*a.ba;var b=a.C,c=a.M;a.g&&(b=a.M,c=a.C);a.I=0;if(!a.xd&&(a.I=(a.C*a.la>>3)*a.M,!$b(a.H,a.ja,a.I,3)))return!1;a.I?(a.ab=a.j.createImageData(b,c),a.cb=16/a.la|0,yf(a,a.I>>1)):yf(a,(a.N+1)*a.Y);a.D=document.createElement("canvas");a.D.width=b;a.D.height=c;a.ra=a.D.getContext("2d");a.S={};a.W=1<<a.la;a.T=Array(a.W+zf);a.T[0]=[0,0,0,255];a.T[1]=[255,255,255,255];a.X==Af&&(a.T[a.W+Bf]=[255,255,0,255],a.T[a.W+Cf]=[0,255,0,255]);a.X==Df&&(a.fb=60,a.wa=!1,a.da=Array(a.N));
a.ob&&(a.j[a.ob]=null==a.Ta?!1:a.Ta);return!0}l=tf.prototype;l.ca=function(a,b,c){var d=this;if("led"==a||"rled"==a)return this.xa[b]=c,!0;switch(b){case "fullScreen":return this.O[b]=c,this.b&&this.b.ib?c.onclick=function(){d.ib()}:c.parentNode.removeChild(c),!0}return!1};
l.Da=function(a,b,c,d){this.P=a;this.H=b;this.w=c;this.J=d;Ie(this);if(this.B=Wb(a,"Keyboard")){for(var e in this.xa)this.B.ca("led",e,this.xa[e]);this.F&&this.B.ca(this.Dd?"textarea":"canvas","screen",this.U)}var f=this;this.yc=qd(this.w,this.id,function(){vd(f)});rd(this.w,this.yc,1E3/Math.max(this.ub,this.ma));this.eb=0;this.R||Kb(this)};
function xf(a,b,c,d){if(d)a.Z("Unable to load font ROM (error "+d+": "+b+")");else{pb(a.Pa,b,c);try{var e=eval("("+c+")"),f=e.bytes||e;if(!f||!f.length){r("Empty font ROM: "+b);return}if(1==f.length){r(f[0]);return}if(2048==f.length)a.aa=f,Je(a);else{a.Z("Unrecognized font data length ("+f.length+")");return}}catch(g){a.Z("Font ROM data error: "+g.message);return}(a.j||a.J)&&Kb(a)}}
function Je(a){a.aa&&(a.Ka=a.X==Df,a.S[Ef]=[Ff(a,a.ea,a.ba),Ff(a,a.ea,a.ba,a.wa)],a.S[Gf]=[Ff(a,2*a.ea,a.ba),Ff(a,2*a.ea,a.ba,a.wa)],a.S[Hf]=a.S[If]=[Ff(a,2*a.ea,2*a.ba),Ff(a,2*a.ea,2*a.ba,a.wa)])}
function Ff(a,b,c,d){var e=8>=a.Ba?8:16,f=8<e?15:0,g=a.aa.length/e,h=!1===d,k={ea:b,ba:c};k.canvas=document.createElement("canvas");k.canvas.width=16*b;k.canvas.height=g/16*c;k.context=k.canvas.getContext("2d");for(var n=k.context.createImageData(b,c),t=0;t<g;t++){for(var x=0,y=x;x<a.ba;x++){var u=t*e+(f+x&e-1);u=d&&8==x?255:a.aa[u];for(var w=0;w<c/a.ba;w++){for(var D=0,T=0,Na=T;T<a.ea;T++){var P=u&128>>(7<T?7:T);D=a.Ka&&!P&&D?D:P;for(var ob=0;ob<b/a.ea;ob++)h&&(D=!D),Jf(a,n,Na,y,D?1:0),Na++;D=P}y++}}k.context.putImageData(n,
(t&15)*b,(t>>4)*c)}return k}l.ta=function(a,b){return b||!a||this.restore(a)?!0:!1};l.sa=function(a){return!a||this.save()};l.save=function(){var a=new Dd(this);a.set(0,[]);return a.data()};l.restore=function(){return!0};
l.ib=function(){var a=!1;if(this.b){if(this.b.ib){a="100%";if(screen&&screen.width&&screen.height){var b=screen.width/screen.height,c=this.L/this.G;b>c&&(a=Math.round(c/b*100)+"%")}this.Ra?(this.F.style.width=a,this.F.style.width=a,this.F.style.display="block",this.F.style.margin="auto"):(this.b.style.width=a,this.b.style.height="auto");this.b.style.backgroundColor="black";this.b.ib();a=!0}this.U&&this.U.focus()}return a};
function wf(a,b){!b&&a.b&&(a.Ra?a.F.style.width=a.F.style.height="":a.b.style.width=a.b.style.height="");Ob(a,"notifyFullScreen("+b+")")}function yf(a,b){a.bb=b;a.V=!1;if(void 0===a.A||a.A.length!=a.bb)a.A=Array(a.bb)}function Jf(a,b,c,d,e){d=a.g?(b.height-c-1)*b.width+d:c+d*b.width;e&&a.X==Af&&(208<=c&&236>c?e=a.W+Bf:28<=c&&72>c&&(e=a.W+Cf));a=a.T[e];d*=a.length;b.data[d]=a[0];b.data[d+1]=a[1];b.data[d+2]=a[2];b.data[d+3]=a[3]}
function vd(a,b){var c=!0;if(!b){a.ma&&(120==a.ma?a.eb&1?(ae(a.w,2),c=!1):ae(a.w,1):ae(a.w,4));if(c&&a.V&&a.I){var d=a.H,e=a.ja,f=a.I,g=!0,h=e>>>d.g;for(e=d.u-(e&d.j);0<f&&h<d.b.length;)d.b[h].Ca&&(d.b[h].Ca=g=!1,d.b[h].Cc=!0),f-=e,e=d.u,h++;g&&(c=!1)}rd(a.w,a.yc,1E3/Math.max(a.ub,a.ma));a.eb++}if(c)if(1<a.ea)switch(a.X){case Df:c=a.ja;d=-1;f=0;g=60==a.fb?2:5;e=h=0;for(var k=-1;f<a.Y;){var n=0,t=c,x=d,y=a.N;for(x!=Ef&&(y>>=1);;){var u=ec(a.H,t++);if((u&Kf)==Kf){var w=ec(a.H,t++);d=w&Lf;c=(w&Mf)<<
8|ec(a.H,t);c+=w&Nf?Of:Pf;break}if(n<y)a.da[n++]=u;else break}if(g)g--;else{for(;n<a.da.length;)a.da[n++]=0;if(0<=x)for(t=a.V&&a.A[h]==y,a.A[h++]=y,y=0;y<n;y++){u=a.da[y];if(!t||u!==a.A[h]){a.A[k=h]=u;w=a;var D=a.ra;var T=u&127;if(u=w.S[x][u&128?1:0]){var Na=(T&15)*u.ea,P=(T>>4)*u.ba,ob=u.ea,Oa=u.ba;if(D){var za=y*w.ea;var pa=f*w.ba;var ua=w.ea;T=w.ba}else za=y*w.Ia,pa=f*w.Ja,ua=w.Ia,T=w.Ja;u.ea>w.ea&&(za*=2,ua*=2);u.ba>w.ba&&(x==If&&(P+=w.ba),Oa=w.ba);D?D.drawImage(u.canvas,Na,P,ob,Oa,za,pa,ua,T):
w.j.drawImage(u.canvas,Na,P,ob,Oa,za,pa,ua,T)}e++}h++}f++}}a.V=!0;!b&&a.ua&&1==e&&(a.A[k]=-1,e=0);a.ua=!1;(e||b)&&a.ra&&a.j.drawImage(a.D,0,a.qa,a.C,a.M-a.ba,0,0,a.td,a.vd)}else{f=a.ja;g=f+a.I;k=e=h=0;b=a.C;n=0;c=a.M;x=d=0;t=a.la;y=(1<<t)-1;a.zd&&(t=-t,x=16+t);for(;f<g;){w=gc(a.H,f);if(a.V&&w===a.A[h])e+=a.cb;else{a.A[h]=w;(D=x)&&(w=w>>8|(w&255)<<8);e<b&&(b=e);for(u=a.cb;u--;)Na=w>>D&y,Jf(a,a.ab,e++,k,Na),D+=t;e>n&&(n=e);k<c&&(c=k);k>=d&&(d=k+1)}f+=2;h++;if(e>=a.C&&(e=0,k++,k>a.M))break}a.V=!0;b<
a.C&&(f=n-b,d-=c,a.g&&(g=b,h=f,b=c,f=d,c=a.C-(g+h),d=h),a.ra.putImageData(a.ab,0,0,b,c,f,d),a.j.drawImage(a.D,0,0,a.D.width,a.D.height,0,0,a.L,a.G))}}var Bf=0,Cf=1,zf=2,vf=0,Af=1,Df=2,uf={SI1978:Af,VT100:Df},Ef=96,Gf=64,Hf=32,If=0,Kf=127,Mf=15,Nf=16,Lf=96,Of=8192,Pf=16384;
ab(function(){for(var a=wb(document,"pc8080","video"),b=0;b<a.length;b++){var c=a[b],d=xb(c),e=wb(c,"pcjs-canvas");if(!e||!e.length||!e[0].getContext){c.innerHTML="\x3cbr/\x3eMissing \x26lt;canvas\x26gt; support. Please try a newer web browser.";break}e=e[0];e.style.backgroundColor=d.screenColor;0<=La().indexOf("MSIE")&&(c.onresize=function(a,b,c,d){return function(){b.style.height=(a.clientWidth*d/c|0)+"px"}}(c,e,d.screenWidth,d.screenHeight),c.onresize());var f=+(d.aspect||Wa("aspect"));f&&.3<=
f&&3.33>=f&&($a("onresize",function(a,b,c){return function(){b.style.height=(a.clientWidth/c|0)+"px"}}(c,e,f)),window.onresize());f=document.createElement("textarea");Ta("iOS")&&(f.setAttribute("autocapitalize","off"),f.setAttribute("autocorrect","off"),f.style.fontSize="16px");c.appendChild(f);var g=e.getContext("2d");d=new tf(d,e,g,f,c);vb(d,c)}});
function Qf(a){v.call(this,"SerialPort",a,8388608);this.S=+a.adapter;switch(this.S){case 0:this.T=0;this.W=2;break;default:r("Unrecognized serial adapter #"+this.S);return}this.g=this.j=null;this.U=a.tabSize;this.R=a.charBOL;this.u=0;this.M=!1;this.D=!0;a=a.binding;if("console"==a)this.j="";else if(a){var b=Ab("Panel",this.id);b&&(b=b.O[a])&&this.ca("",a,b)}this.A="";this.b=this.Oa=this.G=null;this.exports={connect:this.Ec,receiveData:this.Mb,receiveStatus:this.me}}ia(Qf,v);l=Qf.prototype;
l.ca=function(a,b,c,d){var e=this;return a&&"textarea"!=a?d?(this.O[b]=c,c.onclick=function(){e.Mb(d);return!0},!0):!1:(this.O[b]=this.g=c,c.onkeydown=function(a){a=a||window.event;var b=a.keyCode;if(8===b||a.ctrlKey&&65<=b&&90>=b)a.preventDefault&&a.preventDefault(),64<b&&(b-=64),Rf(e,b);return!0},c.onkeypress=function(a){a=a||window.event;Rf(e,a.which||a.keyCode);a.preventDefault&&a.preventDefault();return!0},c.removeAttribute("readonly"),!0)};
l.Da=function(a,b,c,d){this.P=a;this.H=b;this.w=c;this.J=d;var e=this;this.X=qd(this.w,this.id+".receive",function(){e.Mb()});this.Y=qd(this.w,this.id+".transmit",function(){bf(e)});this.V=Wb(a,"ChipSet");lc(b,this,Sf,this.T);yc(b,this,Tf,this.T);Kb(this)};
l.Ec=function(a){if(!this.b){var b=Uc(this.P,"connection");if(b){var c=b.split("-\x3e");if(2==c.length){var d=ya(c[0]);if(d!=this.Fb)return;c=ya(c[1]);if(this.b=zb(c)){var e=this.b.exports;if(e){var f=e.connect;f&&f.call(this.b,this.D);if(this.Oa=e.receiveData){this.D=a;this.G=e.receiveStatus;this.status("Connected "+this.Pa+"."+d+" to "+c);return}}}}this.status("Unable to establish connection: "+b)}}};
l.ta=function(a,b){if(!b)if(this.Ec(this.D),!a||!this.restore)this.reset();else if(!this.restore(a))return!1;return!0};l.sa=function(a){return a?this.save():!0};l.reset=function(){Uf(this)};l.save=function(){var a=new Dd(this),b=0,c=[];c[b++]=this.F;c[b++]=this.L;c[b++]=this.N;c[b++]=this.ga;c[b++]=this.B;c[b++]=this.C;c[b]=this.I;a.set(0,c);return a.data()};l.restore=function(a){return Uf(this,a[0])};
function Uf(a,b){var c=0;void 0===b&&(b=Vf);a.F=b[c++];a.L=b[c++];a.N=b[c++];a.ga=b[c++];a.B=b[c++];a.C=b[c++];a.I=b[c];return!0}function Wf(a,b){var c=a.I&b;b&15||(c>>=4);b=Xf[c];c=((a.B&Yf)>>2)+6;a.B&Zf&&c++;c+=((a.B&$f)>>6)+1>>1;return 1E3/(b/c)|0}function Rf(a,b){Ob(a,"receiveByte("+qa(b)+"), status\x3d"+qa(a.ga));return a.M||a.ga&ag?!1:(a.L=b,a.ga|=ag,ae(a.w,a.W),!0)}
l.Mb=function(a){null!=a&&(this.A="number"!=typeof a?a:this.A+String.fromCharCode(a));this.A&&(Rf(this,this.A.charCodeAt(0))&&(this.A=this.A.substr(1)),this.A&&this.w&&rd(this.w,this.X,Wf(this,bg)));return!0};l.me=function(a){this.ga&=~cg;a&64&&(this.ga|=cg)};function bf(a,b){a.ga=a.ga|He|dg;b&&a.Oa&&a.Oa.call(a.b,b)}l.Gd=function(a,b){var c=this.L;z(this,a,void 0,b,"DATA",c);this.ga&=~ag;return c};l.Fd=function(a,b){var c=this.ga;z(this,a,void 0,b,"STATUS",c);return c};
l.Ud=function(a,b,c){z(this,a,b,c,"DATA");this.N=b;this.ga&=~(He|dg);Ob(this,"transmitByte("+qa(b)+")");if(19==b)this.M=!0;else if(17==b)this.M=!1;else if(this.Oa&&this.Oa.call(this.b,b),this.g)if(8==b)this.g.value=this.g.value.slice(0,-1),0<this.u&&this.u--;else{var d;13!=b&&10!=b&&(d=Aa[b]);a=d=d?"\x3c"+d+"\x3e":String.fromCharCode(b);c=a.length;9==b?(b=this.U||8,c=b-this.u%b,this.U&&(a=xa("",c))):13==b&&(this.u=c=0,a="\n");this.R&&!this.u&&c&&(a=String.fromCharCode(this.R)+a);this.g.value+=a;this.g.scrollTop=
this.g.scrollHeight;this.u+=c}else if(null!=this.j){if(10==b||1024<=this.j.length)this.i(this.j),this.j="";10!=b&&(this.j+=String.fromCharCode(b))}this.w&&rd(this.w,this.Y,Wf(this,eg))};l.Td=function(a,b,c){z(this,a,b,c,"CONTROL");this.F?(this.G&&(b^this.C)&(fg|gg)&&(a=0,this.D?(a|=b&fg?32:0,a|=b&gg?320:0):(a|=b&fg?16:0,a|=b&gg?1048576:0),this.G.call(this.b,a)),this.C=b,this.C&hg&&(this.F=!1)):(this.B=b,this.F=!0)};l.Sd=function(a,b,c){z(this,a,b,c,"BAUDRATES");this.I=b};
var Yf=12,Zf=16,$f=192,gg=2,fg=32,hg=64,He=1,ag=2,dg=4,cg=128,bg=15,eg=240,Xf=[50,75,110,134.5,150,200,300,600,1200,1800,2E3,2400,3600,4800,9600,19200],Vf=[!1,0,0,133,142,39,238],Sf={0:Qf.prototype.Gd,1:Qf.prototype.Fd},Tf={0:Qf.prototype.Ud,1:Qf.prototype.Td,2:Qf.prototype.Sd};ab(function(){for(var a=wb(document,"pc8080","serial"),b=0;b<a.length;b++){var c=a[b],d=xb(c);d=new Qf(d);vb(d,c)}});
function ig(a){v.call(this,"Debugger",a);this.u=+a.base||16;this.V=["{","}"];this.da=["[","]"];this.S=this.aa=this.F=0;this.N=!1;this.b=-1;this.g=[];this.A={}}ia(ig,v);ig.prototype.Ib=function(){return-1};ig.prototype.Jb=function(){};
ig.prototype.yb=function(a,b,c){if(b)if(a){0>this.b&&this.g.length&&(this.b=0);if(0>this.b||a!=this.g[this.b])this.g.splice(0,0,a),this.b=0;this.b--}else this.N?a="end":a=this.g[this.b+1];b=[];if(a){a=a.replace(/""/g,"'");var d=0,e=null;c=c||";";for(var f=0;f<=a.length;f++){var g=a.charAt(f);if('"'==g||"'"==g)e?g==e&&(e=null):e=g;else if(g==c&&!e||!g)b.push(ya(a.substring(d,f))),d=f+1}}return b};
function jg(a,b,c){var d=a;b=b||32;if(c)if(32==b)d=a>>>0;else if(32>b)d=a&(1<<b)-1;else{if(b=Math.pow(2,b),0>a||a>=b)d=a%b,0>d&&(d+=b)}else 32>=b?d=a<<32-b>>32-b:(b=Math.pow(2,b-1),a>=b?(d=a%b,(a/b|0)&1&&(d-=b)):a<-b&&(d=a%b,((-a-1)/b|0)&1?d&&(d+=b):d||(d-=b)));a!=d&&(a=d);return a}
function kg(a,b,c){for(c=void 0===c?-1:c;c--&&b.length;){var d=b.pop();if(2>a.length)return!1;var e=a.pop();var f=a.pop();switch(d){case "*":f*=e;break;case "/":if(!e)return!1;f=Math.trunc(f/e);break;case "^/":if(!e)return!1;f%=e;break;case "+":f+=e;break;case "-":f-=e;break;case "\x3c\x3c":f<<=e;break;case "\x3e\x3e":f>>=e;break;case "\x3e\x3e\x3e":f>>>=e;break;case "\x3c":f=f<e?1:0;break;case "\x3c\x3d":f=f<=e?1:0;break;case "\x3e":f=f>e?1:0;break;case "\x3e\x3d":f=f>=e?1:0;break;case "\x3d\x3d":f=
f==e?1:0;break;case "!\x3d":f=f!=e?1:0;break;case "\x26":f&=e;break;case "!":case "|":f|=e;break;case "^!":f|=e;break;case "\x26\x26":f=f&&e?1:0;break;case "||":f=f||e?1:0;break;case ",,":f=jg(f,18,!0)*Math.pow(2,18)+jg(e,18,!0);break;case "_":case "^_":"^_"==d&&(e=35-(e&255));e&&(f=jg(f,0,!0),f=0<e?f*Math.pow(2,e):Math.trunc(f/Math.pow(2,-e)));break;default:return!1}a.push(jg(f))}return!0}
function lg(a,b,c,d,e,f){var g,h=!1,k=0,n=[],t=[],x=a.u;for(a.u=e;c<d;){var y=b[c++].trim();var u=c<d?b[c++]:"";if(y)var w=mg(a,y,void 0,f,k);else if("{"==u){y=1;for(w=c;c<d;)if(c++,u=c<b.length?b[c++]:"","{"==u)y++;else if("}"==u&&!--y)break;w=lg(a,b,w,c-1,a.u,f);null!=w&&k&&(w=ng(w,k));y=c<d?b[c++].trim():"";u=c<d?b[c++]:""}else{if(" "==u)continue;if("^B"==u){a.u=2;continue}if("^O"==u){a.u=8;continue}if("^D"==u){a.u=10;continue}if(!(k&-1073741824)){if("+"==u)continue;if("-"==u){k=k<<2|1;continue}if("~"==
u||"^-"==u){k=k<<2|2;continue}if("^L"==u){k=k<<2|3;continue}}h=!0;break}if(void 0===w)if(f)f.push(y),w=0;else{h=!0;f=[];break}n.push(jg(w));if(" "==u)if(c<b.length-1&&!b[c])c++,u=b[c++];else{h=!0;break}if(!u)break;k="\x3c"==a.V[0]?og:pg;if(!k[u]){h=!0;break}t.length&&k[u]<=k[t[t.length-1]]&&kg(n,t,1);t.push(u);a.u="^_"==u?10:e;k=0}if(h||!kg(n,t)||1!=n.length)h=!0;h?f||a.i("parse error ("+(y||u)+")"):g=n.pop();a.u=x;return g}
function qg(a,b,c,d,e){for(var f;0<=(f=b.indexOf(c));){for(var g=0,h=f+1,k=e;h<b.length;){var n=b[h++];if(n==c){k=-1;break}if(!k)break;k--;n=n.charCodeAt(0);7==d?n&=127:n=n-32&63;g=jg(g*Math.pow(2,d)+n,d*e,!0)}if(0<=k){a.i("parse error ("+c+b+c+")");return}b=b.substr(0,f)+rg(a,g,-1)+b.substr(h)}return b}
function sg(a,b,c){var d=void 0,e=!1===c;c=Array.isArray(c)?c:void 0;if(b){"{"!=a.V[0]&&(b=b.split(a.V[0]).join("{").split(a.V[1]).join("}"));b=qg(a,b,'"',7,5);if(!b)return d;b=qg(a,b,"'",6,6);if(!b)return d;16!=a.u&&(b=b.replace(/(^|[^A-Z0-9$%.])([0-9]+)B/,"$1$2^_").replace(/\s+/g," "));b=b.split(/({|}|\|\||&&|\||\^!|\^B|\^O|\^D|\^L|\^-|~|\^_|_|&|!=|!|==|>=|>>>|>>|>|<=|<<|<|-|\+|\^\/|\/|\*|,,| )/);d=lg(a,b,0,b.length,a.u,c);void 0!==d&&e&&tg(a,null,d)}return d}
function ug(a,b){var c=a.V[0],d=a.V[1];var e="("==c||"{"==c||"["==c?"\\":"";var f="["==c?"\\":"";for(f=new RegExp(e+c+"([^"+f+c+f+d+"]+)"+e+d);e=b.match(f);){var g=sg(a,e[1]);if(void 0===g)return;b=b.replace(c+e[1]+d,null!=g?rg(a,g):"undefined")}if(a.da.length)for(c=a.da[0],d=a.da[1],e="("==c||"{"==c||"["==c?"\\":"",f="["==c?"\\":"",f=new RegExp(e+c+"([^"+f+c+f+d+"]+)"+e+d);e=b.match(f);)b=b.replace("["+e[1]+"]","unimplemented");for(;c=b.match(/\$([a-z]+)/i);){d=null;switch(c[1].toLowerCase()){case "ops":d=
a.S-a.aa}if(null==d)break;b=b.replace(c[0],d.toString())}return b}function ng(a,b){for(;b;){var c;switch(b&3){case 1:a=-jg(a);break;case 2:a|=-1;break;case 3:for(c=35;0<=c&&!(a&Math.pow(2,c));)c--;a=35-c}b>>>=2}return a}
function mg(a,b,c,d,e){e=void 0===e?0:e;var f=Array.isArray(d)?d:void 0;if(void 0!=b){var g=a.Ib(b);if(0<=g)g=a.Jb(g);else if(g=b,a.A[g]?g=a.A[g].value:(g=g.substr(0,6),g=a.A[g]&&a.A[g].value),void 0!=g){var h=a.A[b]&&a.A[b].oe;h&&(f?f.push(h):(f=sg(a,h,d),void 0!==f?g+=f:(d||a.i("undefined "+(c||"value")+": "+b+" ("+h+")"),g=void 0)))}else g=na(b,1<b.length||10<a.u?a.u:10);void 0!=g?g=jg(ng(g,e)):d||a.i("invalid "+(c||"value")+": "+b)}else d||a.i("missing "+(c||"value"));return g}
function tg(a,b,c){var d=!1;if(void 0!==c){d=!0;var e=8==a.u?rg(a,c,32,8,1)+"  "+c+".":rg(a,c,32,16,1)+"  "+rg(a,c,32,8,1)+"  "+rg(a,c,32,2,8)+"  "+c+".";32<=c&&127>c&&(e+=" '"+String.fromCharCode(c)+"'")}a.i((null!=b?b+": ":"")+e);return d}function vg(a,b){var c=0;if(a.A){if(b)return tg(a,b,a.A[b]&&a.A[b].value);b=Object.keys(a.A);b.sort();for(var d=0;d<b.length;d++)tg(a,b[d],a.A[b[d]].value),c++}return 0<c}
function rg(a,b,c,d,e){c=void 0===c?0:c;e=void 0===e?0:e;switch((void 0===d?0:d)||a.u){case 2:(a=0<c?c:0)?36<a&&(a=36):(a=Math.abs(b),a=255>=a?8:262143>=a?18:36);b=oa(b,2,a,"",e);break;case 8:(a=0<c?(c+2)/3|0:0)?12<a&&(a=12):(a=Math.abs(b),a=262143>=a?6:16777215>=a?8:12);b=oa(b,8,a,e?"0o":"");break;case 10:(e=0<c?Math.ceil(.3*c):0)?11<e&&(e=11):e=99999>=Math.abs(b)?5:11;b=oa(b,10,e);break;default:b=p(b,0<c?c+3>>2:0,!!e)}return c=0>c?b.replace(/^0+([0-9A-F]+)$/i,"$1"):b}
var pg={"||":5,"\x26\x26":6,"!":7,"|":7,"^!":8,"\x26":9,"!\x3d":10,"\x3d\x3d":10,"\x3e\x3d":11,"\x3e":11,"\x3c\x3d":11,"\x3c":11,"\x3e\x3e\x3e":12,"\x3e\x3e":12,"\x3c\x3c":12,"-":13,"+":13,"^/":14,"/":14,"*":14,_:19,"^_":19,"{":20,"}":20},og={",,":1,"||":5,"\x26\x26":6,"!\x3d":10,"\x3d\x3d":10,"\x3e\x3d":11,"\x3e":11,"\x3c\x3d":11,"\x3c":11,"\x3e\x3e\x3e":12,"\x3e\x3e":12,"\x3c\x3c":12,"-":13,"+":13,"^/":14,"/":14,"*":14,"!":15,"|":15,"^!":15,"\x26":15,_:19,"^_":19,"{":20,"}":20};
function wg(a){ig.call(this,a);this.style=xg;this.L=Yg();this.qa=Yg();this.T=Yg();this.C=[];this.j=this.M=this.B=[];$g(this);this.W=0;ah(this);this.ja={};bh(this,a.messages);this.la=a.commands;var b=this;window?void 0===window.pc8080&&(window.pc8080=function(a){return Yc(b,a)}):void 0===global.pc8080&&(global.pc8080=function(a){return Yc(b,a)})}ia(wg,ig);l=wg.prototype;
l.Da=function(a,b,c,d){this.H=b;this.w=c;this.P=a;(a=Uc(a,"messages"))&&bh(this,a);this.ma=ch;je(this,64,function(a){a:{var b=d.H.b,c=a[0],e=a=0,k=b.length;if(c){a=dh(eh(d,c));if(-1===a){d.i("invalid address: "+c);break a}e=a>>>d.H.g;k=1}d.i("blockid   physical   blockaddr   used    size    type");d.i("--------  ---------  ----------  ------  ------  ----");c=-1;for(var n=0;k--;){var t=b[e];t.type==c?n++||d.i("..."):(c=t.type,n=cc[c],t&&d.i(p(t.id)+"  %"+p(e<<d.H.g)+"  %%"+p(t.K)+"  "+q(t.lb)+"  "+
q(t.size)+"  "+n),c!=Fc&&(c=-1),n=0);a+=d.H.u;e++}}});Kb(this)};
l.ca=function(a,b,c){var d=this;switch(b){case "debugInput":return this.I=this.O[b]=c,c.onkeydown=function(a){if(13==a.keyCode){var b=d.I.value;d.I.value="";Yc(d,b,!0)}else if(27==a.keyCode)d.I.value=b="";else if(38==a.keyCode?(b=null,d.b<d.g.length-1&&(b=d.g[++d.b])):40==a.keyCode&&(0<d.b?b=d.g[--d.b]:(b="",d.b=-1)),null!=b){var c=b.length;d.I.value=b;d.I.setSelectionRange(c,c)}null!=b&&a.preventDefault&&a.preventDefault()},!0;case "debugEnter":return this.O[b]=c,Za(c,function(){if(d.I){var a=d.I.value;
d.I.value="";Yc(d,a,!0);return!0}return!1}),!0;case "step":return this.O[b]=c,Za(c,function(a){var b=!1;Lb(d,!0)||(Mb(d,!0),b=fh(d,a?1:0),Mb(d,!1));return b}),!0}return!1};l.Wa=function(){this.I&&this.I.focus()};function dh(a){a=a&&a.K;null==a&&(a=-1);return a}l.Ea=function(a,b){var c=255,d=dh(a);-1!==d&&(c=ec(this.H,d),b&&gh(a,b));return c};l.Db=function(a,b){var c=65535,d=dh(a);-1!==d&&(c=gc(this.H,d),b&&gh(a,b));return c};
l.Wb=function(a,b,c){var d=dh(a);-1!==d&&(hc(this.H,d,b),c&&gh(a,c),Zc(this.w,!0))};l.Pc=function(a,b,c){var d=dh(a);if(-1!==d){var e=this.H,f=d&e.j,g=(d&e.C)>>>e.g;f!=e.j?e.b[g].Rb(f,b&65535,d):(e.b[g++].mb(f,b&255,d),e.b[g&e.G].mb(0,b>>8&255,d+1));c&&gh(a,c);Zc(this.w,!0)}};function Yg(a){return{K:a,Aa:!1}}function hh(a){return{K:a[0],Aa:a[1]}}
function eh(a,b,c){c=(c?a.L:a.qa).K;if(void 0!==b){var d=b=ug(a,b)||b;var e;if(d.match(/^[a-z_][a-z0-9_]*$/i))for(d=d.toUpperCase(),c=0;c<a.C.length;c++){var f=a.C[c].pa[d];if(void 0!==f){d=f.o;void 0!==d&&(e=Yg(d));break}}if(d=e)return d;c=sg(a,b)}null!=c&&(d=Yg(c));return d}function ih(a,b,c){c&&(c=c.match(/(['"])(.*?)\1/))&&(b.rd=a.yb(b.Ic=c[2]))}function gh(a,b){null!=a.K&&(a.K+=b||1)}function jh(a){return p(a.K,4)}
function kh(a,b,c){var d="";for(c=c||256;d.length<c;){var e=a.Ea(b,1);if(!e||36==e||127<=e)break;d+=32<=e?String.fromCharCode(e):"."}return d}function bh(a,b){a.J=a;a.fa=1073741824;a.X=null;a.Y=[];b=a.yb(b.replace("keys","key").replace("kbd","keyboard"),!1,"|");if(b.length)for(var c in Sb)0<=Ga(b,c)&&(a.fa|=Sb[c],a.i(c+" messages enabled"))}function je(a,b,c){for(var d in Sb)if(b==Sb[d]){a.ja[d]=c;break}}
l.Ib=function(a,b){a=a.toUpperCase();if(null==b)var c=Ga(lh,a);else c=Ga(lh,a.substr(b,2)),0>c&&(c=Ga(lh,a.substr(b,1)));return c};function mh(a,b){var c=0;a=a.Jb(b);if(void 0!==a)switch(b){case nh:case oh:case ph:case qh:case rh:case sh:case th:case uh:c=2;break;case vh:case wh:case xh:case yh:case zh:case Ah:case Bh:c=4}return c?p(a,c):"??"}
l.Jb=function(a){if(0<=a){var b=this.w;switch(a){case nh:var c=b.g;break;case oh:c=b.u;break;case ph:c=b.A;break;case vh:c=Ed(b);break;case qh:c=b.B;break;case rh:c=b.C;break;case wh:c=Gd(b);break;case sh:c=b.D;break;case th:c=b.F;break;case xh:c=C(b);break;case uh:c=E(b,C(b));break;case yh:c=b.L;break;case zh:c=b.j;break;case Ah:c=Cd(b);break;case Bh:c=Cd(b)&255|b.g<<8}}return c};
function Ch(a,b){b=ug(a,b)||b;for(var c=0,d,e;0<=(c=b.indexOf("@",c));)e=a.Ib(b,c+1),0<=e&&(b=b.substr(0,c)+mh(a,e)+b.substr(c+1+lh[e].length)),c++;for(c=0;0<=(c=b.indexOf("#",c));)e=b.substr(c+1,2),d=na(e,16),null!=d&&32<=d&&127>d?(d=e+" '"+String.fromCharCode(d)+"'",b=b.replace("#"+e,d),c+=d.length):c++;for(c=0;0<=(c=b.indexOf("$",c));)e=b.substr(c+1,9),(d=eh(a,e))?(d=e+' "'+kh(a,d)+'"',b=b.replace("$"+e,d),c+=d.length):c++;for(c=0;0<=(c=b.indexOf("^",c));)e=b.substr(c+1,9),(d=eh(a,e))?(gh(d),d=
e+' "'+kh(a,d,11)+'"',b=b.replace("^"+e,d),c+=d.length):c++;return b}l.message=function(a,b){b&&(a+=" at "+jh(Yg(this.w.j)));this.fa&536870912?this.Y.push(a):this.X&&a==this.X||(this.X=a,this.fa&-2147483648&&(Rc(this),a+=" (cpu halted)"),this.i(a),this.w&&(a=this.w,sd(a),a.ra=0,Zc(a)))};
function Pb(a,b,c,d,e,f,g,h){h|=256;null!=f&&(a.fa&h)!=h||a.message(b.Fb+"."+(null!=d?"outPort":"inPort")+"("+q(c)+","+(f?f:"unknown")+(null!=d?","+qa(d):"")+")"+(null!=g?": "+qa(g):"")+(null!=e?" at "+p(e,4):""))}
function ah(a){var b;if(be(a)){if(!a.G||!a.G.length){a.G=Array(Dh);for(b=0;b<a.G.length;b++)a.G[b]=Yg();a.U=0;a.i("instruction history buffer allocated")}if(!a.D||!a.D.length)for(a.D=Array(256),b=0;b<a.D.length;b++)a.D[b]=[b,0]}else a.G&&a.G.length&&a.i("instruction history buffer freed"),a.U=0,a.G=[],a.D=[]}function Eh(a,b){if(!Fh(a))return!1;a.w.qb(b);return!0}
function fh(a,b,c,d){if(!Fh(a))return!1;a.F=0;b||be(a)&&ce(a,a.w.j,0);try{var e=a.w.Bb(b);0<e&&(a.F+=e,nd(a.w,e,!0),$c(a.w,e),a.S++)}catch(f){"number"!=typeof f&&(b=f,a.F=0,Ib(a.w,b.stack||b.message))}!1!==d&&Zc(a.w);Xc(a,c||!1);return 0<a.F}function Rc(a,b){a.w&&bd(a.w,b)}function Xc(a,b){void 0===b&&(b=!0);a.L=Yg(a.w.j);b&&1!=a.R?Gh(a):Hh(a)}
function Fh(a){var b;if(b=a.w&&Jb(a.w))b=a.w,b.flags.ha?b=!0:(b.i(b.toString()+" not powered"),b=!1);b&&!Lb(a.w)?(a=a.w,a.flags.error?(a.i(a.toString()+" error"),a=!0):a=!1,a=!a):a=!1;return a}l.ta=function(a,b){return!b&&(this.reset(!0),a&&this.restore&&!this.restore(a))?!1:!0};l.sa=function(a,b){b&&this.i(a?"suspending":"shutting down");return a?this.save():!0};l.reset=function(a){ah(this);this.S=this.aa=0;this.X=null;this.F=0;this.L=Yg(this.w.j);this.flags.ia=!1;Ih(this);a||Xc(this)};
l.save=function(){var a=new Dd(this),b=this.L;a.set(0,[b.K,b.Aa]);b=this.T;a.set(1,[b.K,b.Aa]);a.set(2,[this.g,this.N,this.fa]);a.set(3,this.C);return a.data()};l.restore=function(a){var b=0;void 0!==a[2]&&(this.L=hh(a[b++]),this.T=hh(a[b++]),this.g=a[b][0],"string"==typeof this.g&&(this.g=[this.g]),this.N=a[b][1],this.fa|=a[b][2]);a[3]&&(this.C=a[3]);return!0};l.start=function(a,b){this.R||this.i("running");this.flags.ia=!0;this.wa=a;this.xa=b};
l.stop=function(a,b){if(this.flags.ia){this.flags.ia=!1;this.F=b-this.xa;if(!this.R){b="stopped";if(this.F){a-=this.wa;var c=0<a?Math.round(1E3*this.F/a):0;b+=" (";be(this)&&(b+=this.S+" opcodes, ",this.aa-=this.S,this.S=0);b+=this.F+" cycles, "+a+" ms, "+c+" hz)"}else Nb(this,-2147483648)&&(b+=" (use the 't' command to execute blocked faults)");this.i(b)}Xc(this,!0);this.Wa();Ih(this,this.w.j)}};function be(a){return 1<a.j.length||!!a.W}
function ce(a,b,c){var d=a.w;if(0<c&&(a.W&&!--a.W||Qc(a,b,1,a.j)))return!0;0<=c&&a.D.length&&(a.S++,b=ec(a.H,b),null!=b&&(a.D[b][1]++,b=a.G[a.U],b.K=d.j,b.Aa=!1,++a.U==a.G.length&&(a.U=0)));return!1}function nc(a,b,c){a.i("break on input from port "+q(b)+": "+p(c));Rc(a,!0)}function Ac(a,b,c){a.i("break on output to port "+q(b)+": "+p(c));Rc(a,!0)}
function $g(a){var b;a.j=["bp"];if(void 0!==a.M)for(b=1;b<a.M.length;b++){var c=a.M[b];var d=a.H;Pc(d.b[dh(c)>>>d.g],!1)}a.M=["br"];if(void 0!==a.B)for(b=1;b<a.B.length;b++)c=a.B[b],d=a.H,Pc(d.b[dh(c)>>>d.g],!0);a.B=["bw"];a.ra=0}l.Ma=function(a,b,c){var d=!0;c||Jh(this,a,b,!1,!0);if(a!=this.j){var e=dh(b);if(-1===e)this.i("invalid address: "+jh(b)),d=!1;else{var f=this.H;f.b[e>>>f.g].Ma(e&f.j,a==this.B)}}d&&(a.push(b),c?b.Aa=!0:(Kh(this,a,a.length-1,"set"),ah(this)))};
function Jh(a,b,c,d,e){var f=!1;c=dh(c);for(var g=1;g<b.length;g++){var h=b[g];if(c==dh(h)&&(!d||h.Aa)){f=!0;h.Aa||e||Kh(a,b,g,"cleared");b.splice(g,1);b!=a.j&&(d=a.H,Pc(d.b[c>>>d.g],b==a.B));h.Aa||ah(a);break}}return f}function Lh(a,b){for(var c=1;c<b.length;c++)Kh(a,b,c);return b.length-1}function Kh(a,b,c,d){c=b[c];a.i(b[0]+" "+jh(c)+(d?" "+d:c.Ic?' "'+c.Ic+'"':""))}
function Ih(a,b){if(void 0!==b)Qc(a,b,1,a.j,!0),a.R=0;else for(b=1;b<a.j.length;b++){var c=a.j[b];if(c.Aa){if(!Jh(a,a.j,c,!0))break;b=0}}}
function Qc(a,b,c,d,e){var f=!1;if(!a.ra++)for(var g=1;!f&&g<d.length;g++){var h=d[g];if(!e||h.Aa)for(var k=dh(h),n=0;n<c;n++)if(b+n==k){var t;f=!0;h.Aa&&(Jh(a,d,h,!0),e=!0);if(t=h.rd){f=!1;for(var x=0;x<t.length;x++)if(!Mh(a,t[x],!0)){if(t[x].indexOf("if")){f=!0;break}for(var y=x+1;y<t.length&&t[y].indexOf("else");y++)x++;if(y==t.length){f=!0;break}}a.w.flags.ia||(f=!0)}if(f){e||Kh(a,d,g,"hit");break}}}a.ra--;return f}
function Nh(a,b,c,d){for(var e=Yg(b.K),f=a.Ea(b,1),g=a.ma[f],h="",k=(a.style!=Oh?Ph:Qh)[g[0]],n=g.length-1,t=Rh,x,y=1;y<=n;y++){var u="";x=g[y];if(void 0!==x&&!(x&N&&a.style==xg)){var w=x&Sh;if(w){var D=x&Th;D?t=D:x|=t;x&Uh||(x|=1==y?Vh:Wh);if(w&O)a:{u=a;w=x;D=b;switch(w&Th){case Q:D=p(u.Ea(D,1),2);break;case Xh:D=p(u.Ea(D,1)<<24>>24,4);break;case Yh:D=p(u.Db(D,2),4);break;default:u="imm("+q(w)+")";break a}u.style==Oh&&w&Zh?D="["+D+"]":w&$h||(D=(u.style==xg?"$":"0x")+D);u=D}else w&$h?(u=(x&ai)>>8,
w=lh[u],a.style==Oh&&x&Zh&&(u==uh&&(w="HL"),w="["+w+"]"),u=w):w&bi&&(u=(f>>3&7).toString());if(!u||!u.length){h="INVALID";break}0<h.length&&(h+=",");h+=u||"???"}}}f="";g=jh(e)+" ";if(-1!==e.K&&-1!==b.K){do if(f+=p(a.Ea(e,1),2),null==e.K)break;while(e.K!=b.K)}g+=xa(f,10);g+=x&ci?"*":" ";g+=xa(k,7);h&&(g+=" "+h);c&&(g=xa(g,40)+";"+c,g=a.w.flags.Ua?g+("cycles\x3d"+ad(a.w).toString()+" cs\x3d"+p(a.w.ua)):g+(null!=d?"\x3d"+d.toString():""));return g}
function di(a,b){switch(b){case "IF":a=a.w.M&512;break;case "SF":a=Od(a.w);break;case "ZF":a=Nd(a.w);break;case "AF":a=Md(a.w);break;case "PF":a=Ld(a.w);break;case "CF":a=Jd(a.w);break;default:a=0}return b.charAt(0)+(a?"1":"0")+" "}function ei(a,b){return lh[b]+"\x3d"+mh(a,b)+" "}function fi(a){return ei(a,nh)+ei(a,vh)+ei(a,wh)+ei(a,xh)+ei(a,yh)+di(a,"IF")+di(a,"SF")+di(a,"ZF")+di(a,"AF")+di(a,"PF")+di(a,"CF")}l.zc=function(a,b){return a[0]>b[0]?1:a[0]<b[0]?-1:0};
function gi(a,b,c){var d=[],e=dh(b)>>>0;for(b=0;b<a.C.length;b++){var f=a.C[b],g=f.K>>>0,h=f.Pd;if(e>=g&&e<g+h){e=Ca(f.xc,[e-g],a.zc);0<=e?hi(a,b,e,d):c&&(e=~e,hi(a,b,e-1,d),hi(a,b,e,d));break}}return d}function hi(a,b,c,d){var e={},f=a.C[b].xc,g=0,h=null;0<=c&&c<f.length&&(g=f[c][0],h=f[c][1]);h&&(e=a.C[b].pa[h],h="."==h.charAt(0)?null:e.l||h);d.push(h);d.push(g);d.push(e.a);d.push(e.c)}
function ii(a,b){if("?"==b)a.i("frequency commands:"),a.i("\tclear\tclear all frequency counts");else{var c=0;if(a.D)if("clear"==b){for(b=0;b<a.D.length;b++)a.D[b]=[b,0];a.i("frequency data cleared");c++}else if(void 0!==b)a.i("unknown frequency command: "+b),c++;else{var d=a.D.slice();d.sort(function(a,b){return b[1]-a[1]});var e=a.style!=Oh?Ph:Qh;for(b=0;b<d.length;b++){var f=d[b][0],g=d[b][1];g&&(a.i((e[a.ma[f][0]]+"  ").substr(0,5)+" ("+qa(f)+"): "+g+" times"),c++)}}c||a.i("no frequency data available")}}
function ji(a,b){var c=b.match(/^\s*([A-Z_]?[A-Z0-9_]*)\s*(=?)\s*(.*)$/i);if(c){if(!c[1])return vg(a)||a.i("no variables"),!0;if(!c[2])return vg(a,c[1]);if(!c[3])return delete a.A[c[1]],!0;b=sg(a,c[3]);return void 0!==b?(a.A[c[1]]={value:b,oe:void 0},!0):!1}a.i("invalid assignment:"+b);return!1}
function ki(a,b,c){var d=null;if(b=eh(a,b,!0)){var e=gi(a,b,!0);if(e.length){var f;if(e[0]){var g="";(f=b.K-e[1])&&(g=" + "+q(f));f=e[0]+" ("+p(e[1],4)+")"+g;c&&a.i(f);d=f}4<e.length&&e[4]&&(g="",(f=e[5]-b.K)&&(g=" - "+q(f)),f=e[4]+" ("+p(e[5],4)+")"+g,c&&a.i(f),d||(d=f))}else c&&a.i("no symbols")}return d}
function li(a,b){switch(b[1]){case "8080":a.style=xg;break;case "8086":a.style=Oh;break;case "cs":var c;void 0!==b[3]&&(c=+b[3]);switch(b[2]){case "int":a.w.la=c;break;case "start":a.w.wa=c;break;case "stop":a.w.qa=c;break;default:a.i("unknown cs option");return}void 0!==c&&Wc(a.w);a.i("checksums "+(a.w.flags.Ua?"enabled":"disabled"));return;case "sp":void 0!==b[2]&&(cd(a.w,+b[2])||a.i("warning: using 1x multiplier, previous target not reached"));a.i("target speed: "+(a.w.Y.toFixed(2)+"Mhz")+" ("+
a.w.S+"x)");return;case "?":a.i("debugger options:");a.i("\t8080\t\tselect 8080-style mnemonics");a.i("\t8086\t\tselect 8086-style mnemonics");a.i("\tcs int #\tset checksum cycle interval to #");a.i("\tcs start #\tset checksum cycle start count to #");a.i("\tcs stop #\tset checksum cycle stop count to #");a.i("\tsp #\t\tset speed multiplier to #");break;default:if(b[1]){a.i("unknown option: "+b[1]);return}}a.i(a.style+"-style mnemonics enabled")}
function Gh(a,b){var c;if(b&&"?"==b[1])a.i("register commands:"),a.i("\tr\tdump registers"),a.i("\trx [#]\tset flag or register x to [#]");else{var d=a.w;null==c&&(c=!0);if(null!=b&&1<b.length){var e=b[1],f=e.indexOf("\x3d");if(0<f)b=e.substr(f+1),e=e.substr(0,f);else if(2<b.length)b=b[2];else{a.i("missing value for "+b[1]);return}f=sg(a,b);if(void 0===f)return;switch(e.toUpperCase()){case "A":d.g=f&255;break;case "B":d.u=f&255;break;case "BC":d.u=f>>8&255;case "C":d.A=f&255;break;case "D":d.B=f&
255;break;case "DE":d.B=f>>8&255;case "E":d.C=f&255;break;case "H":d.D=f&255;break;case "HL":d.D=f>>8&255;case "L":d.F=f&255;break;case "SP":d.L=f&65535;break;case "PC":B(d,f);a.L=Yg(d.j);break;case "PS":Ad(d,f);break;case "PSW":Ad(d,f&255|d.M&-256);d.g=f>>8;break;case "CF":d.G=f?d.G|256:d.G&255;break;case "PF":f?Ld(d)||(d.I^=1):Ld(d)&&(d.I^=1);break;case "AF":d.N=f?~d.I&16|d.N&-17:d.I&16|d.N&-17;break;case "ZF":d.G=f?d.G&-256:d.G|255;break;case "SF":f?Od(d)||(d.I^=192):Od(d)&&(d.I^=192);break;case "IF":d.M=
f?d.M|512:d.M&-513;break;default:a.i("unknown register: "+e);return}Zc(d);a.i("updated registers:")}a.i(fi(a));c&&(a.L=Yg(d.j),Hh(a,jh(a.L)))}}function mi(a,b){b=ya(b);var c=b.match(/^(['"])(.*?)\1$/);c?a.i(Ch(a,c[2])):sg(a,b,!1)}function ni(a,b,c){var d="t"!=b;c=mg(a,c,void 0,!0)||1;var e=1==c?0:1;"tc"==b&&(e=c,c=1);Ya(c,function(){return Mb(a,!0)&&fh(a,e,d,!1)},function(){Zc(a.w);Mb(a,!1)})}
function Hh(a,b,c,d){if(b=eh(a,b,!0)){void 0===d&&(d=1);var e=256;if(void 0!==c){d=eh(a,c,!0);if(!d||d.K<b.K)return;e=d.K-b.K;if(256<e){a.i("range too large");return}d=-1}c=0;for(var f;0<e&&d--;){f=Lb(a,!1)||a.R?a.F:null;var g=null!=f?"cycles":null,h=gi(a,b),k=b.K;if(h[0]&&d&&(!c&&d||0>h[0].indexOf("+"))){var n=h[0]+":";h[2]&&(n+=" "+h[2]);a.i(n)}h[3]&&(g=h[3],f=null);f=Nh(a,b,g,f);a.i(f);a.L=b;e-=b.K-k;c++}}}
l.yb=function(a,b,c){if(b)if(a){0>this.b&&this.g.length&&(this.b=0);if(0>this.b||a!=this.g[this.b])this.g.splice(0,0,a),this.b=0;this.b--}else this.N?a="end":a=this.g[this.b+1];b=[];if(a){a=a.toLowerCase().replace(/""/g,"'");var d=0,e=null;c=c||";";for(var f=0;f<=a.length;f++){var g=a.charAt(f);if('"'==g||"'"==g)e?g==e&&(e=null):e=g;else if(g==c&&!e||!g)b.push(ya(a.substring(d,f))),d=f+1}}return b};
function Mh(a,b,c){var d=!0;try{b.length&&"end"!=b?c||a.i("\x3e\x3e "+b):(a.N&&(a.i("ended assemble at "+jh(a.T)),a.L=a.T,a.N=!1),b="");var e=b.charAt(0);if('"'==e||"'"==e)return!0;a.X=null;if(Jb(a)&&0<b.length){a.N&&(b="a "+jh(a.T)+" "+b);var f=b.replace(/ +/g," ").split(" ");if(f&&f.length)for(var g=f[0],h=g.charAt(0),k=1;k<g.length;k++){var n=g.charAt(k);if("?"==h||"r"==h||"a">n||"z"<n){f[0]=g.substr(k);f.unshift(g.substr(0,k));break}}switch(f[0].charAt(0)){case "a":var t=eh(a,f[1],!0);if(t)if(a.T=
t,void 0===f[2])a.i("begin assemble at "+jh(t)),a.N=!0,Zc(a.w);else{a.i("not supported yet");var x=[];if(x.length){for(var y=0;y<x.length;y++)a.Wb(t,x[y],1);a.i(Nh(a,a.T))}}break;case "b":a:{var u=f[0],w=f[1],D=b;if("?"==w)a.i("breakpoint commands:"),a.i("\tbi [p]\ttoggle break on input port [p]"),a.i("\tbo [p]\ttoggle break on output port [p]"),a.i("\tbp [a]\tset exec breakpoint at addr [a]"),a.i("\tbr [a]\tset read breakpoint at addr [a]"),a.i("\tbw [a]\tset write breakpoint at addr [a]"),a.i("\tbc [a]\tclear breakpoint at addr [a]"),
a.i("\tbl\tlist all breakpoints"),a.i("\tbn [n]\tbreak after [n] instruction(s)");else{var T=u.charAt(1);if("l"==T){var Na=Lh(a,a.j);Na+=Lh(a,a.M);(Na+=Lh(a,a.B))||a.i("no breakpoints")}else if("n"==T)a.W=mg(a,w),a.i("break after "+a.W+" instruction(s)");else if(void 0===w)a.i("missing breakpoint address");else{var P=Yg();if("*"!=w&&(P=eh(a,w,!0),!P))break a;w=q(P.K);"c"==T?null==P.K?($g(a),a.i("all breakpoints cleared")):Jh(a,a.j,P)||Jh(a,a.M,P)||Jh(a,a.B,P)||a.i("breakpoint missing: "+jh(P)):"i"==
T?a.i("breakpoint "+(kc(a.H,P.K)?"enabled":"cleared")+": port "+w+" (input)"):"o"==T?a.i("breakpoint "+(oc(a.H,P.K)?"enabled":"cleared")+": port "+w+" (output)"):null!=P.K&&(ih(a,P,D),"p"==T?a.Ma(a.j,P):"r"==T?a.Ma(a.M,P):"w"==T?a.Ma(a.B,P):a.i("unknown breakpoint command: "+T))}}}break;case "c":var ob=a.P;ob.B&&(ob.B.value="");break;case "d":a:{var Oa,za=f[0],pa=f[1],ua=f[2],Pi=f[3];if("?"==pa){var Ub="";for(Oa in Sb)a.ja[Oa]&&(Ub&&(Ub+=","),Ub+=Oa);Ub+=",state,symbols";a.i("dump memory commands:");
a.i("\tdb [a] [#]    dump # bytes at address a");a.i("\tdw [a] [#]    dump # words at address a");a.i("\tdd [a] [#]    dump # dwords at address a");a.i("\tdh [#] [#]    dump # instructions from history");Ub.length&&a.i("dump extension commands:\n\t"+Ub)}else if("state"==pa){var me=oi(a.P,!0);if("console"==ua)console.log(me);else{var yg=a.P;yg.B&&(yg.B.value="");me&&a.i(me)}}else if("symbols"==pa)for(var ne=0;ne<a.C.length;ne++){var oe=a.C[ne],Vb;for(Vb in oe.pa)if("."!=Vb.charAt(0)){var zg=oe.pa[Vb].o;
if(void 0!==zg){var Ag=oe.pa[Vb].l;Ag&&(Vb=Ag);a.i(p(zg,4)+" "+Vb)}}}else{if("d"==za){for(Oa in Sb)if(f[1]==Oa){var Bg=a.ja[Oa];Bg?(f.shift(),f.shift(),Bg(f)):a.i("no dump registered for "+pa);break a}pa||(za=a.Ba||"db")}else a.Ba=za;if("dh"==za){var Cg=pa,Dg=ua,Eg="",Fg=0,Pa=a.U,cb=a.G;if(cb.length){var Ba=+Cg||a.ua,pc=+Dg||10;isNaN(Ba)?Ba=pc:Eg="more ";Ba>cb.length&&(a.i("note: only "+cb.length+" available"),Ba=cb.length);Pa-=Ba;0>Pa&&(null==cb[cb.length-1].K?(Ba=Pa+Ba,Pa=0):Pa+=cb.length);var pe=
[];"call"==Dg&&(pc=1E5,pe=["CALL"]);for(void 0!==Cg&&a.i(Ba+" instructions earlier:");0<pc&&Pa!=a.U;){var Gg=cb[Pa++];if(null==Gg.K)break;var qc=Yg(Gg.K),Qi=Ba--,Hg=Nh(a,qc,"history",Qi);(!pe.length||0<=Hg.indexOf(pe[0]))&&a.i(Hg);qc.Hb&&(Pa+=qc.Hb,pc-=qc.Hb,Ba-=qc.Hb);Pa>=cb.length&&(Pa=0);a.ua=Ba;Fg++;pc--}}Fg||(a.i("no "+Eg+"history available"),a.ua=void 0)}else{var dd=eh(a,pa);if(dd){var ed=0;ua&&("l"==ua.charAt(0)&&(ua=ua.substr(1)||Pi),ed=mg(a,ua)>>>0,65536<ed&&(ed=65536));for(var rc="",fd=
"dd"==za?4:"dw"==za?2:1,gd=fd*ed||128,Ri=gd+15>>4||1;Ri--&&0<gd;){var qe=0,re=0,sc,se="",Ig="";pa=jh(dd);for(sc=16;0<sc&&0<gd;sc--){var hd=a.Ea(dd,1);qe|=hd<<(re++<<3);re==fd&&(se+=p(qe,2*fd),se+=1==fd?9==sc?"-":" ":"  ",qe=re=0);Ig+=32<=hd&&127>hd?String.fromCharCode(hd):".";gd--}rc&&(rc+="\n");rc+=pa+"  "+se+(0==sc?" "+Ig:"")}rc&&a.i(rc);a.qa=dd}}}}break;case "e":if("else"==f[0])break;var id=1,Jg=255,Kg=a.Ea,Lg=a.Wb;"ew"==f[0]&&(id=2,Jg=65535,Kg=a.Db,Lg=a.Pc);var Mg=id<<1,Ng=f[1];if(null==Ng)a.i("edit memory commands:"),
a.i("\teb [a] [...]  edit bytes at address a"),a.i("\tew [a] [...]  edit words at address a");else{var jd=eh(a,Ng);if(jd)for(var kd=2;kd<f.length;kd++){var tc=sg(a,f[kd]);if(void 0===tc){a.i("unrecognized value: "+f[kd]);break}tc&~Jg&&a.i("warning: "+p(tc)+" exceeds "+id+"-byte value");var Si=Kg.call(a,jd);a.i("changing "+jh(jd)+" from "+p(Si,Mg,!0)+" to "+p(tc,Mg,!0));Lg.call(a,jd,tc,id)}}break;case "f":ii(a,f[1]);break;case "g":a:{var Og=f[1],Ti=b;if(void 0!==Og){var te=eh(a,Og,!0);if(!te)break a;
ih(a,te,Ti);a.Ma(a.j,te,!0)}Eh(a,!0)||c||a.i("cpu busy or unavailable, run command ignored")}break;case "h":a:{if(a.flags.ia){var Pg="halting";Rc(a)}else{if(Lb(a,!0))break a;Pg="already halted"}c||a.i(Pg)}break;case "i":if("if"==f[0]){var uc=b.substr(2);uc=ya(uc);if(sg(a,uc)){c||a.i("true: "+uc);var Qg=!0}else c||a.i("false: "+uc),Qg=!1;Qg||(d=!1);break}if("int"==f[0]){var Ui=f[1];if(a.w.M&512){var ue=sg(a,Ui);if(null==ue)var ve=!1;else a.i("requesting interrupt level "+ue),ae(a.w,ue),ve=!0}else a.i("interrupts disabled (use rif\x3d1 to enable)"),
ve=!1;ve||(d=!1);break}var we=f[1];if(we&&"?"!=we){var xe=mg(a,we);if(void 0!==xe){var Vi=mc(a.H,xe);a.i(q(xe)+": "+qa(Vi))}}else a.i("input commands:"),a.i("\ti [p]\tread port [p]"),a.i("warning: port accesses can affect hardware state");break;case "k":var Wi=f[0];if("?"==f[1])a.i("stack trace commands:"),a.i("\tk\tshow frame addresses"),a.i("\tks\tshow symbol information");else{var ye=0,Rg=Yg(),vc=Yg(a.w.L);for(a.i("stack trace for "+jh(vc));10>ye;){for(var Bb=null,Xi=256;65536>vc.K>>>0;){Rg.K=
a.Db(vc,2);if(null==vc.K||!Xi--)break;for(var Yi=a,ld=Rg,Sg=null,wc=ld.K,Tg=wc,ze=1;6>=ze&&wc;ze++){if(2<ze){ld.K=wc;var md=Nh(Yi,ld);if(0<=md.indexOf("CALL")){var Ug=md.indexOf(" ");if(wc+(md.indexOf(" ",Ug+1)-Ug-1)/2==Tg){Sg=md;break}}}wc--}ld.K=Tg;if(Bb=Sg)break}if(!Bb||null==Bb)break;var Vg=null;if("ks"==Wi){var Wg=Bb.match(/[0-9A-F]+$/);Wg&&(Vg=ki(a,Wg[0]))}Bb=xa(Bb,50)+"  ;"+(Vg||"stack\x3d"+jh(vc));a.i(Bb);ye++}ye||a.i("no return addresses found")}break;case "l":"ln"==f[0]&&ki(a,f[1],!0);break;
case "m":a:{var db,eb=null,ba=f[1];"?"==ba&&(ba=void 0);if(void 0!==ba){var rb=0;if("all"==ba)rb=1610481663,ba=null;else if("on"==ba)eb=!0,ba=null;else if("off"==ba)eb=!1,ba=null;else{"keys"==ba&&(ba="key");"kbd"==ba&&(ba="keyboard");for(db in Sb)if(ba==db){rb=Sb[db];eb=!!(a.fa&rb);break}if(!rb){a.i("unknown message category: "+ba);break a}}if(rb)if("on"==f[2])a.fa|=rb,eb=!0;else if("off"==f[2]&&(a.fa&=~rb,eb=!1,536870912==rb)){for(var Ae=0;Ae<a.Y.length;Ae++)a.i(a.Y[Ae]);a.Y=[]}}var Zi=0,xc="";for(db in Sb)if(!ba||
ba==db){var $i=!!(a.fa&Sb[db]);if(null===eb||eb==$i)xc&&(xc+=","),++Zi%10||(xc+="\n\t"),"key"==db&&(db="keys"),xc+=db}void 0===ba&&a.i("message commands:\n\tm [category] [on|off]\tturn categories on/off");a.i((null!==eb?eb?"messages on:  ":"messages off: ":"message categories:\n\t")+(xc||"none"));ah(a)}break;case "o":var Be=f[1],aj=f[2];if(Be&&"?"!=Be){var Ce=mg(a,Be,"port #"),De=mg(a,aj);void 0!==Ce&&void 0!==De&&(zc(a.H,Ce,De),a.i(q(Ce)+": "+qa(De)))}else a.i("output commands:"),a.i("\to [p] [b]\twrite byte [b] to port [p]"),
a.i("warning: port accesses can affect hardware state");break;case "p":if("print"==f[0]){mi(a,b.substr(5));break}var Xg="pr"==f[0]?1:0,bj=1+Xg;if(a.R)a.i("step in progress");else{var Ee=Yg(a.w.j);switch(a.Ea(Ee)){case 205:a.R=bj,gh(Ee,3)}a.R?(a.Ma(a.j,Ee,!0),Eh(a)||(a.P&&a.P.Wa(),a.R=0)):ni(a,Xg?"tr":"t")}break;case "r":if("reset"==b){a.P&&a.P.reset();break}Gh(a,f);break;case "s":li(a,f);break;case "t":ni(a,f[0],f[1]);break;case "u":Hh(a,f[1],f[2],8);break;case "v":if("var"==f[0]){ji(a,b.substr(3))||
(d=!1);break}a.i("PC8080 version 1.72.2 ("+a.w.ub+",RELEASE"+(Qb?",TYPEDARRAYS":",LONGARRAYS")+")");a.i(La());break;case "?":if(f[1]){mi(a,b.substr(1));break}var Fe="commands:",Ge;for(Ge in pi)Fe+="\n"+xa(Ge,9)+pi[Ge];be(a)||(Fe+="\nnote: frequency/history disabled if no exec breakpoints");a.i(Fe);break;default:a.i("unknown command: "+b),d=!1}}}catch(Zg){a.i("debugger error: "+(Zg.stack||Zg.message)),d=!1}return d}function Yc(a,b,c){b=a.yb(b,c);for(var d in b)if(!Mh(a,b[+d]))return!1;return!0}
var pi={"?":"help/print","a [#]":"assemble","b [#]":"breakpoint",c:"clear output","d [#]":"dump memory","e [#]":"edit memory",f:"frequencies","g [#]":"go [to #]",h:"halt","i [#]":"input port #","if":"eval expression","int [#]":"request interrupt",k:"stack trace",ln:"list nearest symbol(s)",m:"messages","o [#]":"output port #",p:"step over",print:"print expression",r:"dump/set registers",reset:"reset machine",s:"set options","t [#]":"trace","u [#]":"unassemble",v:"print version","var":"assign variable"},
xg=8080,Oh=8086,Ph="NONE ACI ADC ADD ADI ANA ANI CALL CC CM CNC CNZ CP CPE CPO CZ CMA CMC CMP CPI DAA DAD DCR DCX DI EI HLT IN INR INX JMP JC JM JNC JNZ JP JPE JPO JZ LDA LDAX LHLD LXI MOV MVI NOP ORA ORI OUT PCHL POP PUSH RAL RAR RET RC RM RNC RNZ RP RPE RPO RZ RLC RRC RST SBB SBI SHLD SPHL STA STAX STC SUB SUI XCHG XRA XRI XTHL".split(" "),Qh="NONE ADC ADC ADD ADD AND AND CALL CALLC CALLS CALLNC CALLNZ CALLNS CALLP CALLNP CALLZ NOT CMC CMP CMP DAA ADD DEC DEC CLI STI HLT IN INC INC JMP JC JS JNC JNZ JNS JP JNP JZ MOV MOV MOV MOV MOV MOV NOP OR OR OUT JMP POP PUSH RCL RCR RET RETC RETS RETNC RETNZ RETNS RETP RETNP RETZ ROL ROR RST SBB SBB MOV MOV MOV MOV STC SUB SUB XCHG XOR XOR XCHG".split(" "),
oh=0,ph=1,qh=2,rh=3,sh=4,th=5,uh=6,nh=7,vh=8,wh=9,xh=10,yh=11,zh=12,Ah=13,Bh=14,lh="B C D E H L M A BC DE HL SP PC PS PSW".split(" "),Th=15,Sh=240,ai=3840,Uh=61440,Rh=0,Q=1,Xh=2,Yh=3,$h=16,O=32,Zh=64,bi=128,R=nh<<8|$h|Q,S=oh<<8|$h|Q,U=ph<<8|$h|Q,V=qh<<8|$h|Q,W=rh<<8|$h|Q,X=sh<<8|$h|Q,Y=th<<8|$h|Q,Z=uh<<8|$h|Q|Zh,qi=vh<<8|$h|Yh,ri=wh<<8|$h|Yh,si=xh<<8|$h|Yh,ti=yh<<8|$h|Yh,ui=Bh<<8|$h|Yh,Wh=4096,Vh=8192,N=16384,ci=32768,ch=[[45],[42,qi,O],[71,qi|Zh,R|N],[29,qi],[28,S],[22,S],[44,S,O],[63],[45,ci],[21,
si|N,qi],[40,R|N,qi|Zh],[23,qi],[28,U],[22,U],[44,U,O],[64],[45,ci],[42,ri,O],[71,ri|Zh,R|N],[29,ri],[28,V],[22,V],[44,V,O],[52],[45,ci],[21,si|N,ri],[40,R|N,ri|Zh],[23,ri],[28,W],[22,W],[44,W,O],[53],[45,ci],[42,si,O],[68,51|Zh,si|N],[29,si],[28,X],[22,X],[44,X,O],[20],[45,ci],[21,si|N,si],[41,si|N,51|Zh],[23,si],[28,Y],[22,Y],[44,Y,O],[16,R|N],[45,ci],[42,ti,O],[70,51|Zh,R|N],[29,ti],[28,Z],[22,Z],[44,Z,O],[72],[45,ci],[21,si|N,ti],[39,R|N,51|Zh],[23,ti],[28,R],[22,R],[44,R,O],[17],[43,S,S],[43,
S,U],[43,S,V],[43,S,W],[43,S,X],[43,S,Y],[43,S,Z],[43,S,R],[43,U,S],[43,U,U],[43,U,V],[43,U,W],[43,U,X],[43,U,Y],[43,U,Z],[43,U,R],[43,V,S],[43,V,U],[43,V,V],[43,V,W],[43,V,X],[43,V,Y],[43,V,Z],[43,V,R],[43,W,S],[43,W,U],[43,W,V],[43,W,W],[43,W,X],[43,W,Y],[43,W,Z],[43,W,R],[43,X,S],[43,X,U],[43,X,V],[43,X,W],[43,X,X],[43,X,Y],[43,X,Z],[43,X,R],[43,Y,S],[43,Y,U],[43,Y,V],[43,Y,W],[43,Y,X],[43,Y,Y],[43,Y,Z],[43,Y,R],[43,Z,S],[43,Z,U],[43,Z,V],[43,Z,W],[43,Z,X],[43,Z,Y],[26],[43,Z,R],[43,R,S],[43,R,
U],[43,R,V],[43,R,W],[43,R,X],[43,R,Y],[43,R,Z],[43,R,R],[3,R|N,S],[3,R|N,U],[3,R|N,V],[3,R|N,W],[3,R|N,X],[3,R|N,Y],[3,R|N,Z],[3,R|N,R],[2,R|N,S],[2,R|N,U],[2,R|N,V],[2,R|N,W],[2,R|N,X],[2,R|N,Y],[2,R|N,Z],[2,R|N,R],[73,R|N,S],[73,R|N,U],[73,R|N,V],[73,R|N,W],[73,R|N,X],[73,R|N,Y],[73,R|N,Z],[73,R|N,R],[66,R|N,S],[66,R|N,U],[66,R|N,V],[66,R|N,W],[66,R|N,X],[66,R|N,Y],[66,R|N,Z],[66,R|N,R],[5,R|N,S],[5,R|N,U],[5,R|N,V],[5,R|N,W],[5,R|N,X],[5,R|N,Y],[5,R|N,Z],[5,R|N,R],[76,R|N,S],[76,R|N,U],[76,R|
N,V],[76,R|N,W],[76,R|N,X],[76,R|N,Y],[76,R|N,Z],[76,R|N,R],[46,R|N,S],[46,R|N,U],[46,R|N,V],[46,R|N,W],[46,R|N,X],[46,R|N,Y],[46,R|N,Z],[46,R|N,R],[18,R|N,S],[18,R|N,U],[18,R|N,V],[18,R|N,W],[18,R|N,X],[18,R|N,Y],[18,R|N,Z],[18,R|N,R],[58],[50,qi],[34,51],[30,51],[11,51],[51,qi],[4,R|N,O|Q],[65,bi],[62],[54],[38,51],[30,51|ci],[15,51],[7,51],[1,R|N,O|Q],[65,bi],[57],[50,ri],[33,51],[48,O|Q,R|N],[10,51],[51,ri],[74,R|N,O|Q],[65,bi],[55],[54,ci],[31,51],[27,R|N,O|Q],[8,51],[7,51|ci],[67,R|N,O|Q],[65,
bi],[61],[50,si],[37,51],[78,ti|Zh|N,si|N],[14,51],[51,si],[6,R|N,O|Q],[65,bi],[60],[49,si],[36,51],[75,si|N,ri|N],[13,51],[7,51|ci],[77,R|N,O|Q],[65,bi],[59],[50,ui],[35,51],[24],[12,51],[51,ui],[47,R|N,O|Q],[65,bi],[56],[69,ti|N,si|N],[32,51],[25],[9,51],[7,51|ci],[19,R|N,O|Q],[65,bi]],Dh=1E3;ab(function(){for(var a=wb(document,"pc8080","debugger"),b=0;b<a.length;b++){var c=a[b],d=xb(c);d=new wg(d);vb(d,c)}});
function vi(a,b,c){v.call(this,"Computer",a,67108864);this.flags.ha=!1;wi(this,b);this.L=Uc(this,"autoPower",a);this.j=0;this.T=a.busWidth||a.buswidth;this.b=xi;this.G=null;this.D=this.R=!1;this.url=Uc(this,"url")||"";(Math.random()+.1).toString(36);this.g=yi(this);if(this.w=Ab("CPU",this.id)){this.J=Ab("Debugger",this.id);this.A=[];for(b=null;b=Wb(this,"Video",b);)this.A.push(b);this.H=new Yb({id:this.Pa+".bus",busWidth:this.T},this.w,this.J);var d=yb(this.id);if(this.B=(this.C=Ab("Panel",this.id))&&
this.C.O.print)for(b=0;b<d.length;b++){var e=d[b];e.Z=this.C.Z;e.print=this.C.print;e.i=this.C.i}this.i("PC8080 v1.72.2\nCopyright \u00a9 2012-2018 Jeff Parsons \x3cJeff@pcjs.org\x3e\nLicense: GPL version 3 or later \x3chttp://gnu.org/licenses/gpl.html\x3e");for(b=0;b<d.length;b++)e=d[b],e.Da&&e.Da(this,this.H,this.w,this.J);b=null;e=Uc(this,"resume",a);void 0!==e&&(1<e.length?b=this.F=e:this.b=parseInt(e,10));var f;if(a=Uc(this,"state")||(f=!0,a.state))b=this.M=a,f||(this.D=!0,this.b=xi),this.b&&
(this.I=new Dd(this,"1.72.2"),this.I.load()?b=null:delete this.I);!b&&this.b&&(b=zi(this))&&(this.D=!0);if(b){var g=this;Ha(b,null,!0,function(a,b,c){c?(g.F=null,g.D=!1,g.Z("Unable to load machine state from server (error "+c+(b?": "+ya(b):"")+")")):(g.G=b,g.R=!0);Kb(g)})}else Kb(this);this.O.power||(this.L=!0);!c&&this.L&&this.wait(this.jb)}else r("Unable to find CPU component")}ia(vi,v);
function wi(a,b){if(!b){var c;if("object"==typeof resources&&(c=resources.parms))try{b=eval("("+c+")")}catch(d){r(d.message+" ("+c+")")}}a.S=b}function Uc(a,b,c){var d=b.toLowerCase();d=Wa(b)||Wa(d);void 0===d&&a.S&&(d=a.S[b]);void 0===d&&c&&(d=c[b]);void 0===d&&"object"==typeof resources&&resources[b]&&(d=b);return d}l=vi.prototype;l.wait=function(a,b){for(var c=this,d=yb(this.id),e=0;e<=d.length;e++){var f=e<d.length?d[e]:this;if(!Jb(f)){Jb(f,function(){c.wait(a,b)});return}}a.call(this,b)};
function Ai(a,b){var c=new Dd(a,"1.72.2",Bi);if(c.load()&&Ci(c)){var d=c.get(Di),e=b?b.get(Di):"unknown";d!=e&&(a.Z("Machine state may be out-of-date\n("+d+" vs. "+e+")\nCheck your browser's local storage limits"),b||c.clear())}}
l.jb=function(a){void 0===a&&(a=this.b||(this.G?Ei:xi));if(!this.j){this.j++;var b=!1,c=!1;this.N=!1;var d=this.I||new Dd(this,"1.72.2");if(a==Fi)b=!0;else if(a>xi){if(d.load(this.G)){this.u=new Dd(this,"1.72.2",Gi);this.u.load()&&(Hi(),a=Ii,Ji(this.u));this.u.set(Di,Da());this.u.store();var e=this.b&&!this.D;if(a==Ei||tb("Click OK to restore the previous PC8080 machine state, or CANCEL to reset the machine.")){if(c=Ci(d)){var f=d.get("code"),g=d.get("data");f&&("ok"==f?d.load(g):("error"==f&&"no machine state"!=
g?(this.Z("Error: "+g),"unable to verify user"==g&&(Sa(Ki,""),this.g=null)):this.i(f+": "+g),Ji(d),d.load()?(c=Ci(d),e=!0):c=!1))}e&&Ai(this,c?d:null)}else a==Ii&&d.clear()}else Ai(this);delete this.G;delete this.I}e=yb(this.id);for(f=0;f<e.length;f++)g=e[f],g!==this&&g!=this.w&&(c=Li(this,g,d,b,c));b=[d,a,c];a!=Fi?this.wait(this.Bc,b):this.Bc(b)}};
function Li(a,b,c,d,e){if(!b.flags.ha){b.flags.ha=!0;if(b.ta){var f=null;e&&((f=c.get(b.id))||(f=c.get(b.id.replace(/-[0-9]+\./i,"."))));"string"===typeof f&&(f=null);!b.ta(f,d)&&f&&(r("Unable to restore state for "+b.type),a.M&&!a.R?(c.clear(),a.b=xi,window&&window.location.reload()):a.N=!0,b.ta(null),e=!1)}if(!d&&b.uc)for(a=b.uc.split("|"),c=0;c<a.length;c++)b.status(a[c])}return e}
l.Bc=function(a){var b=a[0],c=0>a[1];a=a[2];this.V=!0;this.flags.ha=!0;var d=this.O.power;d&&(d.textContent="Shutdown");this.w&&(Li(this,this.w,b,c,a),this.w.gb());this.N&&(Hi(),b.clear());!c&&this.u&&(this.u.clear(),delete this.u);this.j=0};function Hi(){fb("There may be a problem with your PC8080 machine.")}
function oi(a,b,c){var d="none";if(a.j)return null;a.j--;var e=new Dd(a,"1.72.2"),f=new Dd(a,"1.72.2",Bi),g=Da();f.set(Di,g);e.set(Di,g);e.set(Mi,"1.72.2");e.set(Ni,window?window.location.href:null);e.set(Oi,La());if(a.w&&a.w.sa){c&&bd(a.w);var h=a.w.sa(b,c);"object"===typeof h&&e.set(a.w.id,h);c&&(a.w.flags.ha=!1,!1===h&&(d=null))}g=yb(a.id);for(var k=0;k<g.length;k++){var n=g[k];n.flags.ha&&(n.sa&&(h=n.sa(b,c),"object"===typeof h&&e.set(n.id,h)),c&&(n.flags.ha=!1,!1===h&&(d=null)))}d&&(c?(g=h=!1,
b?(a.g&&cj(a,a.g,e.toString()),f.store()&&e.store()||(d=null,h=g=!0)):a.b&&(h=!0,g=a.b==dj),h&&e.clear(g)):d=e.toString());c&&(a.flags.ha=!1,b=a.O.power)&&(b.textContent="Power");a.j=0;return d}l.reset=function(){this.H&&this.H.reset&&(Ob(this,"Resetting "+this.H.type),this.H.reset());for(var a=yb(this.id),b=0;b<a.length;b++){var c=a[b];c!==this&&c!==this.H&&c.reset&&(Ob(this,"Resetting "+c.type),c.reset())}};
l.start=function(a,b){for(var c=yb(this.id),d=0;d<c.length;d++){var e=c[d];"CPU"!=e.type&&e!==this&&e.start&&e.start(a,b)}};l.stop=function(a,b){for(var c=yb(this.id),d=0;d<c.length;d++){var e=c[d];"CPU"!=e.type&&e!==this&&e.stop&&e.stop(a,b)}};
l.ca=function(a,b,c){var d=this;switch(b){case "power":return this.O[b]=c,c.onclick=function(){d.j||(d.flags.ha?oi(d,!1,!0):d.wait(d.jb))},!0;case "reset":return this.O[b]=c,c.onclick=function(){if(d.flags.ha&&!d.j)if(d.b&&!d.F){var a=tb("Click OK to save changes to this PC8080 machine.\n\nWARNING: If you CANCEL, all disk changes will be discarded.");oi(d,a,!0);!a&&d.M?window&&window.location.reload():d.jb(xi)}else d.reset(),d.w&&d.w.gb()},!0;case "save":if(ta())c.parentNode.removeChild(c);else return this.O[b]=
c,c.onclick=function(){var a=yi(d,!0);if(a){var b=!!(d.b&&!d.F||d.M),c=oi(d,b);b?cj(d,a,c):d.Z("Resume disabled, machine state not saved")}},!0}return!1};function yi(a,b){var c=a.g;c||((c=Ra(Ki),void 0!==c)?!c&&b&&(b=null,window&&(b=window.prompt("Saving machine states on the pcjs.org server is currently unsupported.\n\nIf you're running your own server, enter your user ID below.","")),c=b)&&((c=ej(a,c))||a.Z("The user ID is invalid.")):b&&a.Z("Browser local storage is not available"));return c}
function ej(a,b){a.g=null;b=Ha(Ja()+"/api/v1/user?req\x3dverify\x26user\x3d"+b);var c=b[1];if(!b[0]&&c)try{b=eval("("+c+")"),b.code&&"ok"==b.code&&(Sa(Ki,b.data),a.g=b.data)}catch(d){r(d.message+" ("+c+")")}return a.g}function zi(a){var b=null;a.g&&(b=Ja()+"/api/v1/user?req\x3dload\x26user\x3d"+a.g+"\x26state\x3d"+fj(a,"1.72.2"));return b}
function cj(a,b,c){if(c){var d={req:"store"};d.user=b;d.state=fj(a,"1.72.2");d.data=c;b=Ha(Ja()+"/api/v1/user",d);d=b[0];if(b[1]){if(d){var e=d.indexOf("\n");0<e&&(d=d.substr(0,e));d.indexOf("Error: ")||(d=d.substr(7))}d='{"code":'+b[1]+',"data":"'+d+'"}'}b=JSON.parse(d);b&&"ok"==b.code?a.Z("Machine state saved to server"):c&&(c=b&&b.data||"unable to save machine state",c="error"==b.code?"Error: "+c:"Error "+b.code+": "+c,a.Z(c),Sa(Ki,""),a.g=null)}}
function Wb(a,b,c){a=yb(a.id);for(var d=0;d<a.length;d++){var e=a[d];if(c)c==e&&(c=null);else if(e.type==b)return e}return null}l.Wa=function(a){if(this.A.length){var b=0,c=0;!a&&window&&(b=window.scrollX,c=window.scrollY);var d=this.A[0];d.U&&d.U.focus();!a&&window&&window.scrollTo(b,c)}};
function td(a,b){a.w&&(a=a.w,a.cb&&(b||!a.flags.ia||a.flags.Ac)&&(I(a,"A",a.g),I(a,"B",a.u),I(a,"C",a.A),I(a,"BC",Ed(a),4),I(a,"D",a.B),I(a,"E",a.C),I(a,"DE",Gd(a),4),I(a,"H",a.D),I(a,"L",a.F),I(a,"HL",C(a),4),I(a,"SP",a.L,4),I(a,"PC",a.j,4),b=Cd(a),I(a,"PS",b,4),I(a,"IF",b&512?1:0,1),I(a,"SF",b&128?1:0,1),I(a,"ZF",b&64?1:0,1),I(a,"AF",b&16?1:0,1),I(a,"PF",b&4?1:0,1),I(a,"CF",b&1?1:0,1)),b=a.O.speed)&&(b.textContent=a.flags.ia&&a.X?a.X.toFixed(2)+"Mhz":"Stopped")}
var Gi="failsafe",Bi="validate",Di="timestamp",Mi="version",Ni="url",Oi="browser",Ki="user",Fi=-1,xi=0,Ei=1,Ii=2,dj=3;ab(function(){for(var a=wb(document,"pc8080-machine"),b=0;b<a.length;b++){var c=a[b],d=xb(c);c=wb(c,"pc8080","computer");for(var e=0;e<c.length;e++){var f=c[e],g=xb(f);g=new vi(g,d,!0);vb(g,f);g.L&&g.wait(g.jb)}}});bb.show.push(function(){for(var a=wb(document,"pc8080","computer"),b=0;b<a.length;b++){var c=xb(a[b]);if(c=Ab("Computer",c.id))c.flags.Pb=!1,c.V&&!c.flags.ha&&c.jb(Fi)}});
bb.exit.push(function(){for(var a=wb(document,"pc8080","computer"),b=0;b<a.length;b++){var c=xb(a[b]);if(c=Ab("Computer",c.id))c.flags.Pb=!0,c.flags.ha&&oi(c,!(!c.b||c.F),!0)}});function Dd(a,b,c){this.id=a.id;this.J=a.J;this.g="";this.b={};this.w=this.H=!1;this.key=fj(a,b,c);Ji(this,a.Bd)}l=Dd.prototype;l.set=function(a,b){try{this.b[a]=b}catch(c){}};l.get=function(a){return this.b[a]||null};l.data=function(){return this.b};
l.load=function(a){return a?(this.g=a,this.w=!0,this.H=!1,!0):this.w?!0:Ma()&&(a=Ra(this.key))?(this.g=a,this.w=!0):!1};function Ci(a){var b=!0;if(!a.H)try{a.b=JSON.parse(a.g),a.H=!0}catch(c){r(c.message||c),b=!1}return b}l.store=function(){var a=!0;if(Ma()){var b=JSON.stringify(this.b);Sa(this.key,b)||(r("Unable to store "+b.length+" bytes in browser local storage"),a=!1)}return a};l.toString=function(){return this.b?JSON.stringify(this.b):this.g};
function Ji(a,b){a.g="";a.b={};a.w=a.H=!1;b&&a.set("parms",b)}l.clear=function(a){Ji(this);var b=[];try{for(var c=0,d=window.localStorage.length;c<d;c++)b.push(window.localStorage.key(c))}catch(e){}for(c=0;c<b.length;c++)if((d=b[c])&&(a||d.substr(0,this.key.length)==this.key)){try{window.localStorage.removeItem(d)}catch(e){}b.splice(c,1);c=0}};function fj(a,b,c){a=a.id;if(b){var d=b.indexOf(".");0<d&&(a+=".v"+b.substr(0,d))}c&&(a+="."+c);return a}var gj=0;
function hj(a,b,c,d,e,f,g){f("Loading "+a+"...");Ha(a,null,!0,function(h,k,n){n?(k||(k="unable to load "+a+" ("+n+")"),g(k,null)):ij(k,a,b,c,d,e,f,g)})}
function ij(a,b,c,d,e,f,g,h){function k(a,g){if(g)h(g,null);else{if(c){pb(c,b,a);(g=b)&&0>g.indexOf("/")&&"/"==window.location.pathname.slice(-1)&&(g=window.location.pathname+g);d?"}"==d.slice(-1)?(d=d.slice(0,-1),1<d.length&&(d+=",")):d='{state:"'+d+'",':d="{";d+='url:"'+g+'"}';"object"==typeof resources&&(g=null);d=d.replace(/\$/g,"$$$$");if(e){var k=a.match(/(<machine[^>]*\sclass=)(['"])(.*?)(\2.*?>)/);k&&(a=a.replace(k[0],k[1]+k[2]+e+k[4]),e="")}a=a.replace(/(<machine[^>]*\sid=)(['"]).*?\2/,"$1$2"+
c+"$2"+(e?' class\x3d"'+e+'"':"")+(d?" parms\x3d'"+d+"'":"")+(g?' url\x3d"'+g+'"':""))}f||(a=a.replace(/(<xsl:variable name="APPNAME">).*?(<\/xsl:variable>)/,"$1PC8080$2"),a=a.replace(/(<xsl:variable name="APPCLASS">).*?(<\/xsl:variable>)/,"$1pc8080$2"));g=null;if("\x3c"==a.charAt(0))try{f||(a=a.replace(/<!DOCTYPE(.|[\r\n])*]>\s*/g,"")),window.ActiveXObject||"ActiveXObject"in window?(g=new window.ActiveXObject("Microsoft.XMLDOM"),g.async=!1,g.loadXML(a)):g=(new window.DOMParser).parseFromString(a,
"text/xml")}catch(y){g=null,a=y.message}else a="unrecognized XML: "+(255<a.length?a.substr(0,255)+"...":a);h(a,g)}}a?f?jj(a,g,k):k(a,""):h("no data"+(b?" for file: "+b:""),null)}
function jj(a,b,c){var d;if(d=/<([a-z]+)\s+ref="(.*?)"(.*?)\/>/g.exec(a)){var e=d[2];b("Loading "+e+"...");Ha(e,null,!0,function(f,g,h){if(h||!g)c(a,"unable to resolve XML reference: "+d[0]+" ("+h+")");else{if(f=d[3])if(h=g.match(new RegExp("\x3c"+d[1]+"[^\x3e]*\x3e"))){for(var k=h[0],n,t=/( [a-z]+=)(['"])(.*?)\2/gi;n=t.exec(f);)k=0>k.toLowerCase().indexOf(n[1].toLowerCase())?k.replace("\x3e",n[0]+"\x3e"):k.replace(new RegExp(n[1]+"(['\"])(.*?)\\1"),n[0]);h[0]!=k&&(g=g.replace(h[0],k))}else{c(a,"missing \x3c"+
d[1]+"\x3e in "+e);return}g=g.replace(/<\?xml[^>]*>[\r\n]*/,"");a=a.replace(d[0],g);jj(a,b,c)}})}else c(a,"")}
function kj(a,b,c,d,e){function f(a){if(void 0===k){var b=h&&wb(h,"machine-warning");k=b&&b[0]||h}k&&(k.innerHTML=va(a))}function g(a){f("Error: "+a);n&&(--gj||jb(!0));n=!1}var h,k,n=!0;b||(b="machine.xml",c||(c="components.xsl"));gj++;qb[a]={};try{if(h=document.getElementById(a)){var t;if("object"==typeof resources&&(t=resources.css)){var x=document.head||document.getElementsByTagName("head")[0],y=document.createElement("style");y.type="text/css";y.styleSheet?y.styleSheet.cssText=t:y.appendChild(document.createTextNode(t));
x.appendChild(y)}c||(c="/versions/pc8080/1.72.2/components.xsl");t=function(d,e){e?hj(c||"","","","",!1,f,function(d,k){if(k)if(pb(a,c||"",d),f("Processing "+b+"..."),window.ActiveXObject||"ActiveXObject"in window)(k=e.transformNode(k))?(h.outerHTML=k,--gj||jb(!0)):g("transformNodeToObject failed");else if(document.implementation&&document.implementation.createDocument){d=new XSLTProcessor;d.importStylesheet(k);var n=d.transformToFragment(e,document);if(n){var t=h.parentNode;if(t){d=k=0;var u=h.getBoundingClientRect();
0>u.bottom&&(k=window.scrollX,d=window.scrollY);t.replaceChild(n,h);(h=document.getElementById(a))&&0>u.bottom&&(n=h.getBoundingClientRect(),d=window.performance&&window.performance.navigation.type==window.performance.navigation.TYPE_RELOAD?0:d+Math.ceil(n.height-u.height),window.scrollTo(k,d));--gj||jb(!0)}else g("invalid machine element: "+a)}else g("transformToFragment failed")}else g("unable to transform XML: unsupported browser");else g(d)}):g(d)};"\x3c"!=b.charAt(0)?hj(b,a,d||"",e||"",!0,f,
t):ij(b,"",a,d||"",e||"",!1,f,t)}else g("missing machine element: "+a)}catch(u){g(u.message)}return n}window.embedPC8080=function(a,b,c,d,e){jb(!1);return kj(a,b,c,d,e)};
window.commandMachine=function(a,b,c,d,e,f){if("script"==e){d=!1;c+=".machine";if(!f)delete Db[c],d=!0;else if("string"==typeof f&&!Db[c]){d=!0;e=Db;for(var g=c,h=f.length,k=[],n=[],t="",x=null,y=0;y<h;y++){var u=f[y];if('"'==u||"'"==u)x&&u!=x?t+=u:(x?x=null:x=u,t&&(n.push(t),t=""));else{if(!x){if("\r"==u||"\n"==u)u=";";if(" "==u||"\t"==u||";"==u){t&&(n.push(t),t="");";"==u&&n.length&&(k.push(n),n=[]);continue}}t+=u}}t&&n.push(t);n.length&&k.push(n);e[g]=k;Cb(c)||(d=!1)}return d?(b&&(a.disabled=!0),
!0):!1}if(d&&(g=Ab(d,c+".machine"))&&(h=g.exports)&&(h=h[e]))return h.call(g,f)?(b&&(a.disabled=!0),!0):!1;console.log("unimplemented: commandMachine('"+c+"','"+d+"','"+e+"','"+f+"')");return!1};window.enableEvents=jb;window.sendEvent=lb;})()
//# sourceMappingURL=pc8080.js.map
